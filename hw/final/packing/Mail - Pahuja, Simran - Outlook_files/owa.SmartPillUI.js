self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SmartPillUI.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[463],{13487:function(t,o,r){(o=t.exports=r(43)(!1)).push([t.i,'._2Q01fwc5NbrZTI5BcpGw-s{color:"[theme:themePrimary, default:#0078D4]";font-size:12px;font-stretch:normal;font-style:normal;letter-spacing:normal;line-height:normal}html[dir] ._2Q01fwc5NbrZTI5BcpGw-s{background-color:"[theme:white, default:#ffffff]";border:solid 1px;border-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px;margin-bottom:8px;padding:8px;text-align:center}html[dir=ltr] ._2Q01fwc5NbrZTI5BcpGw-s{margin-right:8px}html[dir=rtl] ._2Q01fwc5NbrZTI5BcpGw-s{margin-left:8px}._2Q01fwc5NbrZTI5BcpGw-s:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._2Q01fwc5NbrZTI5BcpGw-s:hover{background-color:"[theme:themePrimary, default:#0078D4]"}._2425MOOSFPWffiKpjexDmi{font-weight:400}html[dir] ._2425MOOSFPWffiKpjexDmi{margin:0}._1XvPPaPlhtm-u0Wx9Efhd5{display:block}._31LpRC6uIQIR-Y-CJ93wqQ{line-height:14px;height:14px;font-size:14px}html[dir=ltr] ._31LpRC6uIQIR-Y-CJ93wqQ{margin-left:0}html[dir=rtl] ._31LpRC6uIQIR-Y-CJ93wqQ{margin-right:0}',""]),o.locals={smartPillButton:"_2Q01fwc5NbrZTI5BcpGw-s",smartPillButtonTextContainer:"_2425MOOSFPWffiKpjexDmi",smartPillButtonContainer:"_1XvPPaPlhtm-u0Wx9Efhd5",smartPillIcon:"_31LpRC6uIQIR-Y-CJ93wqQ"}},13488:function(t){t.exports={f:"$pb",e:"aqb",a:"bqb",b:"cqb",d:"dqb",c:"eqb",g:"fqb"}},197:function(t,o,r){"use strict";r.d(o,"b",function(){return a}),r.d(o,"a",function(){return l});var e=r(16),n=r(306);function a(t){var o,r,n,a,l,i=t.semanticColors,c=t.palette,u=i.buttonBackground,s=i.buttonBackgroundPressed,d=i.buttonBackgroundHovered,g=i.buttonText,b=i.buttonTextHovered,m=i.buttonTextChecked,p=i.buttonTextCheckedHovered;return{root:{backgroundColor:u,color:g},rootHovered:{backgroundColor:d,color:b,selectors:(o={},o[e.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},o)},rootPressed:{backgroundColor:s,color:m},rootExpanded:{backgroundColor:s,color:m},rootChecked:{backgroundColor:s,color:m},rootCheckedHovered:{backgroundColor:s,color:p},rootDisabled:{selectors:(r={},r[e.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},r)},splitButtonContainer:{selectors:(n={},n[e.HighContrastSelector]={border:"none"},n)},splitButtonMenuButton:{color:c.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:c.neutralLight,selectors:(a={},a[e.HighContrastSelector]={color:"Highlight"},a)}}},splitButtonMenuButtonDisabled:{backgroundColor:i.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:i.buttonBackgroundDisabled}}},splitButtonDivider:{backgroundColor:c.neutralTertiaryAlt,position:"absolute",width:1,right:31,top:8,bottom:8,selectors:(l={},l[e.HighContrastSelector]={backgroundColor:"WindowText"},l)},splitButtonDividerDisabled:{backgroundColor:t.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:c.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:c.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:c.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:c.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:i.buttonText},splitButtonMenuIconDisabled:{color:i.buttonTextDisabled}}}function l(t){var o,r,a,l,i,c,u,s,d,g=t.palette,b=t.semanticColors;return{root:{backgroundColor:b.primaryButtonBackground,color:b.primaryButtonText,border:"none",selectors:(o={},o[e.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},o["."+n.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:g.white}}},o)},rootHovered:{backgroundColor:b.primaryButtonBackgroundHovered,color:b.primaryButtonTextHovered,selectors:(r={},r[e.HighContrastSelector]={color:"Window",backgroundColor:"Highlight"},r)},rootPressed:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed,selectors:(a={},a[e.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},a)},rootExpanded:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootChecked:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:b.primaryButtonBackgroundPressed,color:b.primaryButtonTextPressed},rootDisabled:{selectors:(l={},l[e.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},l)},splitButtonContainer:{selectors:(i={},i[e.HighContrastSelector]={border:"none"},i)},splitButtonDivider:{backgroundColor:g.neutralTertiaryAlt,position:"absolute",width:1,right:31,top:8,bottom:8,selectors:(c={},c[e.HighContrastSelector]={backgroundColor:"Window"},c)},splitButtonMenuButton:{backgroundColor:b.primaryButtonBackground,color:b.primaryButtonText,selectors:(u={},u[e.HighContrastSelector]={backgroundColor:"WindowText"},u[":hover"]={backgroundColor:b.primaryButtonBackgroundHovered,selectors:(s={},s[e.HighContrastSelector]={color:"Highlight"},s)},u)},splitButtonMenuButtonDisabled:{backgroundColor:b.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:b.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:b.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:b.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:b.primaryButtonText},splitButtonMenuIconDisabled:{color:g.neutralTertiary,selectors:(d={},d[e.HighContrastSelector]={color:"GrayText"},d)}}}},1983:function(t,o,r){"use strict";r.d(o,"a",function(){return a}),r.d(o,"b",function(){return l}),r.d(o,"c",function(){return i});var e=r(52),n=new e.c(function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(5),r.e(239)]).then(r.bind(null,3159))}),a=Object(e.d)(n,function(t){return t.FeedbackForm}),l=Object(e.d)(n,function(t){return t.FeedbackRibbon}),i=Object(e.d)(n,function(t){return t.NewConsumerRecruitmentForm})},254:function(t,o,r){"use strict";var e=r(0),n=r(1),a=r(163),l=r(156),i=r(464),c=r(16),u=r(159),s=r(162),d=r(193),g=r(197),b=Object(u.b)(function(t,o,r){var e=Object(s.a)(t),n=Object(d.a)(t),a={root:{minWidth:"80px",height:"32px"},label:{fontWeight:c.FontWeights.semibold}};return Object(c.concatStyleSets)(e,a,r?Object(g.a)(t):Object(g.b)(t),n,o)});r.d(o,"a",function(){return m});var m=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o._skipComponentRefResolution=!0,o}return e.__extends(o,t),o.prototype.render=function(){var t=this.props,o=t.primary,r=void 0!==o&&o,i=t.styles,c=t.theme;return n.createElement(a.a,e.__assign({},this.props,{variantClassName:r?"ms-Button--primary":"ms-Button--default",styles:b(c,i,r),onRenderDescription:l.b}))},o=e.__decorate([Object(i.a)("DefaultButton",["theme","styles"],!0)],o)}(l.a)},3164:function(t,o,r){"use strict";var e=r(0),n=2500,a=r(142),l=r(385);function i(t,o,r){var e=new l.a(t,o,{isCore:!0,isCosmosDatapoint:!0});r&&e.addCosmosOnlyData(r),a.e.importAndExecute(e)}function c(t,o,r,a,l){return Object(e.__awaiter)(this,void 0,void 0,function(){var c,u,s,d,g,b,m,p,f,h,k;return Object(e.__generator)(this,function(e){switch(e.label){case 0:return c={},u=l||n,r?[4,Promise.all(r.map(function(t){return t.preRun().catch(function(o){c[t.getName()]=new Error(o)})}))]:[3,2];case 1:e.sent(),e.label=2;case 2:return d=Date.now(),[4,Promise.all(t.map(function(t){return Promise.race([t.buildPills(),(o=u,new Promise(function(t,r){setTimeout(function(){var t=new Error("timeout");t.knownError=!0,r(t)},o)}))]).catch(function(o){return c[t.getName()]=new Error(o),[]});var o})).then(function(t){return s=Date.now(),t})];case 3:return g=e.sent(),b=[].concat.apply([],g),m=b.length,a?[4,Promise.all(a.map(function(t){return t.updateLogData(b).catch(function(o){c[t.getName()]=new Error(o)})}))]:[3,5];case 4:e.sent(),e.label=5;case 5:p={pillsToShow:[],pillsToHide:[],arbitratorId:""};try{p=o.arbitratePills(b)}catch(t){c.arbitrator=new Error(t)}finally{return f=Object.keys(c),h=[],k=[],f.length>0&&f.forEach(function(t){var o=c[t];o.hasOwnProperty("knownError")?h.push(t+"_"+o.message):k.push(t+"_"+o.message)}),i("SmartPillError",[h.toString(),k.toString(),m,s-d,u]),[2,p]}return[2]}})})}function u(t,o,r){return{mainPayload:{renderStory:0,loggableText:o,type:t,timeClicked:null,position:-1},cosmosOnlyData:r}}function s(t,o,r){var e=void 0;t.concat(o).forEach(function(t){!e&&t.logData.cosmosOnlyData&&(e=t.logData.cosmosOnlyData)});var n={data:t.map(function(t){return t.logData.mainPayload})},a={data:o.map(function(t){return t.logData.mainPayload})};i("SmartPillsRendered",[t.length,o.length,JSON.stringify(n),JSON.stringify(a),r],e)}function d(t,o,r,e,n,a,l){i("SmartReply_Rendered",[t,!1,o.join("$"),!1,r.toString(),e.toString(),n,a],l)}function g(t){var o={data:[t.mainPayload]};i("SmartPillClicked",[JSON.stringify(o)],t.cosmosOnlyData)}function b(t,o,r,e,n,a,l){i("SmartReply_Clicked",[t,o,r,!1,e,n,a],l)}r(151);r.d(o,"a",function(){return c}),r.d(o,"b",function(){return u}),r.d(o,"e",function(){return s}),r.d(o,"f",function(){return d}),r.d(o,"c",function(){return g}),r.d(o,"d",function(){return b}),r.d(o,"g",function(){return i})},9160:function(t,o,r){var e=r(13487),n=r(44);"string"==typeof e&&(e=[[t.i,e]]);for(var a=0;a<e.length;a++)n.loadStyles(e[a][1],!1);e.locals&&(t.exports=e.locals)},9332:function(t,o,r){"use strict";r.r(o);var e=r(0),n=r(254),a=r(3164),l=r(1),i=r(9160),c=function(t){function o(o){var r=t.call(this,o)||this;return r.props.smartPillData.logData.mainPayload.position=r.props.position,r}return Object(e.__extends)(o,t),o.prototype.render=function(){var t=this,o=this.props.smartPillData,r=o.ariaLabel,e=o.icon,i=o.onClick,c=o.text,u=o.toolTip,s=o.menuProps;return l.createElement(n.a,{ariaDescription:r,iconProps:e,onClick:function(){var o=t.props.smartPillData;o.logData.mainPayload.timeClicked=(new Date).toISOString(),Object(a.c)(o.logData),Object(a.d)(o.logData.mainPayload.EID,o.logData.mainPayload.position,o.logData.mainPayload.loggableText,o.featureName,o.logData.mainPayload.language,o.logData.mainPayload.locale,o.logData.cosmosOnlyData),i&&i(o)},key:this.props.position,split:!1,styles:this.getSmartPillButtonStyles(),text:c,title:u,menuProps:s})},o.prototype.getSmartPillButtonStyles=function(){return{root:i.smartPillButton,label:i.smartPillButtonTextContainer,icon:this.props.smartPillData.icon?i.smartPillIcon:null}},o}(l.Component),u=r(1983),s=r(5),d=r(13488),g="ReadingPane",b="SmartReply";function m(t){var o={title:Object(s.a)(d.f),subTitle:t.feedbackData.subtitle,categories:t.feedbackData.dSATOptions,ghostText:Object(s.a)(d.e),donationText:Object(s.a)(d.a),donationToolTip:Object(s.a)(d.b),donationJson:t.feedbackData.donationJson,submitCallBack:void 0,cancelCallBack:void 0,createUVTicket:!1};return l.createElement(u.b,{feature:g,subFeature:b,ribbonMessage:Object(s.a)(d.d),thankYouMessage:Object(s.a)(d.g),metadata:JSON.stringify({data:t.arbitratedPills.pillsToShow.map(function(t){return t.logData})}),yesCallBack:void 0,yesFeedbackDialogParams:void 0,noFeedbackDialogParams:o,noCallBack:void 0,okCallBack:void 0,notNowCallBack:void 0,moreFeedbackRibbonMessage:Object(s.a)(d.c)})}var p=r(65),f=r(9160);var h=function(t){l.useEffect(function(){var o=t.arbitratedPills;if(o&&(o.pillsToShow.length>0||o.pillsToHide.length>0)){var r=o.pillsToShow,e=o.pillsToHide,n=o.arbitratorId;Object(a.e)(r,e,n);var l=void 0;r.length>0?l=r[0].logData:e.length>0&&(l=e[0].logData);var i=l&&l.mainPayload.EID;i&&Object(a.f)(i,r.map(function(t){return t.logData.mainPayload.loggableText}),r.map(function(t){return t.featureName}),e.map(function(t){return t.featureName}),l.mainPayload.language,l.mainPayload.locale,l.cosmosOnlyData)}},[]);var o=t.arbitratedPills,r=t.enableFeedbackForm;return o&&0!=o.pillsToShow.length?l.createElement("div",null,l.createElement("div",{className:f.smartPillButtonContainer},o.pillsToShow.map(function(t,o){return l.createElement(c,{key:o,smartPillData:t,position:o})})),function(t,o,r){return t&&Object(p.f)("mc-smartPillsFeedbackFormV2")?r&&l.createElement(m,{arbitratedPills:o,feedbackData:r}):null}(r,o,t.feedbackData)):null};r.d(o,"SmartPill",function(){return c}),r.d(o,"SmartPillBlock",function(){return h})}},0,[0,1,2,5,239]]);
//# sourceMappingURL=owa.SmartPillUI.js.map
self.scriptsLoaded['owa.SmartPillUI.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SmartPillUI.js'] = (new Date()).getTime();