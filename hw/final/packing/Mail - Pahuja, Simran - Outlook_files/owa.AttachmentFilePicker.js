self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentFilePicker.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[125],{9296:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r(2297),o=r(919);function a(e,t,r,n){c(e,Object(o.e)(t),n,r)}function c(e,t,r,n,i){void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===i&&(i=null),e({files:t,shouldShare:r,isInline:n,dataProviderType:i})}function u(e,t,r,n,u,l){if(n===i.g.LocalComputerFiles)a(e,r,u===i.b.Insert,u===i.b.Share);else if(n===i.g.ProviderFiles)if(u===i.b.Share&&l&&null!==t)!function(e,t,r){if(t&&0!==t.length&&r===i.g.ProviderFiles){var n=t,a=n[0].model.ProviderType;e({files:n.map(function(e){return Object(o.d)(e.model)}),dataProviderType:a})}}(t,r,n);else{var s=r;u!==i.b.AttachAndShare?function(e,t,r){if(t&&0!==t.length){var n=t[0].model.ProviderType,i=null;if(n&&10===n){var a=[],u=[];t.forEach(function(e){a.push(e.model.Subject),u.push(e.model.Id)}),i=Object(o.g)(a,u)}else i=t.map(function(e){return Object(o.d)(e.model)});c(e,i,r,!1,n)}}(e,s,u===i.b.Share):function(e,t){var r=t.length>0?t[0].model.ProviderType:null,n=t.filter(function(e){return null!==e.location}),i=t.filter(function(e){return null===e.location});n.length>0&&c(e,n.map(function(e){return Object(o.d)(e.model)}),!0,!1,r),i.length>0&&c(e,i.map(function(e){return Object(o.c)(e.model)}),!1,!1,r)}(e,s)}}var l=r(40),s=r(245),f=1,h=2,d=3;function p(e){switch(e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse){case f:return i.c.List;case h:return i.c.Tile;default:return Object(s.a)()?i.c.Tile:i.c.List}}var g=r(160);function F(e){switch(e){case i.c.List:return f;case i.c.Tile:return h;case i.c.Groups:return d;default:return Object(g.a)(e)}}var S={AFPChangePreferredViewType:{name:"AFPChangePreferredViewType",customData:function(e,t){return[F(t)]}},AFPSetUserPreferredAction:{name:"AFPSetUserPrefferdAction",customData:function(e,t){return[t]}},AFPSetUserPreferredActionGroups:{name:"AFPSetUserPreferredActionGroups",customData:function(e,t){return[t]}}},m=r(49),v=r(324),P=r.n(v),A=r(426),w=r.n(A),O=r(429),y=r.n(O),b=r(430),C=r.n(b),j=r(334),V=r.n(j),T=r(300),k=r.n(T),I=r(427),_=r.n(I),G=r(191),U="root",D="OWA.ViewStateConfiguration";function L(e,t,r){var n=w()({UserConfigurationName:_()({Name:e,BaseFolderId:P()({Id:U})}),Dictionary:[V()({DictionaryKey:k()(t),DictionaryValue:k()(r)})]});return y()({Header:Object(G.getJsonRequestHeader)(),Body:C()({UserConfiguration:n})}).then(function(e){return e.Body.ResponseMessages.Items[0]})}var E=Object(m.c)("setUserPreferredViewType",S.AFPChangePreferredViewType)(function(e,t){e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse=F(t),L(D,{Type:"String",Value:["AttachmentsFilePickerViewTypeForMouse"]},{Type:"Integer32",Value:[""+e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse]})}),M=Object(m.c)("setPreferredActionForCloudFile",S.AFPSetUserPreferredAction)(function(e,t){e.ViewStateConfiguration.AttachOrShareCloudFiles=t,L(D,{Type:"String",Value:["AttachOrShareCloudFiles"]},{Type:"Integer32",Value:[""+e.ViewStateConfiguration.AttachOrShareCloudFiles]})}),B=Object(m.c)("setPreferredActionForGroupFile",S.AFPSetUserPreferredActionGroups)(function(e,t){e.ViewStateConfiguration.AttachOrShareGroupsFiles=t,L(D,{Type:"String",Value:["AttachOrShareGroupsFiles"]},{Type:"Integer32",Value:[""+e.ViewStateConfiguration.AttachOrShareGroupsFiles]})});function H(){var e=Object(l.a)();return{preferredViewType:{value:p(e),valueSetter:function(t){E(e,t)}},attachOrShareCloudFiles:{value:e.ViewStateConfiguration.AttachOrShareCloudFiles,valueSetter:function(t){M(e,t)}},attachOrShareGroupsFiles:{value:e.ViewStateConfiguration.AttachOrShareGroupsFiles,valueSetter:function(t){B(e,t)}}}}var R=r(62);function N(e,t,r,o,a,c,l){return Object(n.__awaiter)(this,void 0,void 0,function(){var s,f;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return[4,i.j.import()];case 1:s=n.sent(),f=H();try{if(!r||0==r.length)throw new Error("files length cannot be 0.");return[2,s(r,c,o,r[0].type===i.d.Group,r.length>1,a,f,l).then(function(n){u(e,t,r,a,n,!1)}).catch(function(){})]}catch(e){R.d.error("Error creating the action panel. Attaching or sharing files might not work! "+e)}return[2]}})})}function $(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,function(){var o;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return[4,i.k.import()];case 1:o=n.sent(),r.userConfiguration||(r.userConfiguration=H());try{return[2,o(r).then(function(r){u(e,t,r.files,r.source,r.action,r.supportsInsertLink)}).catch(function(){})]}catch(e){R.d.error("Error creating the file picker. Attaching or sharing files might not work! "+e)}return[2]}})})}var q=r(103),x=r(2648),z=r(1),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.localComputerFilePicker=z.createRef(),t.onFilesSelected=function(e){var r=t.props,n=r.action;a(r.createAttachmentHandler,e,n===x.c.Insert,n===x.c.Share)},t}return Object(n.__extends)(t,e),t.prototype.render=function(){return z.createElement(i.f,{ref:this.localComputerFilePicker,onFilesSelected:this.onFilesSelected,fileSelectionFilter:this.props.fileSelectionFilter})},t.prototype.click=function(){this.localComputerFilePicker.current&&this.localComputerFilePicker.current.click()},t=Object(n.__decorate)([q.observer],t)}(z.Component),K=r(151),W=r(762);function Q(e){for(var t=e.files,r=e.shouldShare,n=e.isInline,i=e.dataProviderType,o=[],a=0;t[a];)o=o.concat(t[a].size),a++;var c=function(e){for(var t=[],r=0;e[r];)t=t.concat(Object(W.b)(e[r].name)),r++;return t}(t);Object(K.m)("AFPAttachOrShare",[r,n,o.join(","),t.length,i,c.join(","),!1])}r.d(t,"attachmentActionsPanel",function(){return N}),r.d(t,"attachmentFilePicker",function(){return $}),r.d(t,"AttachmentLocalComputerFilePicker",function(){return J}),r.d(t,"logAttachOrShareDatapoint",function(){return Q})}},0,[589,4,12,21,243,9,10,22,30,241]]);
//# sourceMappingURL=owa.AttachmentFilePicker.js.map
self.scriptsLoaded['owa.AttachmentFilePicker.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentFilePicker.js'] = (new Date()).getTime();