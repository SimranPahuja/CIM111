self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ExpressionStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[232],{1098:function(e,t,n){"use strict";var r=n(1138);n(809),n(50),n(832);n(820),n(846);n.d(t,"a",function(){return r.a})},1138:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(809);function i(){return(location?location.pathname:"").split("/").indexOf(r.c)>=0}},2844:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return o});var r=n(52),i=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(5),n.e(251)]).then(n.bind(null,4250))}),c=new r.a(i,function(e){return e.mountAndShowFlexPane}),o=new r.a(i,function(e){return e.hideFlexPane})},2998:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a});var r=n(0),i=n(40),c=/emoji_([0-9a-z]+(_[0-9a-z]+)?)-png/i,o=49;function a(e){var t,n;void 0===e&&(e=o);var a=Object(i.a)().UserOptions.MruEmojis,u=[];if(a&&a.length>0)try{for(var s=Object(r.__values)(a),f=s.next();!f.done;f=s.next()){var d=f.value.match(c);if(d&&d.length>=2&&(u.push(d[1].toLowerCase()),u.length>=e))break}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return u}},3070:function(e,t,n){"use strict";var r=n(2998),i=35;n.d(t,"a",function(){return a});var c=14,o=["1f602","2764","1f60d","1f62d","1f60a","1f612","1f495","1f618","267b","1f629","1f44c","1f60f","1f601","1f609","1f44d","2b05","1f60c","1f64f","1f914","1f622","1f60e","1f633","1f440","1f605","1f64c","1f494","1f648","270c","2728","1f499","1f49c","1f4af","1f604","1f496","1f61c"];function a(e){void 0===e&&(e=i);for(var t=Object(r.b)(Math.min(e,c)),n=0;t.length<e;n++){var a=o[n];t.includes(a)||t.push(a)}return t}},3167:function(e,t,n){"use strict";n.r(t);var r=n(6086),i=n(6087),c=n(6979),o=n(6980),a=n(6981),u=n(4893),s=n(6088),f=n(2472),d=n(69),l=n(764),j=n(151),b=Object(d.action)("saveEmojiSkinToneToServer")(function(e){var t=Object(l.c)(l.a.DiverseEmojis);if(t.diverseEmojisSelectedSkinTone!=f.a.selectedSkinTone){t.diverseEmojisSelectedSkinTone=f.a.selectedSkinTone;var n=l.d.importAndExecute(l.a.DiverseEmojis,t);if(e){var r="ExpressionPicker_EmojiSkinToneSavedToServer";n.then(function(){Object(j.m)(r,[!0])}).catch(function(e){Object(j.m)(r,[!1,f.a.selectedSkinTone,v(e.toString())])})}}});function v(e){switch(e){case"Options are not loaded. Cannot update options.":return 0;case"Error: Error processing options response":return 1;default:return 2}}var p=n(6982),O=n(25),m=n(4),h=Object(m.action)("resetExpressionPickerViewState");Object(m.orchestrator)(h,function(){var e=f.a.expressionPickerViewState;Object(i.a)(e,!1),e.searchTerm&&Object(p.a)(e,"",null),Object(u.a)(e,(0).toString()),Object(a.a)(e,""),Object(s.a)(e),Object(r.a)(e,0),Object(c.a)(e,null),Object(o.a)(e,!1),Object(O.f)()||b(!0)});var S=h,g=n(3846),w=n(2844),x=n(1098);function E(){var e,t=f.a.expressionPickerViewState;(null===(e=t)||void 0===e?void 0:e.isOpen)&&(Object(i.a)(t,!1),S(),f.a.useFlexPane?Object(x.a)()?w.a.importAndExecute():window.O365Shell.FlexPane.CloseFlexPaneForProvider("Expressions"):Object(g.a)(!1))}n.d(t,"closeExpressionPane",function(){return E})},3846:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("toggleExpressionSidePane",function(e){return{showExpressionPane:e}})},4893:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.mutatorAction)("updateExpressionPage",function(e,t){if(e.page.toString()!=t)switch(t){case"0":e.page=0;break;case"1":e.page=1;break;case"2":e.page=2}})},6086:function(e,t,n){"use strict";var r=n(69);t.a=Object(r.action)("setEmojiCategoryIndex")(function(e,t){e.emojiCategoryIndex=t})},6087:function(e,t,n){"use strict";var r=n(0),i=n(69);t.a=Object(i.action)("setExpressionPickerIsOpen")(function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return e.isOpen=t,[2]})})})},6979:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.mutatorAction)("setExpressionPickerOpenedSource",function(e,t){e.source=t})},6980:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.mutatorAction)("setShouldRestoreSelectionAfterInsertNode",function(e,t){e.shouldRestoreSelectionAfterInsertNode=t})},6981:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.mutatorAction)("setWordToReplace",function(e,t){e.wordToReplace=t})},6982:function(e,t,n){"use strict";var r=n(0),i=n(3070),c=n(6513),o=n(6090),a=n(69);t.a=Object(a.action)("updateSearch")(function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t===e.searchTerm?[2]:(e.isSearching=!0,e.searchTerm=t,t?(u=e.gifPickerViewState,[4,Object(o.a)(t,n,a)]):[3,2]);case 1:return u.gifResults=r.sent(),e.emojiPickerViewState.emojiResults=Object(c.a)(t),2!==e.page&&e.numSearchesToInsertEmoji++,[3,3];case 2:e.gifPickerViewState.gifResults=null,e.emojiPickerViewState.emojiResults=Object(i.a)(),r.label=3;case 3:return e.isSearching=!1,[2]}})})})},809:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"b",function(){return o}),n.d(t,"h",function(){return a}),n.d(t,"g",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"d",function(){return f}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return l});var r=n(0),i=n(904),c="deeplink",o="compose",a="reply",u="replyall",s="read",f="group",d="/"+Object(r.__spread)(["mail"],Object(i.a)().split("/").slice(1)).join("/")+c+"/",l="/"+Object(r.__spread)(["calendar"],Object(i.a)().split("/").slice(1)).join("/")+c+"/"},820:function(e,t,n){"use strict";var r=n(809),i=n(50),c=n(832),o=n(39);function a(e,t){if(t){var n=t.displayName?t.displayName+"<"+t.smtpAddress+">":t.smtpAddress;return e?"&"+e+"="+n:n}return""}function u(e,t){return t?"&"+e+"="+t:""}function s(e){var t;if(!(null===(t=e.to)||void 0===t?void 0:t.smtpAddress))return"";var n=o.parse(Object(i.a)().search.substr(1));return n.mailtouri=function(e){var t;if(!(null===(t=e.to)||void 0===t?void 0:t.smtpAddress))return"";var n="mailto:"+a(null,e.to),r="";return r+=a("cc",e.cc),r+=a("bcc",e.bcc),r+=u("subject",e.subject),(r+=u("body",e.body))?n+"?"+r.slice(1):n}(e),Object(c.a)(r.e,r.b,"?"+o.stringify(n))}n.d(t,"a",function(){return s})},832:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(248);function i(e,t,n){var i={pathname:e+t,search:n};return r.format(i)}},846:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(809),i=n(50),c=n(832);function o(e){return e?Object(c.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(i.a)().search):""}}},0,[0,1,2,5,251]]);
//# sourceMappingURL=owa.ExpressionStore.js.map
self.scriptsLoaded['owa.ExpressionStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ExpressionStore.js'] = (new Date()).getTime();