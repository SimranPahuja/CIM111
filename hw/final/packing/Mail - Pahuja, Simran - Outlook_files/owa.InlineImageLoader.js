self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.InlineImageLoader.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[304],{1104:function(e,t,n){"use strict";n.d(t,"a",function(){return m}),n.d(t,"c",function(){return h}),n.d(t,"b",function(){return g});var r=n(0),i=n(5),o=n(1161),a=n(1784),u=n.n(a),c=n(40),s=n(151),d=n(62),l=Object(o.b)({timeBetweenRetryInMS:function(){return 3e4}}),f=function(){function e(e,t,n){var o=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return Object(r.__awaiter)(o,void 0,void 0,function(){function e(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,u()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),d.d.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}var t,n,i,o,a=this;return Object(r.__generator)(this,function(u){switch(u.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=l(function(){return Object(r.__awaiter)(a,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,i=new s.b("AttachmentRefreshDownloadToken"),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,n()];case 2:return u.sent(),i.addCustomData([t]),i.end(),[3,4];case 3:return o=u.sent(),d.d.warn("Retry to refresh token failed: "+o),i.addCustomData([t]),i.endWithError("ServerError",o),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(i.g)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(c.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function m(){return f.getInstance().getDownloadToken()}function h(){return f.getInstance().getUseDownloadUrlBase()}function g(){return f.getInstance().getDownloadUrlBase()}},1135:function(e,t,n){"use strict";var r=n(1342),i=n(131),o={};function a(e){var t=e.toLocaleLowerCase();if(!o[t]){var n={type:i.a.GroupMailbox,deprecatedMailboxId:e,primarySmtpAddress:e,routingKey:Object(i.c)()+e,returnModernConversationItems:!1,requestOptions:Object(r.a)(e)};o[t]=n}return o[t]}var u=n(4),c=Object(u.action)("EDIT_GROUP_SUCCESS",function(e,t){return{groupSmtp:e,photoUrl:t}}),s=Object(u.action)("ADD_GROUP_MEMBER_SUCCESS",function(e){return{groupSmtp:e}}),d=Object(u.action)("POPUP_OPENED",function(){return{isOpen:!0}}),l=Object(u.action)("POPUP_CLOSED",function(){return{isOpen:!1}}),f=Object(u.action)("DELETE_GROUP_SUCCESS",function(e){return{groupSmtp:e}});n.d(t,"n",function(){return r.a}),n.d(t,"m",function(){return a}),n.d(t,"l",function(){return c}),n.d(t,"j",function(){return s}),n.d(t,"q",function(){return d}),n.d(t,"p",function(){return l}),n.d(t,"k",function(){return f}),n.d(t,"r",function(){return"SwitchGroup"}),n.d(t,"o",function(){return"NavigateFromMeToWe"}),n.d(t,"g",function(){return"GroupHeader_SendEmail_Button_Clicked"}),n.d(t,"c",function(){return"GroupHeader_Email_Button_Clicked"}),n.d(t,"d",function(){return"GroupHeader_Files_Button_Clicked"}),n.d(t,"a",function(){return"GroupHeader_Calendar_Button_Clicked"}),n.d(t,"e",function(){return"GroupHeader_Notebook_Button_Clicked"}),n.d(t,"f",function(){return"GroupHeader_Planner_Button_Clicked"}),n.d(t,"i",function(){return"GroupHeader_Site_Button_Clicked"}),n.d(t,"b",function(){return"GroupHeader_CustomLeaveGroup_Button_Clicked"}),n.d(t,"h",function(){return"GroupHeader_Settings_Button_Clicked"})},1161:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,i=!1,o=function(a,u){i?u(new Error("The function retry was cancelled")):(r++,e().then(function(e){return a(e)}).catch(function(e){t&&r>=t?u(e):setTimeout(function(){return o(a,u)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return o(e,t)})},cancel:function(){return i=!0}}}}function i(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i})},1317:function(e,t,n){"use strict";var r=n(160),i=n(5),o=n(41),a="/owa/",u="service.svc/s/GetFileAttachment?id={0}",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",l="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",m="pdfprint.aspx?id={0}&location={1}",h=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var g=n(1104),p=n(245),v=n(33),b=n(2);function w(e,t,n,u,s,l,f,g,p){var v;switch(void 0===s&&(s=0),void 0===l&&(l=0),void 0===f&&(f=!0),void 0===g&&(g=null),void 0===p&&(p=null),n){case 0:v=c;break;case 3:v=m;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&h.indexOf(t.toLowerCase())>=0}(g))return null;v=d;break;default:Object(r.a)(n)}var b=u?l:s;!b&&s&&(b=s);var w=Object(i.b)("{0}{1}{2}&permissionLevel={3}",a,p,Object(i.b)(v,encodeURIComponent(e.Id),encodeURIComponent(t)),b);f&&(w=w+"&X-OWA-CANARY="+Object(o.getOwaCanaryCookie)());return w}function O(e,t,n,c,d){var m;switch(void 0===c&&(c=!1),void 0===d&&(d=!0),n){case 0:m=u;break;case 1:m=s;break;case 2:m=l;break;case 3:m=f;break;default:return Object(r.a)(n)}return Object(i.g)(m)?null:Object(i.b)("{0}{1}{2}",function(e,t,n,r,u){if(void 0===u&&(u=!1),!t||!t.Id)return null;var c=Object(i.b)(n,encodeURIComponent(t.Id));if(!Object(g.c)()||u&&"Firefox"===Object(v.a)().browser)return a+c+"&X-OWA-CANARY="+Object(o.getOwaCanaryCookie)();var s="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(p.a)()&&(s+="&isc=1");var d=Object(i.b)(s,Object(g.b)(),e,c,window.location.hostname,Object(b.h)()||"unofficial");return r&&(d+="&X-OWA-CANARY="+Object(o.getOwaCanaryCookie)(),d+="&token="+Object(g.a)()),d}(e,t,m,d,3===n),c?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return w}),n.d(t,"a",function(){return O})},1324:function(e,t,n){"use strict";var r=n(1317);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var i=n(1104);n.d(t,"c",function(){return i.a})},1342:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(246);function i(e){return{headers:Object(r.f)(e,"GroupMailbox")}}},14082:function(e,t,n){"use strict";n.r(t);var r=n(1547),i=n(69),o=Object(i.action)("clearInlineImageStore")(function(){r.a.inlineImages={}}),a=n(3150),u=n(3260),c=n(3231),s=Object(i.action)("addInlineImageToStore")(function(e,t){r.a.inlineImages[e]=t}),d=n(1008);function l(e){var t=Object(u.a)(e,a.f),n=Object(u.a)(e,d.c);if(t.length>0&&n.length>0){var r=Object(c.a)(e);r&&s(n,r)}}function f(e,t,n,r,i,o,a){void 0===r&&(r=""),void 0===i&&(i=""),void 0===o&&(o=""),void 0===a&&(a=""),e.addCustomData([t,n,r,i,o,a]),r&&r.length>0?e.endWithError("ClientError"):e.end()}var m="RequestError",h="RequestTimeout",g="RequestAbort",p="ImageZeroBytes",v="ImageInvalidLength",b=[{format:"JPEG",signature:new Uint8Array([255,216,255,224]),mime:/^image\/p?jpe?g$/i,expectedMime:"image/jpeg"},{format:"EXIF",signature:new Uint8Array([255,216,255,225]),mime:/^image\/p?jpe?g$/i},{format:"SPIFF",signature:new Uint8Array([255,216,255,232]),mime:/^image\/p?jpe?g$/i},{format:"CannonEOS",signature:new Uint8Array([255,216,255,226]),mime:/^image\/p?jpe?g$/i},{format:"SamsungD500",signature:new Uint8Array([255,216,255,227]),mime:/^image\/p?jpe?g$/i},{format:"PNG",signature:new Uint8Array([137,80,78,71,13,10,26,10]),mime:/^image\/png$/i,expectedMime:"image/png"},{format:"GIF",signature:new Uint8Array([71,73,70,56]),mime:/^image\/gif$/i,expectedMime:"image/gif"},{format:"TIFF1",signature:new Uint8Array([73,32,73]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF2",signature:new Uint8Array([73,73,42,0]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF3",signature:new Uint8Array([77,77,0,42]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF4",signature:new Uint8Array([77,77,0,43]),mime:/^image\/(x-)?tiff$/i},{format:"BMP",signature:new Uint8Array([66,77]),mime:/^image\/bmp$/i}];function w(e,t){return void 0===t&&(t=!1),new Promise(function(n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){var e=r.status,t=r.getResponseHeader("Content-Type")||"";if(t.length>0){var i=t.indexOf(";");i>0&&(t=t.substr(0,i))}var o="",u=null,c="",s=!1,d="";if(200==e){var l=r.response;if(l&&0!=l.byteLength)if(l.byteLength<10)o=v;else{var f=function(e){for(var t=0;t<b.length;t++)for(var n=b[t],r=0;r<n.signature.length&&n.signature[r]==e[r];r++)if(r==n.signature.length-1)return n;return null}(u=new Uint8Array(r.response,0,10));f&&(c=f.format,(s=t&&f.mime.test(t))||(o=a.l,d=f.expectedMime))}else o=p}n({status:o,responseCode:e,contentType:t,detectedFormat:c,first10BytesBase64:u?O(u):"",mimeMatched:s,expectedMime:d})}},r.ontimeout=function(){n({status:h})},r.onerror=function(){n({status:m})},r.onabort=function(){n({status:g})},t&&(r.withCredentials=!0),r.open("GET",e,!0),r.responseType="arraybuffer",r.send()})}function O(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var y=new RegExp("^https?://([^/]*)/.*","i"),j=window.location.hostname.toLowerCase();function k(e){if(e){var t=e.ownerDocument||document;return t&&t.documentElement.contains(e)}return!1}var C="onload";function _(e,t,n,r){e.onload=function(e){var t=e.target;T(t),n&&n(t)},e.onerror=function(e){var t=e.target;T(t),r&&r(t)},e.setAttribute(d.b,d.d),e.src=t}function T(e){e.removeAttribute(C),e.removeAttribute(d.b),e.onload=null,e.onerror=null}var A=n(797),I=n(62),D="deeplink/read/",R="/owa/?debugJS=true&viewmodel=ReadMessageItem&InternetMessageID=";function x(e,t,n,r){var i="Please engage nickhu@microsoft.com with below data:\n",o=Object(u.a)(e,a.e);o&&(i+="Deeplink (React): "+S(o,!0)+"\n");var c=Object(u.a)(e,a.d);c&&(i+="Deeplink (MVVM): "+S(c,!1)+"\n");var s=e.src;s&&(i+="Src: "+s+"\n");var l=Object(u.a)(e,d.c);if(l&&(i+="OriginalSrc: "+l+"\n"),n){var f=n.status,m=n.contentType,h=n.detectedFormat,g=n.first10BytesBase64;f&&(i+="Status: "+f+"\n"),m&&(i+="ContentType: "+m+"\n"),h&&(i+="DetectedFormat: "+h+"\n"),g&&(i+="First10Bytes: "+g+"\n"),i+="MimeMatch: "+n.mimeMatched}r&&r>0&&(i+="Retried: "+r),I.d.error("Error loading inline image: "+t+".\n"+i)}function S(e,t){void 0===t&&(t=!0);var n=Object(A.m)();return t?n+Object(A.k)()+D+e:n+R+e}var E=n(151),M=new RegExp("[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}","i");function U(e,t,n,r,i,o,a,u,c,s,d,l,f,m){void 0===r&&(r=""),void 0===i&&(i=""),void 0===o&&(o=""),void 0===a&&(a=""),void 0===u&&(u=""),void 0===c&&(c=""),void 0===s&&(s=""),void 0===d&&(d=""),void 0===l&&(l=""),void 0===f&&(f=""),void 0===m&&(m="");var h=[e,t,n,r,i,o,a=function(e){if(!e)return"";var t="",n=e,r=e.indexOf(":");return r>=0&&(t=e.slice(0,r+1),n=e.slice(r+1)),t+(n=n.match(M)?"<GUID>":"<PII>")}(a),u,c,s,d,l,f,m];Object(E.m)("InlineImageLoadError",h),I.d.info("InlineImageLoadError: "+h)}var P,B=n(65),L="DataUri_Success",F="DataUri_RequestFailed",N="DataUri_OnError",G=new RegExp("^data:[a-z]+\\/[a-z-]+;","i");function q(e,t,n,r,i,o){n?r&&r(e):i&&i(e);var a=t.imageType,u=t.perfDataPoint,c=t.howLoad,s=t.context,d=t.loaderCode,l=t.originalSrc,m=t.owaDomain,h=t.downloadDomain,g=t.responseData,p=g.responseCode,v=g.status,b=g.contentType,w=g.detectedFormat,O=g.first10BytesBase64,y=g.mimeMatched,j=n?"":o||v||p.toString();u&&f(u,a,c,j,s,d,n?L:""),n||(U(a,c,j,p.toString(),s,d,l,b,m,h,w,O,y.toString()),Object(B.f)("mc-imageDiagnostics")&&x(e,j,g))}!function(e){e[e.NotStarted=0]="NotStarted",e[e.Pending=1]="Pending",e[e.Completed=2]="Completed"}(P||(P={}));var W=4,H=3,$=1e3,z=2e4,J="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7",V="RetryTimedOut",X=[],Q=null;function Z(e,t,n,r,i){var o={image:e,url:t,retryContext:n,currentRetry:0,status:P.NotStarted,whenQueued:Date.now(),onSuccessCallback:r,onErrorCallback:i};Y(o),X.push(o),Q||(Q=setTimeout(function(){return function e(){if(X.length>0){var t=Date.now(),n=[],r=[],i=[];X.forEach(function(e){e.status!=P.Completed&&(t-e.whenQueued>z?K(e,!1,V):e.status==P.Pending?(i.push(e),n.push(e)):e.status==P.NotStarted&&(r.push(e),n.push(e)))});var o=W-i.length;o>0&&r.length>0&&(u=r.slice(0,Math.min(o,r.length)))&&u.length>0&&u.forEach(function(e){e.currentRetry++,e.status=P.Pending,k(e.image)?_(e.image,e.url,function(t){K(e,!0)},function(t){e.currentRetry>=H?K(e,!1):Y(e)}):K(e,!1,a.k+"_R"+e.currentRetry)}),X=n}var u;Q=X.length>0?setTimeout(function(){return e()},$):null}()},$))}function Y(e){e.status=P.NotStarted,e.image.src=J}function K(e,t,n){if(void 0===n&&(n=""),e.status!=P.Completed){var r=e.image,i=e.onSuccessCallback,o=e.onErrorCallback,a=e.currentRetry;t?i&&i(r):o&&o(r);var u=e.retryContext,c=u.imageType,s=u.perfDataPoint,d=u.howLoad,l=u.context,m=u.loaderCode,h=u.originalSrc,g=u.owaDomain,p=u.downloadDomain,v=u.responseData,b=v.responseCode,w=v.status,O=v.contentType,y=v.detectedFormat,j=v.first10BytesBase64,k=v.mimeMatched,C=t?"":n||w||b.toString();s&&f(s,c,d,C,l,m,a.toString()),t||(U(c,d,C,b.toString(),l,m,h,O,g,p,y,j,k.toString(),a.toString()),Object(B.f)("mc-imageDiagnostics")&&200==b&&x(r,C,v)),e.status=P.Completed}}var ee="InlineImageLoad";function te(){return new E.a(ee,{logEvery:Object(B.f)("ring-dogfood")?1:20,isQos:!0})}var ne="ZeroNaturalWidth";function re(e,t,n,r,i,o){void 0===o&&(o=!1);var c,s=te(),l=null!=(c=t.match(y))&&c.length>1&&c[1].toLowerCase()!=j,m=l?a.o:a.q,h=Object(u.a)(e,d.c),g=Object(u.a)(e,a.c);0==g.length&&(g=a.r);var p="";l&&(e.setAttribute(a.a,a.g),p=a.g),I.d.info("InlineImage: Load attachment, Url: "+t+", crossDomain: "+l+", crossOrigin: "+p);var v=l?j:"",b=l?function(e){var t=e.match(y);return null!=t&&t.length>1?t[1].toLowerCase():j}(t):"";_(e,t,function(e){r&&r(e);var t=e.naturalWidth>0;f(s,g,m,t?"":ne,n,p),t||U(g,m,ne,"",n,p,h,"",v,b)},function(u){var c=a.n;n!=a.h||k(u)?w(t,l).then(function(d){if(o&&200==d.responseCode&&d.mimeMatched)Z(u,t,{imageType:g,howLoad:m,context:n,loaderCode:p,originalSrc:h,owaDomain:v,downloadDomain:b,responseData:d,perfDataPoint:s},r,i);else if(d.status==a.l&&d.expectedMime)!function(e,t,n,r,i){var o=new XMLHttpRequest;o.onload=function(){var t=new FileReader;t.onloadend=function(){if(t.result){var o=t.result.replace(G,"data:"+n.responseData.expectedMime+";");_(e,o,function(){return q(e,n,!0,r,i)},function(){return q(e,n,!1,r,i,N)})}},t.readAsDataURL(o.response)},o.ontimeout=o.onerror=function(){q(e,n,!1,r,i,F)},e.crossOrigin==a.g&&(o.withCredentials=!0),o.open("GET",t,!0),o.responseType="blob",o.send()}(u,t,{imageType:g,howLoad:m,context:n,loaderCode:p,originalSrc:h,owaDomain:v,downloadDomain:b,responseData:d,perfDataPoint:s},r,i);else{i&&i(u);var l=d.status,w=d.responseCode,O=d.contentType,y=d.detectedFormat,j=d.first10BytesBase64,k=d.mimeMatched;c=l||w.toString(),f(s,g,m,c,n,p),U(g,m,c,w.toString(),n,p,h,O,v,b,y,j,k.toString()),Object(B.f)("mc-imageDiagnostics")&&(404!=w&&0!=w&&200!=w||x(e,c,200==w?d:null))}}):(i&&i(u),c=a.k,f(s,g,m,c,n,p),U(g,m,c,"",n,p,h,"",v,b))})}var ie=n(94),oe=n(7206),ae=n(1324),ue="naturalwidth",ce="naturalheight",se="width",de="height",le="px";function fe(e,t,n){void 0===n&&(n=!0);var i=Object(u.a)(e,d.a),o=Object(u.a)(e,a.c),c=Object(u.a)(e,d.c),s=c.length>0?r.a.inlineImages[c]:null;if(0==i.length&&!s)return!1;if(s){var l=te();_(e,s,function(e){he(e),f(l,o,a.p,"",t)},function(e){f(l,o,a.p,a.n,t),U(o,a.p,a.n,"",t,"",c,"")})}else{var m={Id:decodeURIComponent(i),mailboxInfo:Object(oe.a)(e)},h=Object(ae.a)(m.mailboxInfo.routingKey,m,1);if(null!=h&&h.length>0){var g=e.style.display,p=n?function(e){var t="50px",n="50px";e.style.width&&e.style.height?(t=e.style.width,n=e.style.height):e.getAttribute(se)&&e.getAttribute(de)?(t=e.getAttribute(se)+le,n=e.getAttribute(de)+le):e.getAttribute(ue)&&e.getAttribute(ce)&&(t=e.getAttribute(ue)+le,n=e.getAttribute(ce)+le);var r=Object(ie.g)(),i=document.createElement("div");if(i.style.display="inline-block",i.style.width=t,i.style.height=n,i.style.maxWidth="100%",i.style.maxHeight=e.style.maxHeight,i.style.borderWidth="1px",i.style.borderStyle="dashed",i.style.borderColor=r.themePrimary,i.style.boxSizing="border-box",e.style.display="none",e.parentNode.insertBefore(i,e),e.getAttribute(ue)&&e.getAttribute(ce)){var o=Math.min(parseInt(i.style.width),i.offsetWidth);i.style.height=Math.ceil(o/parseInt(e.getAttribute(ue))*parseInt(e.getAttribute(ce))).toString()}return i}(e):null;re(e,h,t,function(e){me(p),he(e),e.style.display=g},function(e){me(p),e.style.display="inline"},!0)}else U(o,"",a.m,"",t,"",c,""),e.removeAttribute("src")}return!0}function me(e){var t;(null===(t=e)||void 0===t?void 0:t.parentNode)&&e.parentNode.removeChild(e)}function he(e){var t=e.style;e.hasAttribute("width")||t.width||e.hasAttribute("height")||t.height||(t.maxWidth="100%",t.height="auto")}var ge=n(1341);var pe=n(0),ve=n(467),be=n(104),we=n(6211),Oe="https://imgproxy.services.web.outlook.com/proxy/?u={0}&t={1}",ye="https://outlookimageproxy.azurewebsites.net",je="ImageProxyModelB",ke="ImageProxyModelD";function Ce(e,t){return new Promise(function(n){e.onload=function(t){_e(e),n(!0)},e.onerror=function(t){_e(e),n(!1)},e.src=t})}function _e(e){e.onload=null,e.onerror=null}function Te(e){return t=e,n=Object(u.a)(t,d.c),r=Object(u.a)(t,a.b),!(!n||!r)&&(Object(ge.a)()?Object(B.f)("rp-imageProxyOnModelD")?function(e,t){Object(pe.__awaiter)(this,void 0,void 0,function(){var n,r,i,o,a,c,s,l,f,m,h,g;return Object(pe.__generator)(this,function(p){switch(p.label){case 0:return n=e,r=!1,t?(i=new E.a(je),[4,Object(we.a)(e)]):[3,3];case 1:return(o=p.sent())?[4,Ce(e,o)]:[2];case 2:p.sent()?(i.end(),r=!0):i.endWithError("ServerError"),n=document.createElement("img"),p.label=3;case 3:return(a=Object(u.a)(e,d.c))?(c=new E.a(ke),s=Object(pe.__read)(Object(ve.getAccessTokenforResourceAsLazy)(ye),2),l=s[0],f=s[1],l?[3,5]:[4,f]):[2];case 4:l=p.sent(),p.label=5;case 5:return m=!1,(h=l?l.length:0)>0?(g=Object(be.a)(Oe,encodeURIComponent(a),encodeURIComponent(l)),[4,Ce(n,g)]):[3,7];case 6:m=p.sent(),p.label=7;case 7:return t&&c.addCustomData({resultB:r,resultD:m,tokenLen:h}),m?c.end():c.endWithError(0==h?"ClientError":"ServerError"),[2]}})})}(e,!0):function(e){Object(pe.__awaiter)(this,void 0,void 0,function(){var t;return Object(pe.__generator)(this,function(n){switch(n.label){case 0:return[4,Object(we.a)(e)];case 1:return(t=n.sent())?(e.src=t,[2,!0]):[2,!1]}})})}(e):e.src="",!0);var t,n,r}var Ae="data-imageerror",Ie="data-outlook-trace",De="CidTildeWrd",Re="AttNotFound",xe=new RegExp("^cid:\\s?~WRD","i"),Se=new RegExp("^cid:","i"),Ee=new RegExp("f:([0-9]+)","i"),Me=new RegExp("t:([0-9]+)","i");function Ue(e,t){var n=Object(u.a)(e,Ae),r=Object(u.a)(e,a.c),i=Object(u.a)(e,d.c);if(n&&n.length>0){var o=n;if(i&&xe.test(i))o=De;else if(n==Re){var c=function(e){var t="";if(e){var n=Ee.exec(e),r=Me.exec(e);if(n&&2==n.length&&r&&2==r.length){var i=parseInt(n[1]),o=parseInt(r[1]);isNaN(i)||isNaN(o)||(0==i?t="PreEWS":i>0&&(i<o?t="MidEWS":i==o&&(t="PostEWS")))}}else t="NoTrace";return t}(Object(u.a)(e,Ie));c&&(o=Re+"_"+c)}!function(e,t,n,r,i,o){void 0===n&&(n=""),void 0===r&&(r=""),void 0===i&&(i=""),void 0===o&&(o="");var a=te(),u=[e,t,n,r,i,o];a.addCustomData(u),n&&n.length>0?a.endWithError("ClientError"):a.end()}(r,"",o,t),U(r,"",o,"",t,"",i,""),e.onload=null,e.removeAttribute("src"),Object(B.f)("mc-imageDiagnostics")&&(n!=Re&&0!=n.indexOf("NotImage")||x(e,n))}else if(i&&!Se.test(i)){var s=te();_(e,i,function(e){f(s,r,"","",t)},function(e){f(s,r,"",a.n,t),w(i).then(function(e){var n=e.status,o=e.responseCode,a=e.contentType,u=n||o.toString();U(r,"",u,o.toString(),t,"",i,a)})})}}function Pe(e,t,n){var r=t||"";fe(e,r,!!n)||Te(e)||Ue(e,r)}function Be(e){var t=[e];Object(E.m)("InlineImageAttachmentUpload",t),I.d.info("InlineImageAttachmentUpload: "+t)}n.d(t,"clearInlineImageStore",function(){return o}),n.d(t,"cacheInlineImage",function(){return l}),n.d(t,"loadFromAttachmentServiceUrl",function(){return re}),n.d(t,"loadFromAttachment",function(){return fe}),n.d(t,"loadFromProxy",function(){return Te}),n.d(t,"loadFromImageTag",function(){return Pe}),n.d(t,"logImageLoadError",function(){return U}),n.d(t,"logImageUpload",function(){return Be}),n.d(t,"tryCreateDataURIFromImage",function(){return c.a})},1507:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),i=n(2631);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetClientAccessToken",e,t)}},1508:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenRequest:#Exchange"},e)}},161:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,a){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var c={value:n,expire:i+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){o(t),a&&a(t,n)}.bind(this),i)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var a=e[o];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return i&&t++,a.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(o)if(e[a])continue;var u=r[a],c=u.expire-i;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,u.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},1784:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},251:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout(function(){e.tryRunTask()},this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then(function(){e.onTaskComplete()}).catch(function(){e.onTaskComplete()}),this.scheduleTask()},e}();n.d(t,"a",function(){return r})},2631:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenJsonRequest:#Exchange"},e)}},298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"TokenRequest:#Exchange"},e)}},3150:function(e,t,n){"use strict";n.d(t,"f",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"e",function(){return a}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return c}),n.d(t,"g",function(){return s}),n.d(t,"r",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"m",function(){return f}),n.d(t,"k",function(){return m}),n.d(t,"l",function(){return h}),n.d(t,"h",function(){return g}),n.d(t,"p",function(){return p}),n.d(t,"o",function(){return v}),n.d(t,"q",function(){return b}),n.d(t,"j",function(){return w}),n.d(t,"i",function(){return O});var r="src",i="data-imagetype",o="crossorigin",a="data-itemid",u="data-inetid",c="data-imageproxyendpoint",s="use-credentials",d="AttachmentByCid",l="OnError",f="NullAttachmentUrl",m="DOMDetached",h="ImageMismatch",g="RP",p="DataUri",v="CrossDomain",b="SameDomain",w="ImageProxySkipForConsumerChild",O="ImageProxyConnectorsAuthTokenFalse"},3231:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(151),i="2d",o="canvas",a="image/png";function u(e){try{var t=document.createElement(o),n=e.naturalWidth,u=e.naturalHeight;if(n>0&&u>0||(Object(r.m)("CreateDataURIMissingNaturalDimensions"),n=e.width,u=e.height),n>0&&u>0)return t.width=n,t.height=u,t.getContext(i).drawImage(e,0,0),t.toDataURL(a)}catch(e){}return null}},3260:function(e,t,n){"use strict";function r(e,t){return e.hasAttribute(t)?e.getAttribute(t):""}n.d(t,"a",function(){return r})},339:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),i=n(298);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAccessTokenforResource",e,t)}},4776:function(e,t,n){"use strict";var r,i,o,a=n(0),u=n(65),c=n(245),s=n(467),d=n(151),l=n(1508),f=n.n(l),m=n(1507),h=n.n(m),g=n(874),p=n(51),v="GetConnectorsLTITokenFailure",b="GetConnectorsLTITokenException",w="GetConnectorsLTITokenNull",O="ConnectorsLtiToken",y="40B852DF-9693-420D-AA7D-10072C9CE077",j=5;function k(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return(e=function(){if(r){var e=Date.now()-i;if(e<1e3*(r.TTL-j)*60)return r.TokenValue}return null}())?[3,2]:[4,C()];case 1:e=t.sent(),t.label=2;case 2:return[2,e]}})})}function C(){return o||(o=new Promise(function(e,t){var n={Header:Object(g.getJsonRequestHeader)(),Body:f()({TokenRequests:[{__type:"TokenRequest:#Exchange",Id:y,TokenType:"Connectors"}]})};h()(n).then(function(n){o=null,n&&"Success"===n.Body.ResponseMessages.Items[0].ResponseClass?(r=n.Body.ResponseMessages.Items[0].Token,i=Date.now(),function(e){if(!e)throw _(w),new Error("getClientAuthToken null");p.set(O,e,{path:"/actions/"})}(r.TokenValue),e(r.TokenValue)):(_(v),t(new Error("getClientAuthToken failed")))}).catch(function(e){o=null,_(b),t(new Error("getClientAuthToken exception: "+e))})})),o}function _(e){Object(d.m)(e),r=void 0}var T="https://outlook.office365.com/connectors",A="User.Read";function I(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return!Object(u.f)("rp-actionableMessages-aad-token")||Object(c.a)()?[3,2]:[4,R()];case 1:return[2,e.sent()];case 2:return Object(u.f)("rp-actionableMessages-msa-token")&&Object(c.a)()?[4,D()]:[3,4];case 3:return[2,e.sent()];case 4:return[4,k()];case 5:return[2,e.sent()]}})})}function D(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Object(s.getDelegationTokenForOwa)(A)];case 1:return[2,e.sent()]}})})}function R(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return e=Object(a.__read)(Object(s.getAccessTokenforResourceAsLazy)(T),2),t=e[0],n=e[1],t?[3,2]:[4,n];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}})})}n.d(t,"a",function(){return I}),n.d(t,"b",function(){return k})},6211:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(0),i=n(3150),o=n(4776),a=n(34),u=n(40),c=n(151),s=n(3260),d=n(1008),l="data-connectorsauthtoken",f="u",m="i",h="d",g="ClientId";function p(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,o,h;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=Object(s.a)(e,d.c),n=Object(s.a)(e,i.b),o=Object(s.a)(e,l),t&&n?Object(u.a)().IsConsumerChild?(Object(c.m)(i.j),[2,t]):"1"!=o?[3,2]:[4,v(n,t)]:[2,""];case 1:return h=r.sent(),[3,3];case 2:h=function(e,t){var n=Object(a.getCookie)(g);if(!n)return null;if("/actions/ei"==e.toLowerCase())return Object(c.m)(i.i),null;return e+"?"+f+"="+encodeURIComponent(t)+"&"+m+"="+encodeURIComponent(n)}(n,t),r.label=3;case 3:return[2,h]}})})}function v(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(o.b)()];case 1:return n.sent(),[3,3];case 2:return n.sent(),[2,null];case 3:return[2,e+"?"+f+"="+encodeURIComponent(t)+"&"+h+"="+encodeURIComponent((new Date).toISOString())]}})})}},7206:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(5),i=n(1135),o=n(131),a=n(3260),u="explicitlogon";function c(e){var t=Object(a.a)(e,u);return Object(r.g)(t)?Object(o.e)():Object(i.m)(t)}},874:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(477),i=n(478),o=n(475),a=n(468);t.getJsonRequestHeader=function(e){return r.default({RequestServerVersion:"Exchange2015",TimeZoneContext:i.default({TimeZoneDefinition:o.default({Id:null!=e?e:"Pacific Standard Time"})})})},t.getExtendedPropertyUri=function(e,t,n){return a.default({PropertySetId:e,PropertyName:t,PropertyType:n})}}},0,[565,110,541]]);
//# sourceMappingURL=owa.InlineImageLoader.js.map
self.scriptsLoaded['owa.InlineImageLoader.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.InlineImageLoader.js'] = (new Date()).getTime();