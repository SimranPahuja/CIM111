self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.RecipientPermissionChecker.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[426],{1054:function(e,t,n){var r=n(1270),i=36e5,s=6e4,a=2,c=/[T ]/,o=/:/,u=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,l=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,h=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,_=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/([Z+-].*)$/,k=/^(Z)$/,y=/^([+-])(\d{2})$/,w=/^([+-])(\d{2}):?(\d{2})$/;function I(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?a:Number(n);var P=function(e){var t,n={},r=e.split(c);if(o.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var i=j.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),T=function(e,t){var n,r=d[t],i=l[t];if(n=f.exec(e)||i.exec(e)){var s=n[1];return{year:parseInt(s,10),restDateString:e.slice(s.length)}}if(n=u.exec(e)||r.exec(e)){var a=n[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(P.date,n),x=T.year,S=function(e,t){if(null===t)return null;var n,r,i,s;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=p.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=h.exec(e)){r=new Date(0);var a=parseInt(n[1],10);return r.setUTCFullYear(t,0,a),r}if(n=m.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,i,c),r}if(n=v.exec(e))return s=parseInt(n[1],10)-1,I(t,s);if(n=b.exec(e)){s=parseInt(n[1],10)-1;var o=parseInt(n[2],10)-1;return I(t,s,o)}return null}(T.restDateString,x);if(S){var D,C=S.getTime(),R=0;return P.time&&(R=function(e){var t,n,r;if(t=_.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*i;if(t=O.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*i+r*s;if(t=g.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var a=parseFloat(t[3].replace(",","."));return n%24*i+r*s+1e3*a}return null}(P.time)),P.timezone?(E=P.timezone,D=(A=k.exec(E))?0:(A=y.exec(E))?(N=60*parseInt(A[2],10),"+"===A[1]?-N:N):(A=w.exec(E))?(N=60*parseInt(A[2],10)+parseInt(A[3],10),"+"===A[1]?-N:N):0):(D=new Date(C+R).getTimezoneOffset(),D=new Date(C+R+D*s).getTimezoneOffset()),new Date(C+R+D*s)}var E,A,N;return new Date(e)}},1153:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),t.b=r},121:function(e,t,n){"use strict";var r=n(336);n.d(t,"a",function(){return r.a})},1270:function(e,t){e.exports=function(e){return e instanceof Date}},1300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindItemRequest:#Exchange"},e)}},1301:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),i=n(1405);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("FindItem",e,t)}},1383:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},1405:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindItemJsonRequest:#Exchange"},e)}},1587:function(e,t,n){var r=n(1054);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},161:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function s(t){r--,delete e[t]}this.put=function(t,n,i,a){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var o={value:n,expire:i+Date.now()};return isNaN(o.expire)||(o.timeout=setTimeout(function(){s(t),a&&a(t,n)}.bind(this),i)),e[t]=o,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&s(t),n},this.clear=function(){for(var s in e)clearTimeout(e[s].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(s){var a=e[s];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return i&&t++,a.value;i&&n++,r--,delete e[s]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),s=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(s)if(e[a])continue;var c=r[a],o=c.expire-i;if(o<=0){this.del(a);continue}o=o>0?o:void 0,this.put(a,c.value,o)}return this.size()}}e.exports=new r,e.exports.Cache=r},2038:function(e,t,n){var r=n(1587),i=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},2039:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),i=n(1383);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},2143:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},251:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout(function(){e.tryRunTask()},this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then(function(){e.onTaskComplete()}).catch(function(){e.onTaskComplete()}),this.scheduleTask()},e}();n.d(t,"a",function(){return r})},2782:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),i=n(2143);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("FetchDataProviderResource",e,t)}},298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"TokenRequest:#Exchange"},e)}},3060:function(e,t,n){"use strict";var r="POST",i=n(0),s=n(151),a=n(988),c=n(121),o=n(2143),u=n.n(o),d=n(2782),f=n.n(d),l=n(62);function p(e,t,n,r,c){return Object(i.__awaiter)(this,void 0,void 0,function(){var o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Object(a.k)(e,!1,n)];case 1:return o=i.sent(),[3,3];case 2:return i.sent(),[3,3];case 3:return o?(Object(s.m)("fetchServiceViaDataProvider",[e]),l.d.info("fetchServiceViaDataProvider"),[4,h(t,o,r,c)]):[3,5];case 4:return[2,i.sent()];case 5:Object(s.m)("fetchServiceFailedToGetToken",[e]),i.label=6;case 6:return 0!==e?[3,8]:(Object(s.m)("fetchServiceViaOWAServer"),l.d.info("fetchServiceViaOWAServer"),[4,m(e,t,r)]);case 7:return[2,i.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}})})}function h(e,t,n,r){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,o,u;return Object(i.__generator)(this,function(i){return a=n.datapointNamePrefix+"DataProvider",o=new s.a(a),u={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},r&&Object.keys(r).forEach(function(e){u[e]=r[e]}),[2,fetch(e,{method:n.method,mode:n.mode,headers:u,body:n.body}).then(function(e){if(Object(c.a)(e.status))return o.end(),e.json();var t=new Error(a+" : Response status = "+e.status+", body = "+e.body);throw o.endWithError("ServerError",t),t}).then(function(e){return JSON.stringify(e)})]})})}function m(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,o,d,l,p;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return a=n.datapointNamePrefix+"OWA",o=new s.a(a),d=u()({ProviderType:e,Url:t,Method:n.method,Body:n.body,IsJsonPost:!(!n.body||n.method!==r)}),[4,f()(d)];case 1:if(l=i.sent(),Object(c.a)(l.Status))return o.end(),[2,l.Body];throw p=new Error(a+" : Response status = "+l.Status+", ServerTraceLog = "+l.ServerTraceLog),o.endWithError("ServerError",p),p}})})}function v(e){return"u!"+btoa(e).replace(/=+$/,"").replace("/","_").replace("+","-")}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return"cors"}),n.d(t,"b",function(){return"GET"}),n.d(t,"d",function(){return p}),n.d(t,"e",function(){return v})},336:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",function(){return r})},339:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),i=n(298);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAccessTokenforResource",e,t)}},4741:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1992),s=n(1153),a=n(1416);function c(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var c,o,u,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,a.e.import()];case 1:return c=r.sent(),o=c(t),u=[],o.some(function(e){return e.recipient.expansionStatus===s.a.None})?(Object(i.b)(e,o,n),[2,[!1,u]]):(d=o.filter(function(e){return e.recipient.expansionStatus===s.a.SucceededWithoutDLOrGroupMembers})).length!==o.length?[2,[!1,u]]:(d.forEach(function(e){e.recipient.members.forEach(function(e){u.push(e)})}),[2,[!0,u]])}})})}function o(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,s,o,u,d,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:return[4,a.k.import()];case 1:return i=l.sent(),[4,a.m.import()];case 2:return s=l.sent(),i(t)||s(t)?[2,[]]:[4,c(e,t,n)];case 3:return o=r.__read.apply(void 0,[l.sent(),2]),u=o[0],d=o[1],u?[4,a.g.import()]:[2,[]];case 4:return f=l.sent(),f(t).forEach(function(e){d.push({emailAddress:e.recipient.persona.EmailAddress.EmailAddress,displayName:e.recipient.persona.EmailAddress.Name,personaTypeString:null})}),[2,d]}})})}var u=n(978);function d(e){var t=Object(u.k)(e);return t&&t.sharingInfo.getSharingInfoSucceeded&&(0===t.currentPermissionLevel||2===t.currentPermissionLevel||1===t.currentPermissionLevel)}var f=n(151),l=n(5),p=n(62),h=n(3060),m=n(988),v=n(248);function b(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i,s,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=function(e){return Object(l.b)("https://{0}/{1}/{2}/permission/checkAccess",Object(v.parse)(e).hostname,m.a,Object(h.e)(e))}(e),i=function(e){return JSON.stringify((t=e,{recipients:t.map(function(e){return{alias:e.emailAddress}})}));var t}(t),s={method:h.c,mode:h.a,body:i,datapointNamePrefix:"checkRecipientPermission"},a=null,[4,Object(h.d)(0,n,e,s)];case 1:return a=r.sent(),[2,JSON.parse(a).value]}})})}var _=n(4),O=Object(_.action)("startCheckPerm",function(e){return{composeId:e}}),g=Object(_.action)("finishCheckPerm",function(e){return{composeId:e}}),j=Object(_.action)("addCheckPerm",function(e){return{composeId:e}}),k=Object(_.action)("removeCheckPerm",function(e){return{composeId:e}}),y=Object(_.action)("updateCheckPermCount ",function(e,t){return{composeId:e,offset:t}}),w=30,I=23;function P(e,t,n,i){var s;return Object(r.__awaiter)(this,void 0,void 0,function(){var a,c,o,h,m,v,_;return Object(r.__generator)(this,function(j){switch(j.label){case 0:return e.length>0?(p.d.info(Object(l.b)("RecipientPermission: LinkId:{0}, add {1} recipients",t,e.length)),a=null,[4,u.o.import()]):[3,10];case 1:if(c=j.sent(),!d(t))return[2,!1];c(t,e),O(i),(o=new f.a("LinkCheckPerms")).addCustomData({RecipientCount:e.length}),j.label=2;case 2:j.trys.push([2,8,9,10]),h=0,j.label=3;case 3:return h<e.length/w?(a=e.slice(h*w,(h+1)*w),d(t)?[4,b(n,a)]:(o.addCustomData({permissionChangedSoCheckPermStoped:!0}),o.end(),o=null,[2,!1])):[3,7];case 4:return m=j.sent(),v=m.filter(function(e){return!e.hasAccess}).length,[4,u.w.import()];case 5:j.sent()(t,m),o.addCustomData({countOfRecipientsWhoCannotAccess:Math.min(v,I)}),k=v>0,y=m.length,Object(f.m)("CheckPermissionForRecipients",[k,Math.min(y,I)]),p.d.info(Object(l.b)("RecipientPermission: checkAccess for {0} recipients succeeded",m.length)),j.label=6;case 6:return h++,[3,3];case 7:return[3,10];case 8:return _=j.sent(),function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(f.m)("CheckRecipientPermissionFailure",[n]),p.d.info(Object(l.b)("RecipientPermission: checkAccess for {0} recipients failed",t.length)),[4,u.u.import()];case 1:return r.sent()(e,t),[2]}})})}(t,a||e,_.message),o.endWithError(_.message),o=null,[2,!1];case 9:return null===(s=o)||void 0===s||s.end(),g(i),[7];case 10:return[2,!0]}var k,y})})}function T(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,s,c;return Object(r.__generator)(this,function(o){switch(o.label){case 0:return(i=Object(u.l)(e))&&d(e)?(s=i.unwrappedUrl?i.unwrappedUrl:i.url,[4,a.j.import()]):[2];case 1:return c=o.sent(),function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,function(){var i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(i=e.filter(function(e){return!x(e.emailAddress,t)})).length>0?(p.d.info(Object(l.b)("RecipientPermission: LinkId:{0}, remove {1} recipients ",n,i.length)),[4,u.s.import()]):[3,2];case 1:r.sent()(n,i),r.label=2;case 2:return[2]}})})}(i.sharingRecipientsInfo.recipientPermissionInfos,t,e),c(i.sharingRecipientsInfo)?[2]:[4,P(function(e,t){var n=t.filter(function(t){return!x(t.emailAddress,e)}),r=[];return n.forEach(function(e){r.push({emailAddress:e.emailAddress,name:e.displayName,getPermissionInfoStatus:a.a.InProgress,hasAccess:!1})}),r}(i.sharingRecipientsInfo.recipientPermissionInfos,t),e,s,n)];case 2:return o.sent(),[2]}})})}function x(e,t){return t.some(function(t){return t.emailAddress===e})}var S=n(65);function D(e){return e.some(function(e){return d(e)})}Object(_.orchestrator)(i.c,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(S.f)("doc-attachment-contextualSharingTips")&&D(e.linkIds)?(p.d.info("RecipientPermission: tryCheckPermForLinks"),[4,o(e.linkIds,e.recipientInfos,e.composeId)]):[2];case 1:t=r.sent(),n=0,r.label=2;case 2:return n<e.linkIds.length?[4,T(e.linkIds[n],t,e.composeId)]:[3,5];case 3:r.sent(),r.label=4;case 4:return n++,[3,2];case 5:return[2]}})})});var C=n(7427),R=n(52),E=new R.c(function(){return n.e(425).then(n.bind(null,14338))}),A=new R.a(E,function(e){return e.setMembersToRecipientViewState}),N=new R.a(E,function(e){return e.setRecipientExpansionStatus});function M(e){var t;return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i,a,c,o,u,d,l,h,m;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return p.d.info("RecipientPermission: expandAndSetRecipientViewState"),[4,C.b.import()];case 1:return n=r.sent(),i=e.recipient.persona,a=e.recipient.persona.EmailAddress,c={EmailAddress:a.EmailAddress,Name:a.Name,MailboxType:a.MailboxType,RoutingType:a.RoutingType},[4,N.import()];case 2:o=r.sent(),r.label=3;case 3:return r.trys.push([3,7,,8]),o(e.recipient,s.a.InProgress),[4,n(i.PersonaId,i.ADObjectId,c,100,!0)];case 4:return u=r.sent(),(null===(t=u)||void 0===t?void 0:t.Members)?(d=!1,l=[],u.Members.forEach(function(e){var t;switch(e.PersonaTypeString){case"DistributionList":case"ImplicitGroup":case"ExplicitGroup":case"ModernGroup":d=!0,t={emailAddress:e.EmailAddress.EmailAddress,displayName:e.DisplayName,personaTypeString:e.PersonaTypeString};break;case"Person":case"Guest":t={emailAddress:e.EmailAddress.EmailAddress,displayName:e.DisplayName,personaTypeString:e.PersonaTypeString};break;default:p.d.error("RecipientExpansionIgnoredPersonaType: "+e.PersonaTypeString)}t&&l.push(t)}),[4,A.import()]):[3,6];case 5:return h=r.sent(),Object(f.m)("SmallDLExpansionSucceess",[d]),o(e.recipient,d?s.a.SucceededWithDLOrGroupMembers:s.a.SucceededWithoutDLOrGroupMembers),h(e.recipient,l),[2];case 6:return[3,8];case 7:return m=r.sent(),Object(f.m)("SmallDLExpansionFailure",[m.message]),[3,8];case 8:return o(e.recipient,s.a.Failed),[2]}})})}Object(_.orchestrator)(i.b,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,c,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(S.f)("doc-attachment-contextualSharingTips")&&D(e.linkIds)?[4,a.e.import()]:[2];case 1:t=r.sent(),n=t(e.recipientInfos),c=n.filter(function(e){return e.recipient.expansionStatus===s.b.None}),o=0,r.label=2;case 2:return o<c.length?[4,M(c[o])]:[3,5];case 3:r.sent(),r.label=4;case 4:return o++,[3,2];case 5:return Object(i.c)(e.linkIds,e.recipientInfos,e.composeId),[2]}})})}),Object(_.orchestrator)(i.d,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(S.f)("doc-attachment-contextualSharingTips")&&d(e.linkId)?(p.d.info("RecipientPermission: tryCheckPermForOneLink"),[4,u.q.import()]):[2];case 1:return t=r.sent(),n=t(e.recipientContainers,e.fromAddress),[4,o([e.linkId],n,e.composeId)];case 2:return 0===(i=r.sent()).length?[2]:[4,T(e.linkId,i,e.composeId)];case 3:return r.sent(),[2]}})})});var L=n(2466);Object(_.orchestrator)(i.a,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return Object(L.a)(e.composeId)&&Object(f.m)("checkPermPendingWhenSend"),[2]})})}),Object(_.orchestrator)(u.x,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return Object(S.f)("doc-attachment-contextualSharingTips")&&d(e.linkId)?[4,u.t.import()]:[2];case 1:return n.sent()(e.linkId),[4,o([e.linkId],e.recipientInfos,e.composeId)];case 2:return 0===(t=n.sent()).length?[2]:[4,T(e.linkId,t,e.composeId)];case 3:return n.sent(),[2]}})})});var F=n(2848);function $(e){return Object(F.a)().permissionCheckers.get(e)}Object(_.orchestrator)(g,function(e){var t=$(e.composeId);t?t.pendingCheckPermCount>1?y(e.composeId,-1):k(e.composeId):p.d.error("Finish check perm while tracker has not logged start. ")}),Object(_.orchestrator)(O,function(e){$(e.composeId)?y(e.composeId,1):j(e.composeId)}),Object(_.mutator)(j,function(e){Object(F.a)().permissionCheckers.set(e.composeId,{pendingCheckPermCount:1})}),Object(_.mutator)(k,function(e){Object(F.a)().permissionCheckers.delete(e.composeId)}),Object(_.mutator)(y,function(e){var t=$(e.composeId);t.pendingCheckPermCount=t.pendingCheckPermCount+e.offset}),n.d(t,"tryCheckPermForLinks",function(){return i.c}),n.d(t,"tryCheckPermForOneLink",function(){return i.d}),n.d(t,"expandGroupsAndSmallDLs",function(){return i.b})},7427:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return a});var r=n(52),i=new r.c(function(){return Promise.all([n.e(48),n.e(421)]).then(n.bind(null,9125))}),s=new r.a(i,function(e){return e.findReadWriteRecipient}),a=new r.b(i,function(e){return e.getGroupInfo})},825:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"IndexedPageView:#Exchange"},e)}},842:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemResponseShape:#Exchange"},e)}}},0,[4,12,71,319,455,565,110]]);
//# sourceMappingURL=owa.RecipientPermissionChecker.js.map
self.scriptsLoaded['owa.RecipientPermissionChecker.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.RecipientPermissionChecker.js'] = (new Date()).getTime();