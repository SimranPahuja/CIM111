self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailMessageActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[347],{1017:function(e,n,t){"use strict";t.d(n,"c",function(){return c}),t.d(n,"a",function(){return a}),t.d(n,"b",function(){return i});var r=t(40),a="HTML",i="Text",o="Html";function c(){return Object(r.a)().UserOptions.ComposeMarkup==o?"HTML":"Text"}},1058:function(e,n,t){"use strict";t.d(n,"a",function(){return c});var r=t(0),a=t(821),i=t(814),o=t(62);function c(){var e,n,t=Object(i.a)();try{for(var c=Object(r.__values)(t.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.isActive&&s.type!=a.a.FloatingChat)return s}}catch(n){e={error:n}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return o.d.error("There is no active tab. Something went very wrong."),null}},1082:function(e,n,t){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),n.a=r},1090:function(e,n,t){"use strict";var r=t(894),a=t(1002),i=t(2136),o=t(4),c=t(1322),u=t(1303),s=t(1374),l={shouldShow:!1,viewState:Object(i.a)(),extendedViewState:{previewMode:r.b.Unsupported,attachmentId:null,selectionSource:c.a.MailList,isCloudy:!1,saveToCloudStatus:s.a.disabled,textPreviewReadMode:0},editState:{mode:u.a.View,editAllowed:!1,itemId:null,isDraft:!1},customPreviewState:null,eventManager:new a.a,pendingPreviewOperation:null,pendingNavigation:null,readingPaneState:null,composeId:null,customization:null,isInvisible:!1,shouldUseFakeRightHandSide:!1,isUsingFakeRightHandSide:!1,shouldHideReadingPaneOutsideSxS:!1,attachmentViewStateIdFromListView:null,sessionPreviewCount:0,sessionStartTime:0};l.viewState.previewPane=null;var d=Object(o.createStore)("sxsstore",l);n.a=d()},1098:function(e,n,t){"use strict";var r=t(1138);t(809),t(50),t(832);t(820),t(846);t.d(n,"a",function(){return r.a})},1120:function(e,n,t){"use strict";var r=t(21),a=t(4),i={folderTable:new r.ObservableMap,rootFolder:null},o=Object(a.createStore)("publicFolderFavoriteStore",i)();n.a=o},1138:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(809);function a(){return(location?location.pathname:"").split("/").indexOf(r.c)>=0}},1157:function(e,n,t){"use strict";var r=t(821),a=t(1483),i=t(1058),o=t(1861),c=t(1952),u=t(49),s=t(1197);n.a=Object(u.c)("activateTab",a.a.TabViewActivateTab)(function(e,n){var t,a;switch(Object(o.a)(e,!0),e.type){case r.a.FloatingChat:return void Object(c.a)(e);case r.a.Primary:case r.a.OverflowMenu:case r.a.SecondaryReadingPane:case r.a.Compose:if(!e.isActive){var u,l=Object(i.a)();if(l)l.isActive=!1,(null===(t=u=Object(s.a)(l.type))||void 0===t?void 0:t.onDeactivate)&&u.onDeactivate(l);if(e)e.isActive=!0,e.blink=!1,(null===(a=u=Object(s.a)(e.type))||void 0===a?void 0:a.onActivate)&&u.onActivate(e)}return}})},1191:function(e,n,t){"use strict";t.d(n,"a",function(){return u});var r=t(0),a=t(948),i=t(814),o=t(889),c=t(160);function u(e,n,t){var u,f,b;void 0===n&&(n=0);var m=function(e){switch(e){case 0:return s;case 1:return l;case 2:return d;default:return Object(c.a)(e)}}(n),v=Object(o.b)();try{for(var p=Object(r.__values)(Object(i.a)().tabs),w=p.next();!w.done;w=p.next()){var O=w.value;if(O.type==a.a.Compose&&!O.isShown){var y=v.viewStates.get(O.data);if((null===(b=y)||void 0===b?void 0:b.isInlineCompose)&&m(y,e)&&(0==y.asyncSendState||t&&6==y.asyncSendState))return y}}}catch(e){u={error:e}}finally{try{w&&!w.done&&(f=p.return)&&f.call(p)}finally{if(u)throw u.error}}return null}function s(e,n){return e.conversationId===n}function l(e,n){return e.referenceItemId.Id===n}function d(e,n){return!1}},1197:function(e,n,t){"use strict";t.d(n,"b",function(){return i}),t.d(n,"a",function(){return o});var r=t(821),a={};function i(e,n){a[r.a[e]]=n}function o(e){return a[r.a[e]]}},1217:function(e,n,t){"use strict";t.d(n,"b",function(){return a}),t.d(n,"a",function(){return i});var r=t(1951);function a(e){var n,t,r;return e.isDirty||(null===(n=e.toRecipientWell)||void 0===n?void 0:n.isDirty)||(null===(t=e.ccRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(r=e.bccRecipientWell)||void 0===r?void 0:r.isDirty)}function i(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}},1236:function(e,n,t){"use strict";var r=t(4),a=t(131),i=t(732),o=t(21),c=Object(r.createStore)("mailboxInfoStore",new o.ObservableMap),u=t(40);function s(e){if(!e)return Object(a.e)();if(!c().has(e)){var n=function(e){var n,t,r,o=Object(i.B)(),c=o&&o.get(e);c&&c.treeType===i.l?(n=c.principalSMTPAddress,t=c.principalSMTPAddress,r=Object(a.c)()+c.principalSMTPAddress):(n=Object(a.d)(),t=Object(u.a)().SessionSettings.UserEmailAddress,r=Object(a.b)());return{type:a.a.UserMailbox,deprecatedMailboxId:n,primarySmtpAddress:t,routingKey:r,returnModernConversationItems:!1,requestOptions:Object(i.v)(e)}}(e);l(e,n)}return c().get(e)}var l=Object(r.mutatorAction)("addMailboxInfoToStore",function(e,n){c().set(e,n)}),d=t(1135),f=t(857),b=t(1971);function m(e){return e?v(e.tableQuery):Object(a.e)()}function v(e){var n,t=Object(f.b)(e),r=null===(n=e)||void 0===n?void 0:n.folderId;return null!=t?Object(d.m)(t):p(r)}function p(e){return Object(i.P)(e)?Object(b.a)(e):s(e)}t.d(n,"a",function(){return m}),t.d(n,"c",function(){return v}),t.d(n,"b",function(){return p})},1303:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.View=0]="View",e[e.EnteringEdit=1]="EnteringEdit",e[e.Edit=2]="Edit",e[e.Saving=3]="Saving"}(r||(r={}))},1322:function(e,n,t){"use strict";var r;!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub"}(r||(r={})),n.a=r},1323:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(0);function a(e){var n,t,a,i,o=[];if(null===(a=e)||void 0===a?void 0:a.recipients)try{for(var c=Object(r.__values)(e.recipients),u=c.next();!u.done;u=c.next()){var s=u.value,l=s.persona.EmailAddress;(null===(i=l)||void 0===i?void 0:i.ItemId)&&"PrivateDL"==l.MailboxType?o.push({Name:l.Name,RoutingType:l.RoutingType,MailboxType:l.MailboxType,ItemId:{Id:l.ItemId.Id,ChangeKey:null},EmailAddressIndex:l.EmailAddressIndex,RelevanceScore:l.RelevanceScore||0}):o.push(s.persona.EmailAddress)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(n)throw n.error}}return o}},1343:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(246);function a(e){var n=new Headers;return Object(r.g)(e,n),{headers:n}}},1374:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.disabled=0]="disabled",e[e.available=1]="available",e[e.saving=2]="saving",e[e.succeeded=3]="succeeded",e[e.failed=4]="failed"}(r||(r={}))},1382:function(e,n,t){"use strict";t.d(n,"b",function(){return a}),t.d(n,"a",function(){return i});var r=t(4),a=Object(r.action)("reloadReadingPaneAfterClosingSxS"),i=Object(r.action)("onSxSChangeOrClose",function(e,n){return{selectedLinkId:e,isSelectedLinkReadOnly:n}})},14107:function(e,n,t){"use strict";t.r(n);var r=t(6002),a=t(0),i=t(6189),o=t(2616),c=t(5),u=t(772),s=t(758),l=t(3331);function d(e,n,t){var r=s.a.items.get(e),a=Object(l.a)(r);return!(n.PrintAllowed&&!a.PrintAllowed||n.ForwardAllowed&&!a.ForwardAllowed||n.ReplyAllowed&&!a.ReplyAllowed||n.ReplyAllAllowed&&!a.ReplyAllAllowed)||(Object(u.b)(null,t,!1,{hideCancelButton:!0}),!1)}var f=t(4057),b=t(972),m=t(1776),v=t(1254),p=t(740),w=function(e,n){var t=p.H.items.get(e);if(!Object(v.a)(t))return!0;var r=Object(c.b)(Object(c.a)(i.a),n);return Object(u.b)(null,r,!1,{hideCancelButton:!0}),!1},O=t(69),y=Object(O.action)("forwardConversation")(function(e,n,t,r){var u;return Object(a.__awaiter)(this,void 0,void 0,function(){var s,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,Object(f.a)(e)];case 1:return s=a.sent(),(null===(u=s)||void 0===u?void 0:u.Id)&&(l={ForwardAllowed:!0},d(s.Id,l,Object(c.b)(Object(c.a)(i.a),Object(c.a)(o.a)))&&w(s.Id,Object(c.a)(o.a))&&(b.m.importAndExecute(s,n,t,r),m.c.importAndExecute())),[2]}})})}),h=t(245),g=t(1360),j=t(7157),S=function(e,n){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return Object(h.a)()?[2,!0]:(t=p.H.items.get(e),[4,g.k.import()]);case 1:return[4,a.sent()(t)];case 2:return(r=a.sent())&&Object(j.a)(n),[2,!r]}})})},I=t(7159),C=Object(O.action)("forwardItem")(function(e,n,t,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,u,s,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i={ForwardAllowed:!0},u=p.H.items.get(e.Id),(l=!Object(v.a)(u))?[3,2]:[4,S(e.Id,Object(c.a)(o.a))];case 1:l=a.sent(),a.label=2;case 2:return s=l,d(e.Id,i,Object(c.b)(Object(c.a)(I.a),Object(c.a)(o.a)))&&s&&(b.m.importAndExecute(e,n,t,r),m.c.importAndExecute()),[2]}})})}),A=t(2984),M=t(1318),P=Object(O.action)("printConversation")(function(e,n){var t;return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,Object(f.a)(e)];case 1:return r=a.sent(),(null===(t=r)||void 0===t?void 0:t.Id)&&(o={PrintAllowed:!0},d(r.Id,o,Object(c.b)(Object(c.a)(i.a),Object(c.a)(A.a)))&&(M.k.importAndExecute(r,n),Object(m.h)())),[2]}})})}),T=Object(O.action)("printItem")(function(e,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(r){return t={PrintAllowed:!0},d(e.Id,t,Object(c.b)(Object(c.a)(I.a),Object(c.a)(A.a)))&&(M.k.importAndExecute(e,n),Object(m.h)()),[2]})})}),x=t(4),R=Object(x.action)("ON_KEYBOARD_REPLY_REPLY_ALL",function(e,n,t,r){return{tableView:e,selectedNodeIds:n,selectedRowKeys:t,isReplyAll:r}}),_=Object(x.action)("ON_KEYBOARD_FORWARD",function(e,n,t){return{tableView:e,selectedNodeIds:n,selectedRowKeys:t}}),N=t(2617),E=t(2618),k=Object(O.action)("replyToConversation")(function(e,n,t,r,o,u,s,l){var v;return Object(a.__awaiter)(this,void 0,void 0,function(){var p,O,y,h;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,Object(f.a)(e)];case 1:return p=a.sent(),(null===(v=p)||void 0===v?void 0:v.Id)&&(O={ReplyAllAllowed:n,ReplyAllowed:!n},y=n?Object(c.a)(N.a):Object(c.a)(E.a),d(p.Id,O,Object(c.b)(Object(c.a)(i.a),y))&&w(p.Id,y))?(h=b.u.importAndExecute({referenceItemId:p,isReplyAll:n,useFullCompose:o,actionSource:t,instrumentationContexts:r,conversationId:o?null:e.Id,initialComposeLogTraceId:s,onComposeViewStateCreated:l,suppressServerMarkReadOnReplyOrForward:u}),m.c.importAndExecute(),[2,h]):[2]}})})}),F=t(65),L=Object(O.action)("replyToItem")(function(e,n,t,r,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,u,s,l,f,w,O;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o={ReplyAllAllowed:n,ReplyAllowed:!n},u=n?Object(c.a)(N.a):Object(c.a)(E.a),s=p.H.items.get(e.Id),(f=!Object(v.a)(s))?[3,2]:[4,S(e.Id,u)];case 1:f=a.sent(),a.label=2;case 2:return l=f,w=!0,O=void 0,Object(F.f)("cmp-inlineTranslation")&&s&&s.TranslationData&&(s.TranslationData.isShowingTranslation||s.TranslationData.isShowingForwardContentTranslation)&&(w=!1,O=s.ConversationId?s.ConversationId.Id:null),d(e.Id,o,Object(c.b)(Object(c.a)(I.a),u))&&l&&(b.u.importAndExecute({referenceItemId:e,isReplyAll:n,conversationId:O,useFullCompose:w,actionSource:r,instrumentationContexts:t,suppressServerMarkReadOnReplyOrForward:i}),m.c.importAndExecute()),[2]}})})}),D=t(5442),H=t(4949),G=t(807),U=t(731),K=t(1098),V=t(62),B="userQuote",z="smartReply",W=Object(O.action)("replyWithText")(function(e,n,t,r){var i;return Object(a.__awaiter)(this,void 0,void 0,function(){var o,c,u,s,l,d,f,m,v,p,w;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o=function(e){switch(e){case 0:return B;case 1:case 2:return z;default:return V.d.warn("replyWithText_getElementClassName: Unsupported feature inputted"),""}}(r),c=o+Math.round(1e6*Math.random()).toString(),u=Object(b.d)()===b.a,s=function(e,n,t){switch(e){case 0:return function(e,n){n=Object(D.a)(n);var t=document.createElement("blockquote");t.id=e,t.className=B,t.style.borderLeft="3px solid #C8C8C8",t.style.paddingLeft="1ex",t.style.marginLeft="0.8ex",t.style.color="#666666",t.innerHTML=n;var r=document.createElement("div");return r.appendChild(document.createElement("br")),r.appendChild(t),r.appendChild(document.createElement("br")),r}(n,t);case 1:case 2:return function(e,n){var t=document.createElement("span");t.id=e,t.innerText=n;var r=document.createElement("div");return r.appendChild(t),r}(n,t);default:return V.d.warn("[createHtmlForText] Unsupported feature"),null}}(r,c,t),l="\n"+t+"\n",u?d=l:((f=Object(H.a)()).appendChild(s),d=f.outerHTML),m=Object(b.c)(n),v=null,m?(v=m,[3,4]):[3,1];case 1:return[4,b.v.import()];case 2:return[4,a.sent()({referenceItemOrId:e,isReplyAll:!0,useFullCompose:1==Q()||Object(G.a)()||Object(K.a)(),conversationId:n,body:d,instrumentationContexts:[],useCortanaSchedulingAssistant:2==r})];case 3:v=a.sent(),a.label=4;case 4:return v?[4,b.l.import()]:[3,6];case 5:(p=a.sent())&&(w=p(v),(null===(i=w)||void 0===i?void 0:i.contentOperation)&&(m?w.contentOperation.insertContentIntoEditor(u?l:s.outerHTML,function(e){switch(e){case 0:return"UserMarkup";case 1:case 2:return"SmartReply";default:return V.d.warn("replyWithText_getEventName: Unsupported feature inputted"),""}}(r),!1,!0):u||w.contentOperation.moveCaretBelowHtmlElement(c))),a.label=6;case 6:return[2,v]}})})});function Q(){var e,n=null,t=Object(U.B)();return(null===(e=t)||void 0===e?void 0:e.tableQuery)&&(n=t.tableQuery.listViewType),n}var Y=t(3196),q=Object(O.action)("showConversationInImmersiveReader")(function(e,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return[4,Object(f.a)(e)];case 1:return(t=r.sent())&&Object(Y.a)(t,n),[2]}})})}),J=t(1581),$=t(864),X=t(1834),Z=t(2740);Object(x.orchestrator)(R,function(e){var n=e.tableView,t=e.selectedNodeIds,r=e.selectedRowKeys,a=e.isReplyAll,i=Object(U.R)(n);if(t.length>0){if(1!==t.length)return;var o=Object(X.b)(t[0]),c=Object(Z.b)(o,n);L(c,a,null,"Keyboard",i)}else{if(1!==r.length)return;var u=U.b.getRowClientItemId(r[0],n),s=void 0;switch(1==n.tableQuery.type&&(s=Object(J.a)([r[0]],n)),n.tableQuery.listViewType){case 0:k(u,a,"Keyboard",s,Object($.o)(),i);break;case 1:L(u,a,s,"Keyboard",i)}}}),Object(x.orchestrator)(_,function(e){var n=e.tableView,t=e.selectedNodeIds,r=e.selectedRowKeys,a=Object(U.R)(n);if(t.length>0){if(1!==t.length)return;var i=Object(X.b)(t[0]),o=Object(Z.b)(i,n);C(o,"Keyboard",null,a)}else{if(1!==r.length)return;var c=U.b.getRowClientItemId(r[0],n),u=void 0;switch(1==n.tableQuery.type&&(u=Object(J.a)([r[0]],n)),n.tableQuery.listViewType){case 0:y(c,"Keyboard",u,a);break;case 1:C(c,"Keyboard",u,a)}}});t.d(n,"newMessage",function(){return r.a}),t.d(n,"forwardConversation",function(){return y}),t.d(n,"forwardItem",function(){return C}),t.d(n,"printConversation",function(){return P}),t.d(n,"printItem",function(){return T}),t.d(n,"onKeyboardReply",function(){return R}),t.d(n,"onKeyboardForward",function(){return _}),t.d(n,"replyToConversation",function(){return k}),t.d(n,"replyToItem",function(){return L}),t.d(n,"replyWithText",function(){return W}),t.d(n,"showConversationInImmersiveReader",function(){return q})},1412:function(e,n,t){"use strict";var r=t(745),a=t.n(r),i=t(69);function o(e){e&&(e.isDirty=!1)}n.a=Object(i.action)("updateComposeItemId")(function(e,n,t,r){e&&(e.itemId?e.itemId.ChangeKey=t:e.itemId=a()({Id:n,ChangeKey:t}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,o(e.toRecipientWell),o(e.ccRecipientWell),o(e.bccRecipientWell)))})},1413:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(0),a=t(1754);function i(e){var n;return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,a.c.import()];case 1:return t=r.sent(),e&&t(null===(n=e.referenceItemId)||void 0===n?void 0:n.Id),[2]}})})}},1482:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(4),a=Object(r.action)("messageBeingSent")},1483:function(e,n,t){"use strict";n.a={TabViewAddTab:{name:"TabViewAddTab",customData:function(e,n,t,r){return[e,n,t]}},TabViewCloseTab:{name:"TabViewCloseTab",customData:function(e,n){return[e.type,e.isShown,e.isActive,n,e.startTime?(new Date).getTime()-e.startTime:0]}},TabViewActivateTab:{name:"TabViewActivateTab",customData:function(e,n){return[e.type,n]},options:{isVerbose:!0}}}},1484:function(e,n,t){"use strict";var r=t(4),a=Object(r.createStore)("MRUAttachmentStore",{attachments:[]});n.a=a},1485:function(e,n,t){"use strict";var r=t(4);n.a=Object(r.action)("onInlineComposeSendStateChange",function(e,n){return{viewState:e,isSendPending:n}})},1499:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.Initial=0]="Initial",e[e.Adaptive=1]="Adaptive",e[e.Show=2]="Show",e[e.Hide=3]="Hide",e[e.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},1538:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.Blank=0]="Blank",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Custom=3]="Custom",e[e.Image=4]="Image",e[e.Wac=5]="Wac",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.Text=8]="Text",e[e.NativePdf=9]="NativePdf",e[e.PdfJs=10]="PdfJs",e[e.IFrame=11]="IFrame"}(r||(r={}))},1581:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(990);function a(e,n){return e.map(function(e){return Object(r.getInstrumentationContext)(e,n)}).filter(function(e){return e})}},1583:function(e,n,t){"use strict";t.r(n),t.d(n,"EnteredEditModeEvent",function(){return r}),t.d(n,"ExitedEditModeEvent",function(){return a}),t.d(n,"PreviewLoadEvent",function(){return i}),t.d(n,"PreviewErrorEvent",function(){return o}),t.d(n,"PreviewLoadOrErrorEvent",function(){return c}),t.d(n,"CloseEvent",function(){return u}),t.d(n,"AnimationEndEvent",function(){return s});var r="EnteredEditMode",a="ExitedEditMode",i="PreviewLoad",o="PreviewError",c="PreviewLoadOrError",u="Close",s="AnimationEnd"},1693:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.ConversationReadingPane=0]="ConversationReadingPane",e[e.ItemReadingPane=1]="ItemReadingPane"}(r||(r={}))},1723:function(e,n,t){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected",e[e.SelectedAndPending=3]="SelectedAndPending",e[e.SelectedAndSaving=4]="SelectedAndSaving",e[e.NotSelectedAndSaving=5]="NotSelectedAndSaving",e[e.OtherSaving=6]="OtherSaving",e[e.PendingNavigation=7]="PendingNavigation"}(r||(r={})),n.a=r},1754:function(e,n,t){"use strict";t.d(n,"c",function(){return o}),t.d(n,"b",function(){return c});var r=t(52),a=t(1484);t.d(n,"a",function(){return a.a});var i=new r.c(function(){return Promise.all([t.e(4),t.e(130)]).then(t.bind(null,3049))}),o=new r.b(i,function(e){return e.getAttachmentSuggestionsAction}),c=new r.b(i,function(e){return e.createCloudFileFromAttachmentData})},1776:function(e,n,t){"use strict";var r,a=t(2439),i=t(1036),o=t(1037),c=t(69),u=t(807),s=Object(c.action)("onNewMessage")(function(e){e||(Object(o.a)(!0),Object(i.a)(!Object(u.b)()))}),l=Object(c.action)("onPrintRow")(function(){Object(u.b)()&&(Object(o.a)(!0),Object(i.a)(!1))}),d=t(0),f=t(761),b=t(1581),m=t(40),v=t(1056),p=t(740),w=t(1040),O=t(2290),y=t(731),h=t(754),g=t(1570),j=t(151),S=t(1318),I=t(786),C=t(49),A=t(2955);function M(e,n,t,r,a,c,u,s,l){var d=Promise.resolve(),f=!1,b=!0;switch(c){case v.a.MailListItemBody:case v.a.CommandBarArrows:case v.a.KeyboardEnter:case v.a.MailListItemExpansion:case v.a.MailListItemRichPreview:case v.a.SearchSuggestionClick:case v.a.RouteHandler:f=!0,b=!1;break;case v.a.MailListItemTwisty:d=function(e){if(Object(p.C)(e.Id))return Promise.resolve();return Object(g.d)(e,"LoadConversationReadingPane")}(e),f=!1,b=!0;break;case v.a.ImmersiveReadingPaneDelete:"ReturnToView"===Object(m.a)().UserOptions.NextSelection?(f=!1,b=!0):(f=!0,b=!1);break;case v.a.KeyboardUpDown:case v.a.MailListItemCheckbox:case v.a.KeyboardCtrlSpace:case v.a.MailListItemContextMenu:case v.a.NewConversation:case v.a.Reset:case v.a.RowRemoval:default:f=!1,b=!0}if(f)switch(n){case 0:d=S.g.importAndExecute(e,a,u,t,r,l);break;case 1:d=S.i.importAndExecute(e,a,u,s)}return Object(o.a)(f),Object(i.a)(b),d}var P=0;function T(e,n,t,r,a,i,o,c){switch(n){case 0:return S.g.importAndExecute(e,a,i,t,r,c);case 1:return S.i.importAndExecute(e,a,i,o);default:return Promise.resolve()}}var x=Object(c.action)("onListViewSelectionChange")(Object(c.select)({listViewStore:function(){return y.O}})(function(e,n,t,a){return Object(d.__awaiter)(this,void 0,void 0,function(){var a,c,s,l,f,m,p,g,j,S,I,C,x,_;return Object(d.__generator)(this,function(N){return t==v.a.MessageAd?[2]:(a=Promise.resolve(),0==(c=e.selectedRowKeys.size)?(Object(i.a)(!0),Object(u.b)()?Object(o.a)(!1):Object(o.a)(!0)):1!=c||Object(u.b)()&&e.isInCheckedMode?Object(u.b)()&&(Object(o.a)(!1),Object(i.a)(!0)):(s=null,l=Object(d.__spread)(e.selectedRowKeys.keys())[0],f=y.b.getRowClientItemId(l,e),m=y.b.getIsDraft(l,e),p=y.b.getIsSubmitted(l,e),g=e.tableQuery,j=Object(y.J)(g)||Object(O.c)(g),S=m&&!p&&!j,I=Object(b.a)([l],e)[0],C=y.b.getCategories(l,e),x=y.b.getSubject(l,e),Object(w.a)("sea-qf")&&I&&(h.C.importAndExecute(I.traceId,I.referenceKey,new Date,h.a.Mail,I.index),_=y.b.getItemIds(l,e),s=_?_[0]:null,R(l,e)),j||(Object(u.c)()||Object(u.a)()?a=function(e,n,t,a,c,u,s,l,d){if(r&&(clearTimeout(r),r=null),Object(o.a)(!0),Object(i.a)(!0),u===v.a.KeyboardUpDown){var f=Date.now(),b=f-P;if(P=f,b<=500)return new Promise(function(i,o){r=setTimeout(function(){r=null,T(e,n,t,a,c,s,l,d).then(function(){i()}).catch(function(e){o(e)})},250)})}return T(e,n,t,a,c,s,l,d)}(f,g.listViewType,x,C,n,t,I,S,s):Object(u.b)()&&(a=M(f,g.listViewType,x,C,n,t,I,S,s)))),Object(A.a)(),[2,a])})})}));var R=function(e,n){var t,r,a=y.b.getParentFolderId(e,n);if(a){var i=!1,o=!1;try{for(var c=Object(d.__values)(n.rowKeys),u=c.next();!u.done;u=c.next()){var s=u.value;if(i&&o)break;var l="deleteditems"===Object(f.a)(y.b.getParentFolderId(s,n));l&&!i&&(i=!0),l||o||(o=!0)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}var b=[10,25,75,150,250];Object(j.m)("SearchResultSelected",["Relevance"===y.b.getExecuteSearchSortOrder(e,n),Object(f.a)(a),Object(C.d)({value:n.rowKeys.indexOf(e),buckets:b}),Object(C.d)({value:n.rowKeys.length,buckets:b}),i,o,I.b.Mail])}},_=x,N=t(52),E=(t(888),t(1526)),k=t(1175);t.d(n,"b",function(){return L}),t.d(n,"c",function(){return D}),t.d(n,"e",function(){return H}),t.d(n,"d",function(){return U}),t.d(n,"i",function(){return K}),t.d(n,"g",function(){return s}),t.d(n,"f",function(){return _}),t.d(n,"h",function(){return l}),t.d(n,"a",function(){return a.a});var F=new N.c(function(){return t.e(351).then(t.bind(null,14151))}),L=new N.a(F,function(e){return e.closeImmersiveReadingPane}),D=new N.a(F,function(e){return e.onReplyOrReplyAllOrForwardMessage}),H=new N.a(F,function(e){return e.onSelectingFolder}),G=(new N.b(F,function(e){return e.onSxSPreviewPaneClose}),new N.a(F,function(e){return e.onReadingPanePositionOptionSaved})),U=new N.a(F,function(e){return e.onSelectMessageAd});function K(){Object(E.subscribe)("saveReadingPanePositionOptionStitchName",function(){return G.importAndExecute()})}Object(N.f)(k.a,F,function(e){return e.onClientReadingPanePositionChangeOrchestrator})},1834:function(e,n,t){"use strict";t.d(n,"a",function(){return s}),t.d(n,"c",function(){return l}),t.d(n,"b",function(){return d});var r=t(0),a=t(758),i=t(1373),o=t(861),c=t(40),u=t(1072);function s(e){var n,t,c,s=(null===(c=e)||void 0===c?void 0:c.itemIds)?e.itemIds.length:0;if(0==s)return[null,!1,!1];var l=null,d=2==Object(o.c)().type||!Object(o.b)();if(1==s){if(!(l=a.a.items.get(e.itemIds[0])))return[null,!1,!1];d=d||l.ParentFolderId&&l.ParentFolderId.Id==Object(o.b)()}else{var f=null;try{for(var b=Object(r.__values)(e.itemIds),m=b.next();!m.done;m=b.next()){var v=m.value,p=a.a.items.get(v);if(!p)return[null,!1,!1];if(p.ParentFolderId&&p.ParentFolderId.Id==Object(o.b)()){l=p,d=!0;break}Object(u.a)(p.ParentFolderId.Id,"sentitems")&&(f=p)}}catch(e){n={error:e}}finally{try{m&&!m.done&&(t=b.return)&&t.call(b)}finally{if(n)throw n.error}}l||(l=f||a.a.items.get(e.itemIds[0]))}return[l,d,Object(i.a)(l.ParentFolderId.Id)]}function l(e,n,t){var r=Object(c.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||r)&&n&&!t)}function d(e){var n=a.a.conversationNodes.get(e),t=Object(r.__read)(s(n),3),i=t[0],o=t[1];return l(i,t[2],o)?i:null}},1861:function(e,n,t){"use strict";var r=t(1157),a=t(69),i=t(814);n.a=Object(a.action)("setTabIsShown")(function(e,n){if(e.isShown!=n&&(e.isShown=n,e.blink=n,e.isActive&&!n)){var t=Object(i.a)(),a=t.tabs.indexOf(e),o=t.tabs.filter(function(n){return n.id==e.parentTabId&&n.isShown})[0]||function(e,n){n<0&&(n=0);for(var t=n;t<e.length;t++)if(e[t].isShown)return e[t];for(t=n-1;t>=0;t--)if(e[t].isShown)return e[t];return null}(t.tabs,a);o&&Object(r.a)(o)}})},1910:function(e,n,t){"use strict";var r=t(0),a=t(1157),i=t(1483),o=t(1058),c=t(821),u=t(49),s=t(814),l=1;n.a=Object(u.c)("addTab",i.a.TabViewAddTab)(function(e,n,t,i){var u=Object(o.a)(),d=Object(s.a)(),f={id:c.a[e]+(l++).toString(),isShown:n,isActive:!1,startTime:(new Date).getTime(),parentTabId:u?u.id:null,blink:n,data:i},b=null;switch(e){case c.a.Primary:b=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.Primary});break;case c.a.OverflowMenu:b=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.OverflowMenu,data:i});break;case c.a.SecondaryReadingPane:b=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.SecondaryReadingPane,data:i});break;case c.a.Compose:b=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.Compose,data:i});break;case c.a.FloatingChat:b=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.FloatingChat,data:i,isChatActive:!1})}d.tabs.push(b),t&&Object(a.a)(d.tabs[d.tabs.length-1])})},1951:function(e,n,t){"use strict";function r(e){var n;return(null===(n=e)||void 0===n?void 0:n.recipients)?e.recipients.length:0}t.d(n,"a",function(){return r})},1952:function(e,n,t){"use strict";var r=t(69);n.a=Object(r.action)("toggleChatTab")(function(e){e.isChatActive=!e.isChatActive,e.isActive=e.isChatActive,e.blink=!1})},1971:function(e,n,t){"use strict";var r=t(731),a=t(732);function i(){var e=Object(r.B)();return e&&0==e.tableQuery.type&&Object(a.P)(e.tableQuery.folderId)}function o(){var e=Object(r.B)();return e&&0==e.tableQuery.type&&Object(a.P)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var c=t(4),u=t(131),s=t(1343),l=t(1120),d=t(40),f=t(21),b=Object(c.createStore)("publicFolderUtilsStore",new f.ObservableMap);function m(e){if(!b().has(e)){var n=l.a.folderTable.get(e),t=null!=n.ReplicaList?n.ReplicaList[0]:Object(d.a)().SessionSettings.DefaultPublicFolderMailbox,r={type:null,deprecatedMailboxId:e,primarySmtpAddress:n.principalSMTPAddress,routingKey:Object(u.c)()+t,returnModernConversationItems:null,requestOptions:Object(s.a)(t)};v(e,r)}return b().get(e)}var v=Object(c.mutatorAction)("addPublicFolderMailboxInfoToStore",function(e,n){b().set(e,n)});t.d(n,"b",function(){return o}),t.d(n,"c",function(){return i}),t.d(n,"a",function(){return m})},2136:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(1002),a=t(1538),i=t(1499);function o(){return{previewPane:{downloadUrl:null,mode:a.a.Blank},didAutoHideRightPane:!1,hideRightPane:!1,rightPaneSize:0,leftPaneSizePixels:0,rightPaneSizePixels:0,rightPaneDisplay:i.a.Initial,eventManager:new r.a}}},2290:function(e,n,t){"use strict";var r=t(0);function a(e,n,t,a,i,o,c,u){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:n,searchScope:t,pillSuggestions:Object(r.__spread)(a.values()),includeAttachments:o,fromDate:c,toDate:u,scenarioType:"mail",lastIndexFetched:0}}function i(e){var n=e;return 1==e.type?n.scenarioType:void 0}var o=t(732),c=t(740),u=t(737),s=t(754);function l(e){var n=e;return Object(c.y)(n.folderId)?Object(s.e)(n.searchScope,Object(s.c)({folderId:Object(u.a)(o.b),kind:"ArchiveMailbox"})):Object(s.e)(n.searchScope,Object(s.Q)({folderId:Object(u.a)(o.i),kind:"PrimaryMailbox"}))}t.d(n,"a",function(){return a}),t.d(n,"b",function(){return i}),t.d(n,"c",function(){return l})},2371:function(e,n,t){"use strict";function r(e){return e.localizedName?e.localizedName:e.name}var a=[{name:"Arial",family:"Arial,Helvetica,sans-serif"},{name:"Arial Black",family:"'Arial Black',Arial,sans-serif"},{name:"Calibri",family:"Calibri,Helvetica,sans-serif"},{name:"Calibri Light",family:"'Calibri Light','Helvetica Light',sans-serif"},{name:"Cambria",family:"Cambria,Georgia,serif"},{name:"Candara",family:"Candara,Optima,sans-serif"},{name:"Century Gothic",family:"'Century Gothic',sans-serif"},{name:"Comic Sans MS",family:"'Comic Sans MS',Chalkboard,cursive"},{name:"Consolas",family:"Consolas,Courier,monospace"},{name:"Constantia",family:"Constantia,'Hoefler Text',serif"},{name:"Corbel",family:"Corbel,Skia,sans-serif"},{name:"Courier New",family:"'Courier New',monospace"},{name:"Franklin Gothic Book",family:"'Franklin Gothic Book','Avenir Next Condensed',sans-serif"},{name:"Franklin Gothic Demi",family:"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif"},{name:"Franklin Gothic Medium",family:"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif"},{name:"Garamond",family:"Garamond,Georgia,serif"},{name:"Georgia",family:"Georgia,serif"},{name:"Impact",family:"Impact,Charcoal,sans-serif"},{name:"Lucida Console",family:"'Lucida Console',Monaco,monospace"},{name:"Lucida Handwriting",family:"'Lucida Handwriting','Apple Chancery',cursive"},{name:"Lucida Sans Unicode",family:"'Lucida Sans Unicode','Lucida Grande',sans-serif"},{name:"Palatino Linotype",family:"'Palatino Linotype','Book Antiqua',Palatino,serif"},{name:"Segoe UI",family:"'Segoe UI','Helvetica Neue',sans-serif"},{name:"Sitka Heading",family:"'Sitka Heading',Cochin,serif"},{name:"Sitka Text",family:"'Sitka Text',Cochin,serif"},{name:"Tahoma",family:"Tahoma,Geneva,sans-serif"},{name:"Times",family:"Times,'Times New Roman',serif"},{name:"Times New Roman",family:"'Times New Roman',Times,serif"},{name:"Trebuchet MS",family:"'Trebuchet MS',Trebuchet,sans-serif"},{name:"TW Cen MT",family:"'TW Cen MT','Century Gothic',sans-serif"},{name:"Verdana",family:"Verdana,Geneva,sans-serif"},{name:"-",family:"-"},{name:"Microsoft YaHei",family:"'Microsoft YaHei','微软雅黑',STHeiti,sans-serif",localizedName:"微软雅黑"},{name:"SimHei",family:"SimHei,'黑体',STHeiti,sans-serif",localizedName:"黑体"},{name:"NSimSun",family:"NSimSun,'新宋体',SimSun,'宋体',SimSun-ExtB,'宋体-ExtB',STSong,serif",localizedName:"新宋体"},{name:"FangSong",family:"FangSong,'仿宋',STFangsong,serif",localizedName:"仿宋"},{name:"SimLi",family:"SimLi,'隶书','Baoli SC',serif",localizedName:"隶书"},{name:"KaiTi",family:"KaiTi,'楷体',STKaiti,serif",localizedName:"楷体"},{name:"-",family:"-"},{name:"Microsoft JhengHei",family:"'Microsoft JhengHei','微軟正黑體','Apple LiGothic',sans-serif",localizedName:"微軟正黑體"},{name:"PMingLiU",family:"PMingLiU,'新細明體',PMingLiU-ExtB,'新細明體-ExtB','Apple LiSung',serif",localizedName:"新細明體"},{name:"DFKai-SB",family:"DFKai-SB,'標楷體','BiauKai',serif",localizedName:"標楷體"},{name:"-",family:"-"},{name:"Meiryo",family:"Meiryo,'メイリオ','Hiragino Sans',sans-serif",localizedName:"メイリオ"},{name:"MS PGothic",family:"'MS PGothic','ＭＳ Ｐゴシック','MS Gothic','ＭＳ ゴシック','Hiragino Kaku Gothic ProN',sans-serif",localizedName:"ＭＳ Ｐゴシック"},{name:"MS PMincho",family:"'MS PMincho','ＭＳ Ｐ明朝','MS Mincho','ＭＳ 明朝','Hiragino Mincho ProN',serif",localizedName:"ＭＳ Ｐ明朝"},{name:"Yu Gothic",family:"'Yu Gothic','游ゴシック','YuGothic',sans-serif",localizedName:"游ゴシック"},{name:"Yu Mincho",family:"'Yu Mincho','游明朝','YuMincho',serif",localizedName:"游明朝"},{name:"-",family:"-"},{name:"Malgun Gothic",family:"'Malgun Gothic','맑은 고딕',AppleGothic,sans-serif",localizedName:"맑은 고딕"},{name:"Gulim",family:"Gulim,'굴림','Nanum Gothic',sans-serif",localizedName:"굴림"},{name:"Dotum",family:"Dotum,'돋움',AppleGothic,sans-serif",localizedName:"돋움"},{name:"Batang",family:"Batang,'바탕',AppleMyungjo,serif",localizedName:"바탕"},{name:"BatangChe",family:"BatangChe,'바탕체',AppleMyungjo,serif",localizedName:"바탕체"},{name:"Gungsuh",family:"Gungsuh,'궁서',GungSeo,serif",localizedName:"궁서"},{name:"-",family:"-"},{name:"Leelawadee UI",family:"'Leelawadee UI',Thonburi,sans-serif"},{name:"Angsana New",family:"'Angsana New','Leelawadee UI',Sathu,serif"},{name:"Cordia New",family:"'Cordia New','Leelawadee UI',Silom,sans-serif"},{name:"DaunPenh",family:"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif"},{name:"-",family:"-"},{name:"Nirmala UI",family:"'Nirmala UI',sans-serif"},{name:"Gautami",family:"Gautami,'Nirmala UI','Telugu MN',sans-serif"},{name:"Iskoola Pota",family:"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif"},{name:"Kalinga",family:"Kalinga,'Nirmala UI','Oriya MN',sans-serif"},{name:"Kartika",family:"Kartika,'Nirmala UI','Malayalam MN',sans-serif"},{name:"Latha",family:"Latha,'Nirmala UI','Tamil MN',sans-serif"},{name:"Mangal",family:"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif"},{name:"Raavi",family:"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif"},{name:"Shruti",family:"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif"},{name:"Tunga",family:"Tunga,'Nirmala UI','Kannada MN',sans-serif"},{name:"Vrinda",family:"Vrinda,'Nirmala UI','Bangla MN',sans-serif"},{name:"-",family:"-"},{name:"Nyala",family:"Nyala,Kefa,sans-serif"},{name:"Sylfaen",family:"Sylfaen,Mshtakan,Menlo,serif"}];function i(e){for(var n=e.toUpperCase(),t=0;t<a.length;t++){var r=a[t];if(r.name.toUpperCase()==n||r.localizedName&&r.localizedName.toUpperCase()==n)return r.family}return null}var o="pt",c=[8,10,12,14,18,24,36],u=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],s=u.map(function(e){return e.toString()});function l(e){return"number"==typeof e&&e<=7?c[e-1]:e}function d(e){var n=l(e).toString();return n?n+o:n}t.d(n,"g",function(){return r}),t.d(n,"a",function(){return a}),t.d(n,"d",function(){return i}),t.d(n,"b",function(){return u}),t.d(n,"c",function(){return s}),t.d(n,"e",function(){return l}),t.d(n,"f",function(){return d})},2439:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(4),a=Object(r.action)("exitSearch",function(e){return{actionSource:e}})},2616:function(e){e.exports={a:"foa"}},2617:function(e){e.exports={a:"eoa"}},2618:function(e){e.exports={a:"doa"}},2740:function(e,n,t){"use strict";t.d(n,"b",function(){return a}),t.d(n,"a",function(){return i});var r=t(869);function a(e,n){return{Id:e.ItemId.Id,mailboxInfo:Object(r.b)(n)}}function i(e,n){return{executeSearchSortOrder:e.SortOrderSource,clientId:a(e,n),instanceKey:e.InstanceKey}}},2777:function(e,n,t){"use strict";t.d(n,"a",function(){return c}),t.d(n,"b",function(){return u});var r=t(0),a=t(40),i=t(2371),o={fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000",bold:!1,italic:!1,underline:!1};function c(){var e=Object(a.a)().UserOptions;return e?u(e.ComposeFontName,e.ComposeFontSize,e.ComposeFontColor,e.ComposeFontFlags):o}function u(e,n,t,a){var c=Object(r.__assign)({},o),u=e?Object(i.d)(e):null;u&&(c.fontFamily=u);var s=n?Object(i.f)(n):null;return s&&(c.fontSize=s),t&&(c.textColor=t),a&&(c.bold=1==(1&a),c.italic=2==(2&a),c.underline=4==(4&a)),c}},2955:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(4),a=Object(r.action)("ON_LISTVIEW_SELECTION_CHANGE_COMPLETE")},2984:function(e){e.exports={a:"ooa"}},3196:function(e,n,t){"use strict";var r=t(4);n.a=Object(r.action)("SHOW_IN_IMMERSIVE_READER",function(e,n,t){return{itemId:e,actionSource:n,subActionSource:t}})},3331:function(e,n,t){"use strict";function r(e){var n,t=e?e.RightsManagementLicenseData:null,r={ReplyAllowed:!0,ReplyAllAllowed:!0,ForwardAllowed:!0,PrintAllowed:!0,CopyAllowed:!0};!t||t.RightsManagedMessageDecryptionStatus&&0!=t.RightsManagedMessageDecryptionStatus||(r={ReplyAllowed:t.ReplyAllowed,ReplyAllAllowed:t.ReplyAllAllowed,ForwardAllowed:t.ForwardAllowed,PrintAllowed:t.PrintAllowed,CopyAllowed:t.ExtractAllowed});var a=null===(n=e)||void 0===n?void 0:n.DoNotForwardMeeting;return r.ForwardAllowed=r.ForwardAllowed&&!a,r}t.d(n,"a",function(){return r})},4057:function(e,n,t){"use strict";var r=t(0),a=t(748),i=t(1318);n.a=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,i.c.import()];case 1:return(n=r.sent())(e)?[3,4]:(t=a.a.conversationItems.get(e.Id))?[4,i.f.import()]:[3,4];case 2:return[4,r.sent()(e,null,t.subject)];case 3:r.sent(),r.label=4;case 4:return[2,n(e)]}})})}},4949:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(2777);function a(){var e=document.createElement("div"),n=e.style,t=Object(r.a)();return t.fontFamily&&(n.fontFamily=t.fontFamily),t.fontSize&&(n.fontSize=t.fontSize),t.textColor&&(n.color=t.textColor),t.bold&&(n.fontWeight="bold"),t.italic&&(n.fontStyle="italic"),t.underline&&(n.textDecoration="underline"),e}n.b=function(){return(e=a()).appendChild(document.createElement("br")),e.outerHTML;var e}},5442:function(e,n,t){"use strict";function r(e){return e?"<div>"+(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&#39;")).replace(/"/g,"&quot;")).replace(/^ /gm,"&nbsp;")).replace(/(\n|\r\n)/g,"<br></div><div>")).replace(/\s\s/g," &nbsp;"))+"<br></div>":e}t.d(n,"a",function(){return r})},6002:function(e,n,t){"use strict";var r=t(0),a=t(3194),i=t(972),o=t(1776),c=t(49),u=t(151),s=t(319),l=(t(764),t(797));n.a=Object(c.c)("newMessage",a.a.MailComposeNew)(function(e,n,t,a,c,d){return Object(r.__awaiter)(this,void 0,void 0,function(){var f,b,m,v,p,w;return Object(r.__generator)(this,function(O){switch(O.label){case 0:return 0!==(f=d?2:Object(l.u)()?0:1)?[3,2]:[4,i.x.importAndExecute(null)];case 1:O.sent(),O.label=2;case 2:return b=Object(i.d)(),m=[],t&&m.push.apply(m,Object(r.__spread)(t)),v=Object(s.a)(),(p=Object(u.o)())&&p.addCustomData({composeTraceId:v,actionSource:e}),w={operation:0,bodyType:b,to:m,preferAsyncSend:!0,subject:a,newContent:c,logTraceId:v},[4,i.r.importAndExecute(w,f,n)];case 3:return O.sent(),Object(o.g)(1===f),[2]}})})})},6189:function(e){e.exports={a:"xNb"}},7157:function(e,n,t){"use strict";var r=t(7158),a=t(5),i=t(772);n.a=function(e){var n=Object(a.b)(Object(a.a)(r.a),e);Object(i.b)(null,n,!1,{hideCancelButton:!0})}},7158:function(e){e.exports={a:"zNb"}},7159:function(e){e.exports={a:"yNb"}},809:function(e,n,t){"use strict";t.d(n,"c",function(){return i}),t.d(n,"b",function(){return o}),t.d(n,"h",function(){return c}),t.d(n,"g",function(){return u}),t.d(n,"f",function(){return s}),t.d(n,"d",function(){return l}),t.d(n,"e",function(){return d}),t.d(n,"a",function(){return f});var r=t(0),a=t(904),i="deeplink",o="compose",c="reply",u="replyall",s="read",l="group",d="/"+Object(r.__spread)(["mail"],Object(a.a)().split("/").slice(1)).join("/")+i+"/",f="/"+Object(r.__spread)(["calendar"],Object(a.a)().split("/").slice(1)).join("/")+i+"/"},814:function(e,n,t){"use strict";t.d(n,"a",function(){return o}),t.d(n,"b",function(){return c});var r=t(821),a=t(4),i={tabs:[{id:"primaryTab",type:r.a.Primary,isShown:!0,isActive:!0,blink:!1}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(a.createStore)("tab",i),c=(o(),o().tabs[0])},820:function(e,n,t){"use strict";var r=t(809),a=t(50),i=t(832),o=t(39);function c(e,n){if(n){var t=n.displayName?n.displayName+"<"+n.smtpAddress+">":n.smtpAddress;return e?"&"+e+"="+t:t}return""}function u(e,n){return n?"&"+e+"="+n:""}function s(e){var n;if(!(null===(n=e.to)||void 0===n?void 0:n.smtpAddress))return"";var t=o.parse(Object(a.a)().search.substr(1));return t.mailtouri=function(e){var n;if(!(null===(n=e.to)||void 0===n?void 0:n.smtpAddress))return"";var t="mailto:"+c(null,e.to),r="";return r+=c("cc",e.cc),r+=c("bcc",e.bcc),r+=u("subject",e.subject),(r+=u("body",e.body))?t+"?"+r.slice(1):t}(e),Object(i.a)(r.e,r.b,"?"+o.stringify(t))}t.d(n,"a",function(){return s})},821:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat"}(r||(r={}))},832:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(248);function a(e,n,t){var a={pathname:e+n,search:t};return r.format(a)}},846:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(809),a=t(50),i=t(832);function o(e){return e?Object(i.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(a.a)().search):""}},869:function(e,n,t){"use strict";var r=t(1236),a=t(731);function i(){return Object(r.a)(Object(a.B)())}t.d(n,"b",function(){return r.a}),t.d(n,"c",function(){return r.c}),t.d(n,"a",function(){return i})},888:function(e,n,t){"use strict";var r,a=t(1723),i=t(1322),o=t(1303),c=t(1374),u=t(1693);!function(e){e[e.Mail=0]="Mail",e[e.FilesHub=1]="FilesHub",e[e.DeepLink=2]="DeepLink",e[e.GroupFilesHub=3]="GroupFilesHub"}(r||(r={}));var s=t(1583),l=t(993);function d(){return Object(l.a)()}t(894);var f=t(52),b=t(1382);t(0);var m=t(1090);t.d(n,"C",function(){return p}),t.d(n,"m",function(){return w}),t.d(n,"n",function(){return O}),t.d(n,"o",function(){return y}),t.d(n,"p",function(){return h}),t.d(n,"q",function(){return g}),t.d(n,"r",function(){return j}),t.d(n,"s",function(){return S}),t.d(n,"t",function(){return I}),t.d(n,"u",function(){return C}),t.d(n,"y",function(){return A}),t.d(n,"v",function(){return M}),t.d(n,"w",function(){return P}),t.d(n,"x",function(){return T}),t.d(n,"z",function(){return x}),t.d(n,"A",function(){return R}),t.d(n,"B",function(){return _}),t.d(n,"D",function(){return N}),t.d(n,"F",function(){return b.b}),t.d(n,"E",function(){return b.a}),t.d(n,"G",function(){return m.a}),t.d(n,"a",function(){return a.a}),t.d(n,"b",function(){return o.a}),t.d(n,"h",function(){return d}),t.d(n,"i",function(){return l.a}),t.d(n,"j",function(){return l.b}),t.d(n,"k",function(){return l.c}),t.d(n,"l",function(){return l.d}),t.d(n,"c",function(){return i.a}),t.d(n,"d",function(){return c.a}),t.d(n,"e",function(){return r}),t.d(n,"f",function(){return s}),t.d(n,"g",function(){return u.a});var v=new f.c(function(){return Promise.all([t.e(79),t.e(628),t.e(4),t.e(12),t.e(471)]).then(t.bind(null,14059))}),p=new f.b(v,function(e){return e}),w=new f.b(v,function(e){return e.canCloseSxS}),O=new f.b(v,function(e){return e.closeComposeInSxS}),y=new f.b(v,function(e){return e.createImageGalleryFromAttachmentViewStateIds}),h=new f.b(v,function(e){return e.editAndReply}),g=new f.b(v,function(e){return e.editInDraft}),j=new f.b(v,function(e){return e.forceCloseSxS}),S=new f.a(v,function(e){return e.logUsageWithSxSCustomData}),I=new f.b(v,function(e){return e.onBeforeImageGalleryItemSelected}),C=new f.b(v,function(e){return e.onChangeByImageGallery}),A=new f.b(v,function(e){return e.onSxSReadingPaneChange}),M=new f.b(v,function(e){return e.onPendingNavigation}),P=new f.b(v,function(e){return e.onPreviewOperationFinished}),T=new f.b(v,function(e){return e.onPreviewOperationStart}),x=new f.b(v,function(e){return e.openComposeInSxS}),R=new f.b(v,function(e){return e.reloadTextPreview}),_=new f.b(v,function(e){return e.showSxS}),N=new f.b(v,function(e){return e.tryCloseSxS});new f.b(v,function(e){return e.tryExitSxSEditMode})},889:function(e,n,t){"use strict";var r=t(21),a=t(4),i={viewStates:new r.ObservableMap,primaryComposeId:null,complianceConfigurations:new r.ObservableMap,messageClassifications:new r.ObservableMap,newMessageCreationInProgress:!1},o=Object(a.createStore)("compose",i),c=o();t.d(n,"a",function(){return c}),t.d(n,"b",function(){return o})},894:function(e,n,t){"use strict";var r=t(1082),a=t(865),i=t(823),o=t(65);function c(e,n,t,c){if(Object(i.e)(t))return function(e){return 2===Object(i.c)(e)?l():u()}(t);if(3===Object(i.c)(t)&&!c)return s();var d;switch(n){case 2:d={allowEdit:!1,previewMethod:a.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:d={allowEdit:!1,previewMethod:a.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:d={allowEdit:!1,previewMethod:a.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:d={allowEdit:e.wacEdit,previewMethod:a.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:d={allowEdit:!1,previewMethod:a.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:d={allowEdit:!1,previewMethod:a.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:d=l();break;case 11:d={allowEdit:!1,previewMethod:a.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:d={allowEdit:!1,previewMethod:a.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:d={allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[]};break;case 13:d=Object(o.f)("cal-ics-preview")?{allowEdit:!1,previewMethod:a.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]}:u();break;default:d=function(e){return e.__type===i.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||e.__type===i.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(t)?s():u()}return d}function u(){return{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[r.a.Download]}}function s(){return{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function l(){return{allowEdit:!1,previewMethod:a.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var d=t(69),f=(Object(d.action)("setPreviewLoaded")(function(e,n){e.previewLoaded=n}),Object(d.action)("setIsPlaceholderAttachment")(function(e,n){e.isPlaceholderAttachment=n})),b=Object(d.action)("setThumbnailLoadState")(function(e,n){e.thumbnailLoadState=n});function m(e,n,t,r,i,o){return void 0===o&&(o=null),{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:t,isReadOnly:n,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[]},parentItemId:o,fileType:i}}var v=t(40);function p(){return Object(v.a)().SessionSettings.CompanyName}function w(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}t.d(n,"d",function(){return c}),t.d(n,"g",function(){return f}),t.d(n,"h",function(){return b}),t.d(n,"c",function(){return m}),t.d(n,"f",function(){return p}),t.d(n,"e",function(){return w}),t.d(n,"a",function(){return r.a}),t.d(n,"b",function(){return a.a})},948:function(e,n,t){"use strict";var r=t(1197),a=t(821),i=t(0),o=t(814);function c(e){var n,t,r=Object(o.a)();try{for(var c=Object(i.__values)(r.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.type!==a.a.Primary&&s.data==e)return s}}catch(e){n={error:e}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(n)throw n.error}}return null}var u=t(1058),s=t(52),l=t(1157),d=t(1910),f=t(1285),b=t(4);Object(b.mutator)(f.a,function(e){var n,t;try{for(var r=Object(i.__values)(Object(o.a)().tabs),c=r.next();!c.done;c=r.next()){var u=c.value;if(u.type==a.a.FloatingChat&&u.data==e.chatConversationId)return void Object(l.a)(u,!0)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}Object(d.a)(a.a.FloatingChat,!0,!0,e.chatConversationId)});t(864);t.d(n,"e",function(){return v}),t.d(n,"f",function(){return p}),t.d(n,"g",function(){return w}),t.d(n,"h",function(){return O}),t.d(n,"a",function(){return a.a}),t.d(n,"b",function(){return c}),t.d(n,"c",function(){return u.a}),t.d(n,"d",function(){return o.a}),t.d(n,"i",function(){return o.b}),t.d(n,"j",function(){return r.b});var m=new s.c(function(){return Promise.all([t.e(49),t.e(67),t.e(73),t.e(475)]).then(t.bind(null,14356))}),v=new s.a(m,function(e){return e.activateTab}),p=new s.a(m,function(e){return e.addTab}),w=new s.a(m,function(e){return e.closeTab}),O=new s.a(m,function(e){return e.setTabIsShown})},972:function(e,n,t){"use strict";var r=t(1482),a=t(52),i=t(1017),o=t(1217),c=(t(1412),t(1323)),u=t(1191),s=t(889),l=t(948),d=t(62);function f(e,n,t){var r,a=Object(s.b)();if(e){switch(e.type){case l.a.SecondaryReadingPane:e.data.listViewType==t&&(r=Object(u.a)(n,t));break;case l.a.Compose:r=a.viewStates.get(e.data);break;case l.a.Primary:r=n?Object(u.a)(n,t,!0):null;break;default:r=null}return r}return d.d.error("There is no active tab. Something went very wrong."),null}var b=t(1413),m=t(4),v=Object(m.action)("onComposeAddinsInitialized",function(e,n){return{hostItemIndex:e,itemId:n}}),p=t(1485);function w(){var e=Object(l.c)(),n=Object(s.b)(),t=e?function(e,n){switch(e.type){case l.a.Primary:return n.primaryComposeId;case l.a.Compose:return e.data;default:return null}}(e,n):n.primaryComposeId,r=t?n.viewStates.get(t):null;return r&&!r.isInlineCompose?r:null}t.d(n,"u",function(){return y}),t.d(n,"m",function(){return h}),t.d(n,"h",function(){return g}),t.d(n,"k",function(){return j}),t.d(n,"o",function(){return S}),t.d(n,"r",function(){return I}),t.d(n,"y",function(){return C}),t.d(n,"x",function(){return A}),t.d(n,"p",function(){return M}),t.d(n,"s",function(){return P}),t.d(n,"w",function(){return T}),t.d(n,"t",function(){return x}),t.d(n,"q",function(){return R}),t.d(n,"j",function(){return _}),t.d(n,"n",function(){return N}),t.d(n,"l",function(){return E}),t.d(n,"v",function(){return k}),t.d(n,"i",function(){return F}),t.d(n,"d",function(){return i.c}),t.d(n,"a",function(){return i.b}),t.d(n,"g",function(){return o.b}),t.d(n,"f",function(){return c.a}),t.d(n,"c",function(){return u.a}),t.d(n,"b",function(){return f}),t.d(n,"z",function(){return b.a}),t.d(n,"B",function(){return v}),t.d(n,"C",function(){return p.a}),t.d(n,"e",function(){return w}),t.d(n,"A",function(){return r.a});var O=new a.c(function(){return Promise.all([t.e(3),t.e(5),t.e(6),t.e(7),t.e(329)]).then(t.bind(null,13720))}),y=new a.a(O,function(e){return e.replyToMessage}),h=new a.a(O,function(e){return e.forwardMessage}),g=new a.a(O,function(e){return e.closeCompose}),j=new a.a(O,function(e){return e.discardCompose}),S=new a.a(O,function(e){return e.loadDraftToCompose}),I=new a.a(O,function(e){return e.openCompose}),C=new a.a(O,function(e){return e.trySendMessage}),A=new a.a(O,function(e){return e.trySaveAndCloseCompose}),M=new a.a(O,function(e){return e.moveComposeToTab}),P=new a.a(O,function(e){return e.recreateComposeFromViewState}),T=new a.a(O,function(e){return e.tryCreateResendDraft}),x=new a.a(O,function(e){return e.replyToApprovalMessage}),R=new a.a(O,function(e){return e.onEditDraftButtonClicked}),_=new a.b(O,function(e){return e.createReply}),N=new a.b(O,function(e){return e.getToCcRecipientsForReply}),E=new a.b(O,function(e){return e.findComposePlugins}),k=new a.b(O,function(e){return e.replyToMessageAndCreateViewState}),F=new a.b(O,function(e){return e.createAttachments});new a.b(O,function(e){return e.findComposeFromRecipientWell})},993:function(e,n,t){"use strict";t.d(n,"a",function(){return i}),t.d(n,"b",function(){return o}),t.d(n,"c",function(){return c}),t.d(n,"d",function(){return u});var r=t(1090),a=t(131);function i(){return r.a.shouldShow}function o(){return r.a.shouldShow&&r.a.shouldHideReadingPaneOutsideSxS}function c(e){return i()&&Object(a.f)(e,r.a.extendedViewState.attachmentId)}function u(e){return i()&&(e&&e.composeId===r.a.composeId||!e&&r.a.composeId)}}},0,[3,5,8,13,422,1,2,22,577,185,0,578,189,7,379,6,329,4,12,37,127,342,376,541]]);
//# sourceMappingURL=owa.MailMessageActions.js.map
self.scriptsLoaded['owa.MailMessageActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailMessageActions.js'] = (new Date()).getTime();