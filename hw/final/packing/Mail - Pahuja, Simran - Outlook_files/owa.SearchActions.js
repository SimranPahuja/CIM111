self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SearchActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[445],{10588:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"QueryStringType:#Exchange"},e)}},1237:function(e,t,r){"use strict";var n=r(131),a=r(731),o=r(740),c=r(737),i=r(732);function u(e,t){return!Object(a.s)()&&t&&t.type===n.a.UserMailbox&&!Object(o.y)(e)&&e!=Object(c.a)("recoverableitemsdeletions")&&!Object(i.L)(e,i.l)}var s=r(52),l=r(1591);r.d(t,"e",function(){return b}),r.d(t,"a",function(){return l.a}),r.d(t,"b",function(){return l.b}),r.d(t,"c",function(){return u}),r.d(t,"d",function(){return l.c});var d=new s.c(function(){return r.e(494).then(r.bind(null,13938))}),b=new s.a(d,function(e){return e.undo})},1591:function(e,t,r){"use strict";var n,a=r(4),o=Object(a.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),c=r(973),i=r(69),u=r(49);r.d(t,"a",function(){return s}),r.d(t,"b",function(){return l}),r.d(t,"c",function(){return d}),r.d(t,"d",function(){return b});var s=Object(i.action)("addActionToUndoStack")(Object(i.select)({store:function(){return o}})(function(e,t,r){null!==e&&(n=e,r.store.hasUndoableAction=!0,r.store.undoableActionFolderId=t)})),l=Object(i.action)("clearLastUndoableAction")(Object(i.select)({store:function(){return o}})(function(e){n=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null})),d=Object(i.select)({store:function(){return o}})(function(e){return e.store.hasUndoableAction}),b=Object(u.c)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})(function(e){o.undoableActionFolderId?c.a.clearMapForFolder(o.undoableActionFolderId):c.a.removeAll();null!==n&&(n(),l())})},1641:function(e,t,r){"use strict";var n=r(4),a=Object(n.action)("LOAD_FAVORITES");t.a=a},2046:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(4),a=Object(n.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",function(e,t){return{jsEndToEndTime:e,jsRenderingTime:t}})},2100:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return o});var n="undefined"!=typeof window&&window.hasOwnProperty("Performance")&&Performance.prototype.getEntriesByName;function a(e){var t,r,a,o;t=e+" - start",n&&(null===(o=null===(r=performance)||void 0===r?void 0:(a=r).mark)||void 0===o||o.call(a,t))}function o(e){var t,r,a,o,c,i;if(n){try{null===(a=null===(t=performance)||void 0===t?void 0:(r=t).measure)||void 0===a||a.call(r,e,e+" - start")}catch(e){return}var u=performance&&performance.getEntriesByName(e);return null===(i=null===(o=performance)||void 0===o?void 0:(c=o).clearMarks)||void 0===i||i.call(c,e+" - start"),u&&u.length>0?u.slice(-1)[0]:void 0}}},2370:function(e,t,r){"use strict";r(151),r(2100);var n=r(2046),a=r(52),o=new a.c(function(){return Promise.all([r.e(9),r.e(11),r.e(30),r.e(39),r.e(447)]).then(r.bind(null,14390))}),c=new a.b(o,function(e){return e.addSearchRequestInstrumentation}),i=new a.b(o,function(e){return e.addResourceTimingEntry}),u=new a.b(o,function(e){return e.searchDiagnostics}),s=function(){var e=u.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};r.d(t,"a",function(){return n.a}),r.d(t,"b",function(){return s}),r.d(t,"d",function(){return c}),r.d(t,"c",function(){return i})},4234:function(e,t,r){"use strict";r.r(t);var n=r(748),a=r(1235),o=r(69),c=Object(o.select)({tableViews:function(){return n.a.tableViews}})(Object(o.action)("cleanSearchTableState")(function(e,t,r){var n=e.id;t&&t.addCheckmark("cleanSearchTable_s"),a.a.clear(e,null),r.tableViews.delete(n),t&&t.addCheckmark("cleanSearchTable_e")})),i=r(0),u=r(1237),s=r(7),l=r(1032),d=r(64),b=r(319),h=r(731),f=r(1040),m=r(1022),S=r(6542),g=r(151),O=r(2370),p=r(754),j=r(776),v=r(65);function y(e){switch(e.tableQuery.listViewType){case 0:return"MailConversations";case 1:return"MailItems";default:return null}}var w=Object(o.action)("onExecuteSearchCompleted")(function(e,t,r,n,a,o,c,u,s){return Object(i.__awaiter)(this,void 0,void 0,function(){var d,h,m,g,O,y,w,I;return Object(i.__generator)(this,function(i){switch(i.label){case 0:switch(a){case"MailConversations":d=r.Conversations,h="Conversation";break;case"MailItems":d=r.Items,h="Message"}if(Object(f.a)("sea-qf")&&!Object(f.a)("sea-3SQuery")&&p.D.importAndExecute(s,u,e.resultRowOffset,e.resultRowCount,null==d?0:d.length,!0,h,new Date,p.a.Mail),!d)return[2];for(m=0,g=d.length;m<g;m++)(O=d[m]).ReferenceKey=O.InstanceKey,O.InstanceKey=Object(b.a)();return r.SearchTerms&&!t.highlightTerms&&Object(S.a)(t.tableQuery).shouldHighlight&&(t.highlightTerms=Object(j.o)(r)),Object(l.c)(t,d,(_={pageNumber:e.pageNumber,resultsCount:d.length,rowsInTableCount:t.rowKeys.length},R=_.pageNumber,C=_.resultsCount,E=_.rowsInTableCount+C,R===(Object(v.f)("sea-fetchOnScroll1")||Object(v.f)("sea-fetchOnScroll2")?7:3)?E:C===Object(p.q)(R).resultRowCount?E+1:E),s),Object(v.f)("sea-fetchOnScroll1")||Object(v.f)("sea-fetchOnScroll2")?t.currentLoadedIndex=t.rowKeys.length:0==e.pageNumber&&(t.currentLoadedIndex=t.rowKeys.length),0==e.pageNumber&&(t.tableQuery.lastIndexFetched=t.rowKeys.length-1),y=t.tableQuery.searchScope,w=y?y.kind:null,(I=Object(p.p)(e,r,w))?[4,T(I,t,null,null,a,o,u,c,n)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}var _,R,C,E})})}),T=Object(o.action)("performExecuteSearch")(function(e,t,r,n,a,o,c,u,l){return void 0===l&&(l=0),Object(i.__awaiter)(this,void 0,void 0,function(){var b,S,y,T,I,_,R,C=this;return Object(i.__generator)(this,function(E){switch(b=Object(m.i)(),S=t.tableQuery,y="ExecuteSearch",T=Object(m.h)()){case 0:y="SubstrateSearch";break;case 1:default:y="ExecuteSearch"}return I=Object(v.f)("sea-hybridSearchSupported")||1!==T?null:"DateTime",_=Object(j.K)(j.g.Mail)||"persona"===S.scenarioType,Object(f.a)("sea-answers-calendar")&&0===e.pageNumber&&(R=new Date,m.n.import().then(function(e){e(o,S.queryString,c,p.a.Mail).then(function(e){return Object(i.__awaiter)(C,void 0,void 0,function(){var t,r,n,a;return Object(i.__generator)(this,function(o){switch(o.label){case 0:return a=Object(i.__read)(e,2),t=a[0],r=a[1],t?[4,t.json()]:[3,2];case 1:n=o.sent(),m.o.importAndExecute(n),o.label=2;case 2:return O.d.import().then(function(e){e(Object(p.d)(t,S.queryString,"","SubstrateSearch",R,new Date,c,new Headers(r),-1,p.a.Mail))}),[2]}})})})})),[2,Object(p.l)(e,S.queryString,o,c,S.searchScope,b.searchNumber,a,n,u,y,p.a.Mail,l,S.includeAttachments,Object(s.m)(S.fromDate),Object(s.m)(S.toDate),null,null,I,_).then(function(s){return Object(i.__awaiter)(C,void 0,void 0,function(){var m,S,v,y,T,I,_,R,C;return Object(i.__generator)(this,function(i){if(!s)return[2];if(m=s[1],O.d.import().then(function(e){return e(m)}),(S=g.g.importAndExecute(s[2])).then(function(e){setTimeout(function(){O.c.import().then(function(t){return t(e,m,n)})},0)}),!Object(h.s)()||t.tableQuery.searchNumber!=b.searchNumber)return[2];if(v=m.ClientHttpStatus,y=200==v&&null!=s[0].SearchResults,T=0==e.pageNumber,Object(f.a)("sea-qf")&&(S.then(function(e){var t=e?e.RpE:m.ClientNetworkTime;p.I.importAndExecute(m.SearchTraceID,t,m.ClientHttpStatus,new Date),y?p.J.importAndExecute(m.SearchTraceID,new Date,p.a.Mail):p.H.importAndExecute(m.SearchTraceID,p.a.Mail)}),Object(j.S)(m.SearchTraceID,j.g.Mail,!1)),T&&(I=new g.a("TnS_SearchClientTime")).addCustomData([y,a]),y&&(_=s[0],(R=_.querySuggestionData)&&T&&(C=R.flaggedTokens&&R.flaggedTokens.map(function(e){return{Length:e.Length,Offset:e.Offset||0,Suggestion:e.Suggestion}}),j.H.importAndExecute(R.alteredQuery,R.suggestedSearchTerm,R.suggestedSearchTermReferenceId,C,R.recourseQuery,j.g.Mail,R.queryAlterationType)),w(e,t,_.SearchResults,l,a,o,u,c,m.SearchTraceID)),T){if(!r)throw new Error("onInitialTableLoadComplete callback should always be set when page number is 0");n&&y&&n.addCustomData({resultCount:s[0].SearchResults.SearchResultsCount}),r(t,y,v.toString(),!1),function(e,t,r){t.ClientResponseProcessTime=e.addCheckmark("ProcessResponseTime"),t.ClientJSEndToEndTime=r.addCheckmark("ClientJSEndToEndTime"),requestAnimationFrame(function(){return Promise.resolve().then(function(){e.end(),t.ClientJSRenderingTime=r.getData(d.b.e2eTimeElapsed)-r.waterfallTimings.ClientJSEndToEndTime})})}(I,m,n)}return y||n.endWithError("ServerError",Error(s[1].SearchErrorContent)),[2]})})})]})})});function I(e,t,r,n,a,o,c){u.b();var i=y(e);return i?T(Object(p.q)(0),e,t,r,i,n,a,c,o):Promise.resolve()}function _(e,t,r,n,a){return void 0===a&&(a=0),Object(i.__awaiter)(this,void 0,void 0,function(){var o;return Object(i.__generator)(this,function(c){return(o=Object(j.p)(j.g.Mail)).currentSearchQueryId=o.nextSearchQueryId,o.nextSearchQueryId=Object(b.a)(),Object(j.l)(j.g.Mail),[2,I(e,t,r,o.searchSessionGuid,o.currentSearchQueryId,a,n)]})})}function R(e,t,r,n,a){return void 0===a&&(a=0),Object(i.__awaiter)(this,void 0,void 0,function(){var o,c;return Object(i.__generator)(this,function(i){return o=Object(m.i)(),c=e.tableQuery,o.searchNumber++,c.searchNumber=o.searchNumber,o.staticSearchScope=c.searchScope,[2,I(e,t,r,Object(b.a)(),Object(b.a)(),a,n)]})})}var C=r(737),E=r(40),D=r(771),M=r(861),F=r(864);function A(e){return Object(F.r)()?5:3}var N=r(4),L=Object(N.action)("FIND_ITEM_SEARCH",function(e,t,r,n,a){return{offset:e,tableView:t,actionSource:r,onLoadInitialRowsSucceeded:n,onInitialTableLoadComplete:a}}),k=Object(N.action)("SET_HIGHLIGHT_TERMS",function(e){return{highlightTerms:e}}),x=Object(o.select)({folderForestStore:function(){return M.a},userConfig:E.a})(Object(o.action)("loadSearchTable")(function(e,t,r,n,a,o){return Object(i.__awaiter)(this,void 0,void 0,function(){var c,u,s,l,d,b,h,f;return Object(i.__generator)(this,function(S){if(1!=e.tableQuery.type)throw new Error("loadSearchTable should only be called for search table types");return c=o.folderForestStore.selectedNode,(u=Object(m.i)()).previousNode||(3==c.type?(s=Object(C.a)("inbox"),l=Object(D.isFolderInFavorites)(s)?"favorites":"primaryFolderTree",u.previousNode={id:s,treeType:l,type:0}):u.previousNode=Object(i.__assign)({},c)),d=e.tableQuery,b=d.scenarioType,h="persona"===b||"category"===b||"privateDistributionList"===b,3==c.type||h||(o.folderForestStore.selectedNode.id=null),f=o.userConfig.SessionSettings.IsExplicitLogon,"messageSuggestion"===b?(t(e,!0,"",!0),[2,Promise.resolve()]):"SharedFolders"===d.searchScope.kind||"ArchiveMailbox"===d.searchScope.kind&&f||"PublicFolder"===d.searchScope.kind?(L(0,e,n,r,t),[2,Promise.resolve()]):h?[2,R(e,t,a,n,A(o.userConfig))]:[2,_(e,t,a,n,A(o.userConfig))]})})})),Q=Object(N.action)("LOAD_MORE_FIND_ITEM_SEARCH",function(e,t,r,n,a){return{offset:e,tableView:t,actionSource:r,onLoadMoreRowsSucceeded:n,onLoadMoreRowsFailed:a}}),H=Object(N.action)("loadMoreSubstrateSearch",function(e,t,r,n,a){return{offset:e,tableView:t,actionSource:r,onLoadMoreRowsSucceeded:n,onLoadMoreRowsFailed:a}}),q=r(1300),P=r.n(q),V=r(1301),B=r.n(V),U=r(191),G=r(842),K=r.n(G),J=r(10588),W=r.n(J),z=r(747),$=r.n(z);function X(e,t,r,n,a,o,c,i,u){var s=function(e,t,r,n,a,o,c,i){return P()({ParentFolderIds:[$()({Id:e})],ItemShape:K()({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:c,Paging:r,FocusedViewFilter:o,ViewFilter:n,SortOrder:a,IsWarmUpSearch:!1,QueryString:W()(t),RefinerRestriction:i,SearchFolderIdentity:Object(b.a)()})}(e,t,r,n,a,o,i,u);return B()({Header:Object(U.getJsonRequestHeader)(),Body:s},c).then(function(e){return e.Body.ResponseMessages.Items[0]})}var Y=r(62),Z=r(869),ee=r(825),te=r.n(ee),re=r(743),ne=r.n(re),ae=r(1542),oe=r.n(ae),ce=50;function ie(e,t){var r,n=e.tableQuery,a=e.tableQuery,o={Value:a.queryString,MaxResultsCount:ce,ResetCache:!0,ReturnDeletedItems:!0,ReturnHighlightTerms:!0,WaitForSearchComplete:!0},c=te()({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:ce}),i=null===(r=Object(Z.c)(n))||void 0===r?void 0:r.requestOptions,u=[];return u.push(oe()({Order:"Descending",Path:ne()({FieldURI:"DateTimeReceived"})})),{queryStringData:o,paging:c,requestInit:i,sortByResults:u,folderId:a.searchScope.folderId,refinerRestriction:Object(p.s)(Object(s.m)(a.fromDate),Object(s.m)(a.toDate),null,null)}}Object(N.orchestrator)(L,function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,r,n,a,o,c,u,s,l,d,b,f,g,O;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.tableView,r=e.onInitialTableLoadComplete,n=e.onLoadInitialRowsSucceeded,a=e.offset,o=ie(t,a),c=o.queryStringData,u=o.paging,s=o.requestInit,l=o.sortByResults,d=o.folderId,b=o.refinerRestriction,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,X(d,c,u,"All",l,-1,s,"Shallow",b)];case 2:return f=i.sent(),[3,4];case 3:return g=i.sent(),Y.d.error("Find item search call failed "+g),[2,Promise.resolve(null)];case 4:return f&&(Object(h.s)()&&t.tableQuery.searchNumber===m.v.searchNumber)?((O="Success"===f.ResponseClass)&&(n(t,f.RootFolder.Items,f.RootFolder.TotalItemsInView,f.SearchFolderId,null),f.HighlightTerms&&!t.highlightTerms&&Object(S.a)(t.tableQuery).shouldHighlight&&k(f.HighlightTerms.map(function(e){return e.Value}))),r(t,O,f.ResponseCode,!1),[2]):[2]}})})}),Object(N.orchestrator)(Q,function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,r,n,a,o,c,u,s,d,b,f,S,g;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.tableView,r=e.onLoadMoreRowsSucceeded,n=e.onLoadMoreRowsFailed,a=e.offset,o=ie(t,a),c=o.queryStringData,u=o.paging,s=o.requestInit,d=o.sortByResults,b=o.folderId,f=o.refinerRestriction,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,X(b,c,u,"All",d,-1,s,"Shallow",f)];case 2:return S=i.sent(),[3,4];case 3:return g=i.sent(),Y.d.error("Load more Find item search call failed "+g),[2,Promise.resolve(null)];case 4:return S&&(Object(h.s)()&&t.tableQuery.searchNumber===m.v.searchNumber)?("Success"===S.ResponseClass?r(t,S.RootFolder.Items,S.RootFolder.TotalItemsInView,l.b):n(t,S.ResponseCode),[2]):[2]}})})}),Object(N.orchestrator)(H,function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,r,n,a,o,c,u;return Object(i.__generator)(this,function(i){return t=e.offset,r=e.tableView,n=e.actionSource,a=Object(j.p)(j.g.Mail),o=a.searchSessionGuid,c=a.currentSearchQueryId,(u=Object(p.r)(t))?(T(u,r,null,null,y(r),o,c,n,3),[2]):[2]})})});Object(N.mutator)(k,function(e){var t=Object(h.B)();t&&(t.highlightTerms=e.highlightTerms)}),r.d(t,"cleanSearchTableState",function(){return c}),r.d(t,"executeSearch",function(){return _}),r.d(t,"loadSearchTable",function(){return x}),r.d(t,"loadMoreFindItemSearch",function(){return Q}),r.d(t,"loadMoreSubstrateSearch",function(){return H})},6542:function(e,t,r){"use strict";var n=r(160);function a(e){switch(e.type){case 1:return function(e){switch(e.scenarioType){case"mail":case"messageSuggestion":return{shouldHighlight:!0,headerGeneratorType:"RelevanceHybrid"};case"persona":case"privateDistributionList":case"category":return{shouldHighlight:!1,headerGeneratorType:"DateTime"};default:return Object(n.a)(e.scenarioType)}}(e);case 0:case 2:return function(e){var t;switch(0==e.type&&e.sortBy.sortColumn){case 3:t="Sender";break;case 7:t="Size";break;case 5:t="Importance";break;case 8:t="Subject";break;case 1:default:t="DateTime"}return{shouldHighlight:!0,headerGeneratorType:t}}(e);default:return Object(n.a)(e.type)}}r.d(t,"a",function(){return a})}},0,[1,2,22,577,185,0,578,189,7,379,3,8,13,16,361,10,626,444,5,6,355,79,4,12,131,9,11,30,39,447,37,127,238,342,376,541]]);
//# sourceMappingURL=owa.SearchActions.js.map
self.scriptsLoaded['owa.SearchActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SearchActions.js'] = (new Date()).getTime();