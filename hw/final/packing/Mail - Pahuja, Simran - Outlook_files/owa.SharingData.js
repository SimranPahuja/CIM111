self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SharingData.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[455],{1153:function(e,n,i){"use strict";var t;i.d(n,"a",function(){return t}),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(t||(t={})),n.b=t},11830:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=i(0);n.default=function(e){return t.__assign({__type:"GetSharingInfoResponse:#Exchange"},e)}},11831:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=i(129),r=i(8838);n.default=function(e,n){return void 0===e||e.__type||(e=r.default(e)),t.makeServiceRequest("GetSharingInformation",e,n)}},11832:function(e){e.exports={b:"Jga",a:"Kga"}},11833:function(e){e.exports={h:"uga",i:"vga",j:"wga",d:"xga",k:"yga",e:"zga",g:"Aga",n:"Bga",o:"Cga",f:"Dga",l:"Ega",m:"Fga",a:"Gga",c:"Hga",b:"Iga"}},3290:function(e,n,i){"use strict";i.r(n);var t,r,a=i(0),s=i(160),o=i(65),c=i(121),u=i(8838),l=i.n(u),f=i(11830),g=i.n(f),d=i(11831),h=i.n(d),m=i(62);!function(e){e.OneDrivePro="OneDrivePro"}(t||(t={})),function(e){e.None="None",e.View="View",e.Edit="Edit",e.AnonymousView="AnonymousView",e.AnonymousEdit="AnonymousEdit",e.OrganizationView="OrganizationView",e.OrganizationEdit="OrganizationEdit"}(r||(r={}));var p=i(112),b="ows/api/beta/sharinglink/info";function O(e,n){return void 0===n&&(n=!1),Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(i){switch(i.label){case 0:return[4,Object(p.d)(b,{url:e},void 0,n)];case 1:return[2,i.sent()]}})})}var S=i(5075);function v(e,n){switch(n){case 1:return function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(i){switch(i.label){case 0:return[4,Object(S.h)(e,1)];case 1:return n=i.sent(),m.d.info(n),[2,null]}})})}(e);case 0:return Object(o.f)("doc-attachment-sharingLinkInfoOWSPrimeService")?function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,s,o,u,l,f,d,h,p,b,S;return Object(a.__generator)(this,function(v){switch(v.label){case 0:return[4,O(e,!0)];case 1:return n=v.sent(),Object(c.a)(n.status)?(o=(s=JSON).parse,[4,n.text()]):[3,3];case 2:if(function(e){return e.providerType===t.OneDrivePro}(i=o.apply(s,[v.sent()])))return u=Object(a.__read)(i.sharingLinks.filter(function(e){return e.type===r.AnonymousEdit}),1),l=u[0],f=Object(a.__read)(i.sharingLinks.filter(function(e){return e.type===r.AnonymousView}),1),d=f[0],h=Object(a.__read)(i.sharingLinks.filter(function(e){return e.type===r.OrganizationEdit}),1),p=h[0],b=Object(a.__read)(i.sharingLinks.filter(function(e){return e.type===r.OrganizationView}),1),S=b[0],[2,g()({AccessRequestMode:i.accessRequestMode,AnonymousEditLink:l?l.url:void 0,AnonymousViewLink:d?d.url:void 0,CanCreateAnonymousEditLink:i.canCreateAnonymousEditLink,CanCreateAnonymousViewLink:i.canCreateAnonymousViewLink,CanCreateOrganizationEditLink:i.canCreateOrganizationEditLink,CanCreateOrganizationViewLink:i.canCreateOrganizationViewLink,CanShareExternally:i.canShareExternally,CanShareInternally:i.canShareInternally,CanonicalUrl:i.canonicalUrl,ExpirationDate:i.expirationTime,FileName:i.name,IsAnonymousEditLinkAvailable:!!l,IsAnonymousViewLinkAvailable:!!d,IsOrganizationEditLinkAvailable:!!p,IsOrganizationViewLinkAvailable:!!S,MimeType:void 0,OrganizationEditLink:p?p.url:void 0,OrganizationViewLink:S?S.url:void 0,ResultCode:0,SharingLinkKind:j(i.linkType)})];throw new Error("Invalid response from OWS` from sharing link info");case 3:return 404===n.status?[2,g()({ResultCode:4})]:400===n.status?[2,g()({ResultCode:24})]:(m.d.warn("Invalid response for OWS' get share info. Status code: "+n.status),[2,g()({ResultCode:1})]);case 4:return[2]}})})}(e):h()(function(e){return l()({attachmentUrl:e})}(e));default:throw new Error("getSharingInformation do not support "+n)}}function j(e){switch(e){case r.None:return 0;case r.View:case r.Edit:return 1;case r.AnonymousView:return 4;case r.AnonymousEdit:return 5;case r.OrganizationView:return 2;case r.OrganizationEdit:return 3;default:return Object(s.a)(e)}}var L=i(5),I=i(11832),x=i(1201);var y=i(5584),E=i(4595),P=i(1648);function k(e,n,i){if(1!==e.length||null===i)return null;switch(n){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.externalRecipientCSL:case x.a.sharingWithLargeDL:return e[0].supportsDownsell?[i(e[0].id)]:null;case x.a.getSharingInfoFailed:case x.a.noPermissionSet:return null;case x.a.linkHasExpired:case x.a.linkWillExpire:return function(e){return[{text:Object(L.a)(E.a),action:function(){Object(P.a)(e.id)}},{text:Object(L.a)(y.a),action:function(){e.sharingTipsIgnored.push(x.a.linkHasExpired),e.sharingTipsIgnored.push(x.a.linkWillExpire)}}]}(e[0]);default:return Object(s.a)(n)}}var w=i(827);function F(e,n){return n.filter(function(e){return e.externalMemberCount>0}).length>0&&e.sharingInfo&&!e.sharingInfo.canShareExternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var A=i(1259);function C(e){return e.some(function(e){return e.totalMemberCount>A.g})}function T(e,n){return C(n)&&e.sharingInfo&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}function R(e){return e.sharingInfo&&!e.sharingInfo.getSharingInfoSucceeded}function _(e,n){return n.filter(function(e){return e.externalMemberCount>0}).length>0&&(6===e.currentPermissionLevel||5===e.currentPermissionLevel)}var D=i(7);function M(e){var n;return(null===(n=e)||void 0===n?void 0:n.sharingInfo)&&!!e.sharingInfo.expirationDate&&Object(D.Fb)(e.sharingInfo.expirationDate,Object(D.Ob)())}function W(e){var n;return(null===(n=e)||void 0===n?void 0:n.sharingInfo)&&!!e.sharingInfo.expirationDate&&Object(D.Db)(e.sharingInfo.expirationDate,Object(D.Ob)())}var V=i(1590);function z(e){return e.recipientPermissionInfos.some(function(e){return e.getPermissionInfoStatus===V.a.Failed})}var G=i(1153);function H(e){switch(e){case A.m:case A.l:case A.c:case A.o:return!0;default:return!1}}function N(e){return e.filter(function(e){return e.totalMemberCount<=A.g&&H(e.recipient.persona.EmailAddress.MailboxType)})}function U(e){return N(e).some(function(e){return e.recipient.expansionStatus===G.b.Failed||e.recipient.expansionStatus===G.b.SucceededWithDLOrGroupMembers})}function q(e,n){return B(e.sharingRecipientsInfo,n)?0===e.currentPermissionLevel&&e.sharingInfo&&e.sharingInfo.getSharingInfoSucceeded:0===e.currentPermissionLevel&&e.sharingRecipientsInfo.recipientPermissionInfos.some(function(e){return!e.hasAccess&&e.getPermissionInfoStatus===V.a.Succeeded})||(1===e.currentPermissionLevel||2===e.currentPermissionLevel)&&function(e){return e.recipientPermissionInfos.some(function(e){return!e.hasAccess&&!e.canHaveAccess&&e.getPermissionInfoStatus===V.a.Succeeded})}(e.sharingRecipientsInfo)}function B(e,n){return!Object(o.f)("doc-attachment-contextualSharingTips")||C(n)||U(n)||z(e)}function J(e){var n;return(null===(n=e.sharingInfo)||void 0===n?void 0:n.getSharingInfoSucceeded)&&!e.sharingInfo.canShareInternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var K=i(1647);var Y=i(151),$=i(11833);var Q=function(e){return e?e.filter(function(e){return e.totalMemberCount>100}).map(function(e){return e.recipient.persona.EmailAddress.Name}).join(", "):""};function X(e,n,i){if(B(e,n))return Object(L.a)($.o);var t=e.recipientPermissionInfos,r=null,a=!1;if(0===i?(r=t.filter(function(e){return!e.hasAccess&&e.getPermissionInfoStatus===V.a.Succeeded}),Object(Y.m)("RecipientCanNotAccess",{numOfRecipients:r.length})):1!==i&&2!==i||(a=!0,r=t.filter(function(e){return!e.hasAccess&&!e.canHaveAccess&&e.getPermissionInfoStatus===V.a.Succeeded}),Object(Y.m)("RecipientCanNotHaveAccess",{numOfRecipients:r.length})),null!==r){var s=r.length,o=function(e){return e.map(function(e){return e.name?e.name:e.emailAddress}).join(", ")}(r.slice(0,3));return 1===s?Object(L.b)(Object(L.a)(a?$.c:$.l),o,"{0}"):s<4?Object(L.b)(Object(L.a)(a?$.c:$.m),o,"{0}"):Object(L.b)(Object(L.a)(a?$.b:$.a),o,"{0}")}return Object(L.a)($.o)}function Z(e,n,i,t,r){if(!function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.externalRecipientCSL:case x.a.noPermissionSet:case x.a.sharingWithLargeDL:return!0;case x.a.getSharingInfoFailed:return Object(o.f)("doc-attachment-sharingInfoFailureTip");case x.a.linkWillExpire:case x.a.linkHasExpired:return Object(o.f)("doc-attachment-contextualSharingTips");default:return Object(s.a)(e)}}(n))return null;var a=function(e){switch(e){case x.a.noPermissionToShare:return J;case x.a.getSharingInfoFailed:return R;case x.a.linkHasExpired:return M;case x.a.linkWillExpire:return W;case x.a.externalRecipientCSL:return _;case x.a.noPermissionToShareExternally:return F;case x.a.noPermissionSet:return q;case x.a.sharingWithLargeDL:return T;default:return Object(s.a)(e)}}(n),c=e.filter(function(e){return a(e,i)});if(0===c.length)return null;var u=c.filter(function(e){return!Object(L.g)(e.name)}).map(function(e){return e.name}).join(", "),l=function(e,n,i){switch(e){case x.a.noPermissionToShare:return{singleFile:Object(L.a)($.h),multipleFiles:Object(L.a)($.h)};case x.a.getSharingInfoFailed:return{singleFile:Object(L.a)($.i),multipleFiles:Object(L.a)($.i)};case x.a.linkHasExpired:return{singleFile:Object(L.a)($.j),multipleFiles:Object(L.a)($.d)};case x.a.linkWillExpire:return{singleFile:Object(L.a)($.k),multipleFiles:Object(L.a)($.e)};case x.a.noPermissionToShareExternally:return{singleFile:Object(L.a)($.g),multipleFiles:Object(L.a)($.g)};case x.a.externalRecipientCSL:return{singleFile:Object(L.a)($.n),multipleFiles:Object(L.a)($.n)};case x.a.noPermissionSet:return{singleFile:X(i[0].sharingRecipientsInfo,n,i[0].currentPermissionLevel),multipleFiles:Object(L.a)($.o)};case x.a.sharingWithLargeDL:var t=Q(n);return{singleFile:Object(L.b)(Object(L.a)($.f),t,"{0}","{1}"),multipleFiles:Object(L.b)(Object(L.a)($.f),t,"{0}","{1}")};default:return Object(s.a)(e)}}(n,i,c),f=c.length>1?l.multipleFiles:l.singleFile;u&&0!==u.length||!f||0===f.length||m.d.error("file names should not be null or empty if the infobarStringTemplate is not");var g,d=k(c,n,r),h=function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:return[K.a.ignore,K.a.attachAsACopy];case x.a.getSharingInfoFailed:return[K.a.ignore];case x.a.externalRecipientCSL:case x.a.noPermissionSet:case x.a.sharingWithLargeDL:return[K.a.ignore,K.a.changePermission,K.a.attachAsACopy];case x.a.linkWillExpire:case x.a.linkHasExpired:return[K.a.ignore,K.a.refreshExpiration];default:return Object(s.a)(e)}}(n);if(t||null!==d&&0!==d.length)g=Object(L.b)(f,u);else{var p="",b=function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.externalRecipientCSL:return{singleFile:Object(L.a)(I.b),multipleFiles:Object(L.a)(I.a)};case x.a.getSharingInfoFailed:case x.a.linkHasExpired:case x.a.linkWillExpire:case x.a.noPermissionSet:case x.a.sharingWithLargeDL:return null;default:return Object(s.a)(e)}}(n);null!==b&&(p=c.length>1?b.multipleFiles:b.singleFile),g=Object(L.b)(f,u,p)}return{id:n,sharingTipString:g,actions:d,sharingTipActions:h,messageRank:function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.sharingWithLargeDL:case x.a.linkHasExpired:case x.a.externalRecipientCSL:case x.a.noPermissionSet:return w.b.Error;case x.a.linkWillExpire:case x.a.getSharingInfoFailed:return w.b.Info;default:return Object(s.a)(e)}}(n)}}function ee(e,n,i,t,r){var a=Z(e,n,i,t,r);if(null===a)return null;var s={key:n,source:w.c.Compose,rank:a.messageRank,message:a.sharingTipString,messageParts:[a.sharingTipString]};return null!==a.actions&&a.actions.map(function(e){s.messageParts.push(e)}),function(e){return s}}var ne=new Map;function ie(e,n){var i=[];ne.has(e)&&(i=ne.get(e)),te(i,[],e,n,"deleteLink")}function te(e,n,i,t,r){void 0===r&&(r=null);var a=r||"UnknownActionSource",s=n.filter(function(n){return-1===e.indexOf(n)}),o=e.filter(function(e){return-1===n.indexOf(e)});s.length>0&&(s.unshift(t),s.unshift(a),Object(Y.m)("LinkSharingTipsAdded",s,{cosmosOnlyData:i})),o.length>0&&(o.unshift(t),o.unshift(a),Object(Y.m)("LinkSharingTipsRemoved",o,{cosmosOnlyData:i}))}function re(e,n){var i,t,r,a,s=Object(x.b)().filter(function(n){return-1===e.sharingTipsIgnored.indexOf(n)}).map(function(i){return Z([e],i,n,!0)}).filter(function(e){return null!==e});if("string"==typeof e.id){var o=s.map(function(e){return e.id});i=e.id,t=o,r=e.typeOfLink,a=[],ne.has(i)&&(a=ne.get(i)),te(a,t,i,r),ne.set(i,t)}return s}function ae(e){switch(e){case A.f:case A.b:case A.i:case A.j:case A.a:case A.d:case A.h:return!0;default:return H(e)||function(e){switch(e){case A.n:case A.k:case A.p:return!0;default:return!1}}(e)||m.d.error("UnknownMailboxType: "+e),!1}}function se(e){return e.filter(function(e){return e.totalMemberCount===A.e&&ae(e.recipient.persona.EmailAddress.MailboxType)})}i.d(n,"getSharingInformation",function(){return v}),i.d(n,"getInfoBarCreator",function(){return ee}),i.d(n,"getSharingIssuesForSharingData",function(){return re}),i.d(n,"hasGetRecipientPermissionFailed",function(){return z}),i.d(n,"hasLargeDLRecipient",function(){return C}),i.d(n,"hasRecipientExpansionFailure",function(){return U}),i.d(n,"getGroupsAndSmallDLs",function(){return N}),i.d(n,"getInvididualRecipients",function(){return se}),i.d(n,"logSharingTipChangesForLinkRemoval",function(){return ie})},4595:function(e){e.exports={a:"Sga"}},5584:function(e){e.exports={a:"Rga"}},827:function(e,n,i){"use strict";var t,r,a;i.d(n,"c",function(){return t}),i.d(n,"b",function(){return r}),i.d(n,"a",function(){return a}),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(t||(t={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage"}(r||(r={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(a||(a={}))},8838:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=i(0);n.default=function(e){return t.__assign({__type:"GetSharingInfoRequest:#Exchange"},e)}}},0,[565,110]]);
//# sourceMappingURL=owa.SharingData.js.map
self.scriptsLoaded['owa.SharingData.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SharingData.js'] = (new Date()).getTime();