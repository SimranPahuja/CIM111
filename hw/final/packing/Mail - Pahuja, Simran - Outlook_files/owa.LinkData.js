self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.LinkData.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[319],{11826:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(129),i=t(8837);n.default=function(e,n){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("CreateAttachmentSharingLink",e,n)}},1201:function(e,n,t){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}t.d(n,"a",function(){return r}),t.d(n,"b",function(){return i}),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1259:function(e,n,t){"use strict";t.d(n,"g",function(){return r}),t.d(n,"e",function(){return i}),t.d(n,"m",function(){return a}),t.d(n,"l",function(){return o}),t.d(n,"c",function(){return c}),t.d(n,"o",function(){return u}),t.d(n,"f",function(){return s}),t.d(n,"b",function(){return l}),t.d(n,"i",function(){return f}),t.d(n,"j",function(){return d}),t.d(n,"a",function(){return p}),t.d(n,"d",function(){return h}),t.d(n,"n",function(){return m}),t.d(n,"k",function(){return b}),t.d(n,"p",function(){return v}),t.d(n,"h",function(){return O});var r=100,i=1,a="PublicDL",o="PrivateDL",c="GroupMailbox",u="RecommendedGroup",s="InternalMailbox",l="ExternalMailbox",f="Mailbox",d="OneOff",p="Contact",h="ImplicitContact",m="PublicFolder",b="Other",v="Room",O="LinkedIn"},14071:function(e,n,t){"use strict";t.r(n);var r=t(922),i=t(4),a=Object(i.action)("ADD_RECIPIENTS_INTO_LINK",function(e,n){return{linkId:e,recipients:n}}),o=Object(i.action)("UPDATE_RECIPIENT_PERMISSION_INFO",function(e,n){return{linkId:e,results:n}}),c=Object(i.action)("REMOVE_RECIPIENTS_FROM_LINK",function(e,n){return{linkId:e,recipients:n}}),u=Object(i.action)("SET_GET_PERMISSION_INFO_FAILURE",function(e,n){return{linkId:e,recipients:n}}),s=Object(i.action)("RESET_SHARING_RECIPIENTS_INFO",function(e){return{linkId:e}}),l=Object(i.action)("SET_ACTION_STATUS",function(e,n){return{linkId:e,linkActionStatus:n}}),f=Object(i.action)("IGNORE_SHARING_TIP",function(e,n){return{linkId:e,sharingTipId:n}}),d=t(1026);Object(i.mutator)(r.c,function(e){var n=Object(d.a)(e.linkId);n&&(n.linkActionStatus=e.actionStatus)}),Object(i.mutator)(l,function(e){var n=Object(d.a)(e.linkId);n&&(n.linkActionStatus=e.linkActionStatus)}),Object(i.mutator)(r.e,function(e){Object(d.a)(e.linkId).sharingInfo.blocksDownload=e.sharingDialogResponse.blocksDownload});var p=t(7);Object(i.mutator)(r.e,function(e){var n=Object(d.a)(e.linkId);n&&(n.sharingInfo.expirationDate=e.sharingDialogResponse.expirationDate)}),Object(i.mutator)(r.g,function(e){var n=Object(d.a)(e.linkId);n&&(n.sharingInfo.expirationDate=e.expirationDate?Object(p.jc)(e.expirationDate):null)}),Object(i.mutator)(r.e,function(e){Object(d.a)(e.linkId).sharingInfo.linkType=e.sharingDialogResponse.isEdit?"edit":"view"}),Object(i.mutator)(r.e,function(e){Object(d.a)(e.linkId).url=e.sharingDialogResponse.url}),Object(i.mutator)(r.g,function(e){Object(d.a)(e.linkId).url=e.newLinkUrl}),Object(i.mutator)(r.e,function(e){Object(d.a)(e.linkId).permissionLevel=e.sharingDialogResponse.permissionLevel}),Object(i.mutator)(r.f,function(e){Object(d.a)(e.linkId).permissionLevel=e.newPermission});var h=t(1416);Object(i.mutator)(a,function(e){var n=Object(d.a)(e.linkId);n&&e.recipients.forEach(function(e){n.sharingRecipientsInfo.recipientPermissionInfos.some(function(n){return n.emailAddress===e.emailAddress})||n.sharingRecipientsInfo.recipientPermissionInfos.push(e)})}),Object(i.mutator)(o,function(e){var n=Object(d.a)(e.linkId);n&&e.results.forEach(function(e){for(var t=0;t<n.sharingRecipientsInfo.recipientPermissionInfos.length;t++){var r=n.sharingRecipientsInfo.recipientPermissionInfos[t];if(r.emailAddress===e.recipient.alias){r.hasAccess=e.hasAccess,r.canHaveAccess=e.canBeInvited,r.getPermissionInfoStatus=h.a.Succeeded;break}}})}),Object(i.mutator)(u,function(e){var n=Object(d.a)(e.linkId);n&&e.recipients.forEach(function(e){for(var t=0;t<n.sharingRecipientsInfo.recipientPermissionInfos.length;t++){var r=n.sharingRecipientsInfo.recipientPermissionInfos[t];if(r.emailAddress===e.emailAddress){r.getPermissionInfoStatus=h.a.Failed;break}}})}),Object(i.mutator)(c,function(e){var n=Object(d.a)(e.linkId);n&&(n.sharingRecipientsInfo.recipientPermissionInfos=n.sharingRecipientsInfo.recipientPermissionInfos.filter(function(n){return t=n.emailAddress,!e.recipients.some(function(e){return e.emailAddress===t});var t}))}),Object(i.mutator)(s,function(e){var n=Object(d.a)(e.linkId);n&&(n.sharingRecipientsInfo.recipientPermissionInfos=[])}),Object(i.mutator)(r.e,function(e){Object(d.a)(e.linkId).sharingInfo.shareId=e.sharingDialogResponse.shareId});var m=t(918),b=t(1645);Object(i.mutator)(r.a,function(e){Object(b.a)().sharingLinks.set(e.linkId,e.linkModel)}),Object(i.mutator)(m.f,function(e){Object(b.a)().sharingLinks.delete(e.linkId)}),Object(i.mutator)(m.d,function(e){Object(b.a)().sharingLinks.delete(e.linkId)}),Object(i.mutator)(f,function(e){Object(d.a)(e.linkId).sharingTipsIgnored.push(e.sharingTipId)}),Object(i.mutator)(r.e,function(e){var n=Object(d.a)(e.linkId);n&&(n.unwrappedUrl=null)}),Object(i.mutator)(r.g,function(e){var n=Object(d.a)(e.linkId);n&&(n.unwrappedUrl=null)}),Object(i.mutator)(r.d,function(e){var n=Object(d.a)(e.linkId);n&&(n.accessTokenAvailable=!1)});var v=t(0),O=t(151),g=t(104),I=t(8837),y=t.n(I),j=t(11826),k=t.n(j);function E(e,n,t){return Object(v.__awaiter)(this,void 0,void 0,function(){return Object(v.__generator)(this,function(r){switch(r.label){case 0:return[4,k()(S(e,n,t))];case 1:return[2,r.sent()]}})})}function S(e,n,t){return y()({PermissionLevel:n,ResourceLocation:e,DataProviderType:t||0})}var C=t(1589);Object(i.orchestrator)(h.n,function(e){return Object(v.__awaiter)(void 0,void 0,void 0,function(){var n,t;return Object(v.__generator)(this,function(i){switch(i.label){case 0:if("string"!=typeof e.id)return[3,2];if(0!==(n=Object(d.a)(e.id)).providerType)throw new Error("refreshExpirationDate only supports OneDrivePro link.");return n?(Object(r.c)(e.id,C.a.refreshing),[4,E(n.sharingInfo.canonicalUrl,n.permissionLevel)]):[3,2];case 1:if(t=i.sent(),Object(g.b)(t.Link))return Object(r.c)(e.id,C.a.refreshFailed),Object(O.m)("LinkRefreshLinkFailed"),[2];Object(r.c)(e.id,C.a.refreshSucceeded),Object(r.g)(n.linkId,t.Link,n.url,t.ExpirationDate),i.label=2;case 2:return[2]}})})});var x=t(978),T=t(62),w=t(5075);function _(e,n){return Object(v.__awaiter)(this,void 0,void 0,function(){return Object(v.__generator)(this,function(t){switch(t.label){case 0:switch(e){case 3:case 4:return[3,1]}return[3,3];case 1:return[4,Object(w.f)(1,n,e)];case 2:return[2,t.sent()];case 3:return T.d.error("Failed to create ODC sharing link due to unsupported permission level."),[2,null]}})})}var L=t(5884);function A(e){return{anonymousViewLink:e.AnonymousViewLink,anonymousEditLink:e.AnonymousEditLink,organizationViewLink:e.OrganizationViewLink,organizationEditLink:e.OrganizationEditLink}}Object(i.orchestrator)(r.b,function(e){return Object(v.__awaiter)(void 0,void 0,void 0,function(){var n,t,i,a;return Object(v.__generator)(this,function(o){switch(o.label){case 0:if(n=e.sharingUrl,t=null,null!==n)return[3,6];switch(e.providerType){case 0:return[3,1];case 1:return[3,3]}return[3,5];case 1:return[4,E(e.canonicalUrl,e.newPermissionLevel)];case 2:return i=o.sent(),n=i.Link,t=i.ExpirationDate,[3,6];case 3:return[4,_(e.newPermissionLevel,e.currentUrl)];case 4:return(a=o.sent())&&(n=a.link.webUrl,a.expirationDateTime!==L.a&&(t=a.expirationDateTime)),[3,6];case 5:T.d.error("Data provider is not supported"),o.label=6;case 6:return Object(r.g)(e.linkId,n,e.currentUrl,t),Object(x.D)(e.linkId,e.newPermissionLevel),Object(x.x)(e.linkId,e.recipientInfos,e.composeId),[2]}})})});var R=t(2159);function P(e,n){var t=Object(R.a)(e,n)||[];return-1===t.indexOf(0)&&0===n&&t.push(0),t}function D(e,n,t,r,i){switch(i){case 0:return function(e,n,t,r){var i;return t&&0===t.ResultCode?(i={getSharingInfoSucceeded:!0,blocksDownload:t.BlocksDownload,canonicalUrl:t.CanonicalUrl,canShareInternally:t.CanShareInternally,canShareExternally:t.CanShareExternally,expirationDate:t.ExpirationDate?Object(p.jc)(t.ExpirationDate):null,canRefresh:t.CanCreateAnonymousEditLink||t.CanCreateAnonymousViewLink,shareId:t.ShareId,siteUrl:t.SiteUrl,linkType:t.Type},{linkId:e,providerType:0,fileName:t.FileName,mimeType:t.MimeType,url:n,unwrappedUrl:t.OriginalUrl,accessTokenAvailable:!0,permissionLevel:Object(R.b)(t.SharingLinkKind),sharingInfo:i,supportedPermissionLevels:P(t,0),sharingUrls:A(t),sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:C.a.none,source:r}):{linkId:e,providerType:0,fileName:null,mimeType:null,url:n,unwrappedUrl:null,accessTokenAvailable:!1,permissionLevel:0,sharingInfo:i={getSharingInfoSucceeded:!1,blocksDownload:!1,canonicalUrl:"",canShareInternally:!1,canShareExternally:!1,expirationDate:null,canRefresh:!1,shareId:null,siteUrl:null,linkType:null},supportedPermissionLevels:null,sharingUrls:null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:C.a.none,source:r}}(e,n,t,r);case 1:return function(e,n,t,r){var i;return t&&0===t.ResultCode?(i={getSharingInfoSucceeded:!0,canShareInternally:!0,canShareExternally:!0,blocksDownload:!1,expirationDate:t.ExpirationDate?Object(p.jc)(t.ExpirationDate):null,canRefresh:!1,linkType:t.Type,providerFileId:t.providerFileId,location:t.location},{linkId:e,providerType:1,fileName:t.FileName,mimeType:t.MimeType,url:n,unwrappedUrl:null,accessTokenAvailable:!1,permissionLevel:Object(R.b)(t.SharingLinkKind),sharingInfo:i,supportedPermissionLevels:P(t,1),sharingUrls:A(t),sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:C.a.none,source:r}):{linkId:e,providerType:1,fileName:null,mimeType:null,url:n,unwrappedUrl:null,accessTokenAvailable:!1,permissionLevel:0,sharingInfo:i={getSharingInfoSucceeded:!1,canShareInternally:!1,canShareExternally:!1,blocksDownload:!1,expirationDate:null,canRefresh:!1,linkType:null,location:null,providerFileId:null},supportedPermissionLevels:null,sharingUrls:null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:C.a.none,source:r}}(e,n,t,r);default:throw new Error("createLinkModel do not support ${providerType}")}}var M=t(988);Object(i.orchestrator)(m.a,function(e){var n=D(e.linkId,e.url,e.response,e.source,e.providerType);Object(r.a)(e.linkId,n),0===e.providerType&&n.sharingInfo.siteUrl&&function(e,n){Object(v.__awaiter)(this,void 0,void 0,function(){return Object(v.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Object(M.k)(0,!1,e)];case 1:return t.sent(),[3,3];case 2:return t.sent(),Object(r.d)(n),[3,3];case 3:return[2]}})})}(n.sharingInfo.siteUrl,e.linkId)}),Object(i.orchestrator)(r.e,function(e){!function(e,n){return e.url!==n.url||e.permissionLevel!==n.permissionLevel||e.sharingInfo.blocksDownload!==n.blocksDownload||e.sharingInfo.expirationDate!==n.expirationDate}(Object(d.a)(e.linkId),e.sharingDialogResponse)?Object(O.m)("LinkUnchangedFromSharingDialog"):Object(O.m)("LinkChangedFromSharingDialog")});var N=t(1709);var F=t(880),U=t(1646);function B(e,n){var t=function(e){if(!e||0===e.length)return[];var n=[];return e.filter(function(e){return!!e}).map(function(e){var t=function(e){if(Object(U.b)(e))return e.recipients.slice();if(Object(U.a)(e)){var n=e;return function(e){return e?e.map(function(e){var n=e.persona?e.persona:{EmailAddress:e.Mailbox,PersonaId:{Id:null}},t=n.EmailAddress;return{persona:n,isValid:Object(F.c)(t.EmailAddress),isSelected:!1,isEditing:!1,isFadedOut:!1,isExpanding:!1,isContextMenuOpen:!1,displayText:t.Name?t.Name:t.EmailAddress}}):[]}(n)}return[]}(e);n=n.concat(t)}),n}(e),r=[];return t.forEach(function(e){var t=e.persona,i=function(e,n){var t=Object(N.a)().get(e,n);return t?{TotalMemberCount:t.value.TotalMemberCount,ExternalMemberCount:t.value.ExternalMemberCount}:null}(n,t.EmailAddress.EmailAddress);null!==i&&r.push({recipient:e,totalMemberCount:i.TotalMemberCount,externalMemberCount:i.ExternalMemberCount})}),r}var z=t(919);function G(e,n){var t=null,r=null;switch(e.providerType){case 1:var i=e.sharingInfo;t=i.location,r=i.providerFileId;break;case 0:t=e.sharingInfo.canonicalUrl}return{fileType:z.a.Cloud,name:e.fileName,size:null,providerId:n,providerType:e.providerType,location:t,providerEndpointUrl:null,isFolder:!1,fileId:r,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:e.mimeType}}t.d(n,"ignoreSharingTip",function(){return f}),t.d(n,"addRecipientsIntoLink",function(){return a}),t.d(n,"updateRecipientPermissionInfos",function(){return o}),t.d(n,"removeRecipientsFromLink",function(){return c}),t.d(n,"setGetPermissionInfoFailure",function(){return u}),t.d(n,"resetSharingRecipientsInfo",function(){return s}),t.d(n,"setLinkActionStatus",function(){return l}),t.d(n,"getSharingTipRecipientInfo",function(){return B}),t.d(n,"createCloudFileFromSharingLink",function(){return G}),t.d(n,"getSharingLinkInfo",function(){return d.a})},1416:function(e,n,t){"use strict";t.d(n,"h",function(){return s}),t.d(n,"i",function(){return l}),t.d(n,"f",function(){return f}),t.d(n,"k",function(){return d}),t.d(n,"m",function(){return p}),t.d(n,"e",function(){return h}),t.d(n,"g",function(){return m}),t.d(n,"j",function(){return b}),t.d(n,"l",function(){return v});var r=t(1201);t.d(n,"c",function(){return r.a}),t.d(n,"d",function(){return r.b});var i=t(1647);t.d(n,"b",function(){return i.a});var a=t(52),o=t(1648);t.d(n,"n",function(){return o.a});t(1259);var c=t(1590);t.d(n,"a",function(){return c.a});var u=new a.c(function(){return Promise.all([t.e(4),t.e(12),t.e(71),t.e(455)]).then(t.bind(null,3290))}),s=new a.b(u,function(e){return e.getSharingInformation}),l=new a.b(u,function(e){return e.getSharingIssuesForSharingData}),f=new a.b(u,function(e){return e.getInfoBarCreator}),d=new a.b(u,function(e){return e.hasLargeDLRecipient}),p=new a.b(u,function(e){return e.hasRecipientExpansionFailure}),h=new a.b(u,function(e){return e.getGroupsAndSmallDLs}),m=new a.b(u,function(e){return e.getInvididualRecipients}),b=new a.b(u,function(e){return e.hasGetRecipientPermissionFailed}),v=new a.b(u,function(e){return e.logSharingTipChangesForLinkRemoval})},1590:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1647:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1648:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(4),i=Object(r.action)("REFRESH_EXPIRATION_DATE",function(e){return{id:e}})},1690:function(e,n,t){"use strict";var r=t(4),i=Object(r.createStore)("bposStore",{bposNavBarData:null})();n.a=i},1709:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(2288);function i(){return Object(r.b)().mailTips}},1867:function(e,n,t){"use strict";var r=t(0),i=function(e){function n(n,t,r){var i=e.call(this,t,r)||this;return i.value=n,i}return Object(r.__extends)(n,e),n}(t(2292).a);n.a=i},1929:function(e,n,t){"use strict";var r=t(1690),i=t(4),a=Object(i.action)("SET_BPOS_NAV_BAR_DATA ",function(e){return{bposNavBarData:e}});Object(i.mutator)(a,function(e){r.a.bposNavBarData=e.bposNavBarData});var o=t(2322),c=t.n(o);var u=t(2214),s=t(71),l=Object(i.action)("LOAD_BposNavBarData"),f=l;function d(){return r.a.bposNavBarData}Object(i.orchestrator)(l,function(e){Object(s.s)()||c()().then(function(e){a(e),Object(u.a)()})}),t.d(n,"b",function(){return f}),t.d(n,"a",function(){return d})},2159:function(e,n,t){"use strict";function r(e,n){if(null===e)return null;var t=[];if(0===n){var r=e;r.CanShareInternally&&(t.push(2),t.push(1)),r.CanCreateOrganizationEditLink&&t.push(6),r.CanCreateOrganizationViewLink&&t.push(5)}return e.CanCreateAnonymousEditLink&&t.push(4),e.CanCreateAnonymousViewLink&&t.push(3),t.length>0?t:null}function i(e){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;default:return 0}}function a(e,n,t){var r=i(e);if(0===r)switch(n){case 2:return t?4:3;case 1:return t?6:5;case 5:return t?2:1;default:return 0}return r}var o=t(3244),c=t(5),u="OneDrivePro",s=t(160),l=t(65),f=t(40);function d(e,n){switch(e){case 3:return Object(c.a)(o.b);case 4:return Object(c.a)(o.a);case 6:return Object(c.a)(o.d);case 5:return Object(c.a)(o.e);case 1:return n===u?Object(c.a)(o.g):Object(c.a)(o.b);case 2:return n===u?Object(c.a)(o.f):Object(c.a)(o.a);case 0:return Object(c.a)(o.c);default:return Object(s.a)(e)}}function p(e,n){return 0===n&&Object(l.f)("doc-attachment-contextualSharingTips")?function(e){var n=Object(f.a)().SessionSettings.CompanyName;switch(e){case 3:return Object(c.a)(o.i);case 4:return Object(c.a)(o.h);case 6:return Object(c.b)(Object(c.a)(o.j),n);case 5:return Object(c.b)(Object(c.a)(o.k),n);case 1:return Object(c.a)(o.g);case 2:return Object(c.a)(o.f);case 0:return Object(c.a)(o.c);default:return Object(s.a)(e)}}(e):d(e,null)}function h(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}t.d(n,"a",function(){return r}),t.d(n,"b",function(){return i}),t.d(n,"c",function(){return a}),t.d(n,"d",function(){return d}),t.d(n,"e",function(){return p}),t.d(n,"f",function(){return h})},2214:function(e,n,t){"use strict";var r=t(4);n.a=Object(r.action)("ON_BPOS_NAV_BAR_DATA_LOADED")},2275:function(e,n,t){"use strict";var r=t(4);n.a=Object(r.action)("updateMailtips",function(e,n,t){return{composeId:e,fromEmailAddress:n,recipients:t}})},2288:function(e,n,t){"use strict";var r,i=t(4),a=t(1867),o=t(2292),c=t(0),u=t(2465),s=t(2275),l=t(1709),f=t(191),d=t(3220),p=t.n(d),h=t(3222),m=t.n(h),b=t(246),v=t(131);function O(e,n){return Object(b.e)(Object(v.e)(e)).then(function(t){return p()({Header:Object(f.getJsonRequestHeader)(),Body:m()({MailTipsRequested:1,SendingAs:{EmailAddress:e},Recipients:n.map(function(e){return{EmailAddress:e}})})},t).then(function(e){var n;return(null===(n=e)||void 0===n?void 0:n.Body)&&"Success"==e.Body.ResponseClass?e.Body:null}).catch(function(e){return Promise.resolve(null)})})}!function(e){e.CustomMailTip="CustomMailTip",e.DeliveryRestricted="DeliveryRestricted",e.ExternalMemberCount="ExternalMemberCount",e.GuestMailTipStatus="GuestMailTipStatus",e.IsModerated="IsModerated",e.MailboxFull="MailboxFull",e.MaxMessageSize="MaxMessageSize",e.OutOfOffice="OutOfOffice",e.PreferAccessibleContent="PreferAccessibleContent",e.RecipientAddress="RecipientAddress",e.TotalMemberCount="TotalMemberCount"}(r||(r={}));var g=r,I=t(2635),y=/<!--((.|\n)*?)-->/gi,j=function(e){for(var n=[],t=0;t<e.length;t++)n.push(e[t]);return n};var k=function(e){return e.childNodes?C(j(e.childNodes).filter(function(e){return"ReplyBody"===e.localName})[0]):""},E=function(e){return e.replace(y,"")},S=function(e){var n=e.split(" "),t=I.a.None;return n.map(function(e){t|=I.a[e]}),t};function C(e){var n,t;if(e){var r=E(e.textContent).replace(/<\/a>/gi,"</a> "),i=(new DOMParser).parseFromString(r,"text/html");if((null===(t=null===(n=i)||void 0===n?void 0:n.childNodes)||void 0===t?void 0:t.length)&&i.childNodes[0].textContent)return i.childNodes[0].textContent.replace(/\s\s+/g," ").trim()}return""}var x=t(151);Object(i.orchestrator)(s.a,function(e){return Object(c.__awaiter)(void 0,void 0,void 0,function(){var n,t,r,i,o,s,f;return Object(c.__generator)(this,function(c){switch(c.label){case 0:return n=e.composeId,t=e.fromEmailAddress,r=e.recipients,t&&r&&r.length?(i=Object(l.a)(),(o=r.filter(function(e){return e&&!i.containsValueForKey(t,e)})).length?[4,O(t,o)]:[3,2]):[3,3];case 1:(s=c.sent())&&(f=s.ResponseMessages.map(function(e){return function(e){if(!e)return null;var n=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes;return j(n).reduce(function(e,n){switch(n.localName){case g.RecipientAddress:n.childNodes.length>1&&(e.RecipientAddress=n.childNodes[1].textContent);break;case g.MailboxFull:e.MailboxFull="true"===n.textContent;break;case g.IsModerated:e.IsModerated="true"===n.textContent;break;case g.TotalMemberCount:e.TotalMemberCount=parseInt(n.textContent)||0;break;case g.ExternalMemberCount:e.ExternalMemberCount=parseInt(n.textContent)||0;break;case g.MaxMessageSize:e.MaxMessageSize=parseInt(n.textContent)||0;break;case g.DeliveryRestricted:e.DeliveryRestricted="true"===n.textContent;break;case g.PreferAccessibleContent:e.PreferAccessibleContent="true"===n.textContent;break;case g.OutOfOffice:e.OutOfOffice=k(n);break;case g.CustomMailTip:e.CustomMailTip=C(n);break;case g.GuestMailTipStatus:e.GuestStatus=S(n.textContent)}return e},{})}(e.MessageText)}).filter(function(e){return!!e}))&&f.length>0&&(!function(e,n){if(e&&e.length>0&&n){var t=Object(l.a)();e.map(function(e){t.add(n,new a.a(e,n,e.RecipientAddress))})}}(f,t),Object(u.a)(n,t)),c.label=2;case 2:r.map(function(e){var n=!1;-1==o.indexOf(e)&&(n=!0),Object(x.m)("UpdateMailtipsDatapoint",[n])}),c.label=3;case 3:return[2]}})})});t.d(n,"b",function(){return w});var T={mailTips:new o.b(a.a.compareEntryCacheTime)},w=Object(i.createStore)("mailTipsCacheStore",T),_=w();n.a=_},2292:function(e,n,t){"use strict";var r=t(0),i=t(21),a=t(365),o=300,c=function(){function e(e,n){this.parentCacheKey=e,this.childMruCacheKey=n,this.cacheTime=Date.now()}return e.isExpired=function(e){return Date.now()-e.cacheTime>=72e5},e.compareEntryCacheTime=function(e,n){return e.cacheTime-n.cacheTime},e}(),u=t(69),s=function(){function e(e,n,t){void 0===n&&(n=o),void 0===t&&(t=Date.now()),this.comparer=e,this.cacheLimit=n,this.lastExpiredEntryClearedTime=t,this.cache=new i.ObservableMap}return e.prototype.initialize=function(e){this.cache=e.cache},e.prototype.add=function(e,n){var t=this;Object(u.action)("NestedMruCache_add")(function(){t.clearOldEntriesIfNeeded();var r=null;t.cache.has(e)?r=t.cache.get(e):((r=new a.a(t.cacheLimit)).initialize(new i.ObservableMap),t.cache.set(e,r)),r.add(n.childMruCacheKey,n)})()},e.prototype.containsValueForKey=function(e,n){if(!this.cache.has(e))return!1;var t=this.cache.get(e).get(n);return!(!t||c.isExpired(t))},e.prototype.get=function(e,n){var t=null;return this.containsValueForKey(e,n)&&(t=this.cache.get(e).get(n)),t},e.prototype.clearUpExpiredEntries=function(){var e,n;if(!(Date.now()-this.lastExpiredEntryClearedTime<12e5)){var t=function(e){e.getItemIds().forEach(function(n){c.isExpired(e.get(n))&&e.remove(n)})};try{for(var i=Object(r.__values)(this.cache.values()),a=i.next();!a.done;a=i.next()){t(a.value)}}catch(n){e={error:n}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}this.lastExpiredEntryClearedTime=Date.now()}},e.prototype.remove=function(e){var n=this;Object(u.action)("NestedMruCache_remove")(function(){if(n.cache.has(e)){var t=n.cache.get(e);t.getItemIds().map(function(e){t.remove(e)})}})()},e.prototype.clear=function(){var e=this;Object(u.action)("NestedMruCache_clear")(function(){var n,t,i=e.cache.keys();try{for(var a=Object(r.__values)(i),o=a.next();!o.done;o=a.next()){var c=o.value;e.remove(c)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(n)throw n.error}}})()},e.prototype.countTotalNumberOfEntries=function(){var e,n,t=0;if(this.cache)try{for(var i=Object(r.__values)(this.cache.values()),a=i.next();!a.done;a=i.next()){t+=a.value.getItemIds().length}}catch(n){e={error:n}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return t},e.prototype.returnAllMailTipsCacheEntries=function(){var e,n,t=[];if(this.cache){var i=function(e){e&&e.getItemIds().map(function(n){var r=e.get(n);t.push(r)})};try{for(var a=Object(r.__values)(this.cache.values()),o=a.next();!o.done;o=a.next()){i(o.value)}}catch(n){e={error:n}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}}return t},e.prototype.clearOldEntriesIfNeeded=function(){var e,n;if(this.countTotalNumberOfEntries()>=o&&this.clearUpExpiredEntries(),this.countTotalNumberOfEntries()>=o){var t=[],i=function(e){e.getItemIds().forEach(function(n){t.push(e.get(n))})};try{for(var a=Object(r.__values)(this.cache.values()),c=a.next();!c.done;c=a.next()){i(c.value)}}catch(n){e={error:n}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}t.sort(this.comparer);for(var u=0;u<50;u++){var s=t[u].parentCacheKey,l=t[u].childMruCacheKey;this.cache.get(s).remove(l)}}},e}();t.d(n,"b",function(){return s}),t.d(n,"a",function(){return c})},2322:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(129);n.default=function(e){return r.makeServiceRequest("GetBposShellInfoNavBarData",{},e)}},2465:function(e,n,t){"use strict";var r=t(4);n.a=Object(r.action)("onMailTipRetrieved",function(e,n){return{composeId:e,fromAddress:n}})},2635:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.IsCalculated=1]="IsCalculated",e[e.GuestsEnabled=2]="GuestsEnabled",e[e.GroupHasGuests=4]="GroupHasGuests"}(r||(r={}))},3220:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(129),i=t(3221);n.default=function(e,n){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetMailTips",e,n)}},3221:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);n.default=function(e){return r.__assign({__type:"GetMailTipsJsonRequest:#Exchange"},e)}},3222:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);n.default=function(e){return r.__assign({__type:"GetMailTipsRequest:#Exchange"},e)}},3244:function(e){e.exports={b:"Zca",a:"_ca",d:"$ca",e:"ada",g:"bda",f:"cda",c:"dda",i:"eda",h:"fda",j:"gda",k:"hda"}},3412:function(e,n,t){"use strict";var r=t(151),i=t(248);function a(e,n){var t;try{t=Object(i.parse)(e).hostname}catch(e){return Object(r.m)("isLinkPrefixedWithBaseUrl"),!1}return t===Object(i.parse)(n).hostname&&e!==n}var o=t(1929),c=t(65),u=t(62),s=["https://microsoft.sharepoint.com","https://microsoft-my.sharepoint.com","https://microsoft.sharepoint-df.com","https://microsoft-my.sharepoint-df.com"];function l(e){if(!e)return Object(r.m)("isSharePointLinkCalledWithoutUrl"),!1;var n=Object(o.a)();return n?!(!n.SPO_MySiteHostUrl||!a(e,n.SPO_MySiteHostUrl))||(!(!n.SPO_RootSiteUrl||!a(e,n.SPO_RootSiteUrl))||!!Object(c.f)("doc-SharePoint-dogfoodUser")&&s.some(function(n){return a(e,n)})):(u.d.info("isSharePointLink:bposNavBarData is null"),!1)}function f(e){return!!e&&(e.indexOf("?at=")>0||e.indexOf("&at=")>0)}t.d(n,"a",function(){return a}),t.d(n,"b",function(){return l}),t.d(n,"c",function(){return f})},365:function(e,n,t){"use strict";var r=t(0),i=t(69),a=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,n){var t,i;if(this.store)throw new Error("MruCache cannot be initialized twice.");this.store=e,this.deleteCallback=n;try{for(var a=Object(r.__values)(e.keys()),o=a.next();!o.done;o=a.next()){var c=o.value;this.mruList.push(c)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}},e.prototype.add=function(e,n){var t=this;Object(i.action)("MruCache_add")(function(){t.store.set(e,n),t.mruList.indexOf(e)>=0?t.touch(e):(t.mruList.push(e),t.purgeIfNecessary())})()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var n=this.store.get(e);return n&&this.touch(e),n},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var n=this;Object(i.action)("MruCache_remove")(function(){if(n.store.has(e)&&!n.isReferenced(e))return n.removeItemAtIndex(n.mruList.indexOf(e))})()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(i.action)("MruCache_clear")(function(){e.purgeTillSize(0)})()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var n=this.mruList.indexOf(e);if(n<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(n,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var n=0;this.mruList.length>e&&n<this.mruList.length;){var t=this.mruList[n];this.isReferenced(t)?n++:this.removeItemAtIndex(n)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var n=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(n):this.store.delete(n)},e.prototype.isReferenced=function(e){for(var n=0;n<this.references.length;n++)if(this.references[n]()==e)return!0;return!1},e}();t.d(n,"a",function(){return a})},5884:function(e,n,t){"use strict";var r=t(5075);function i(e,n){var t=!e.link.scope||e.link.scope===r.a,i=e.link.type===r.e,a=e.link.type===r.d;if(1===n&&!t)throw new Error("CreateSharingLinkFromFileProviderResult: OneDriveConsumer link must use anonymous scope");if(t){if(i)return 4;if(a)return 5;throw new Error("CreateSharingLinkFromFileProviderResult: unexpected type "+e.link.type+" for anonymous link")}switch(e.link.scope){case r.b:if(i)return 2;if(a)return 3;throw new Error("CreateSharingLinkFromFileProviderResult: unexpected type "+e.link.type+" for org link");case r.c:if(i||a)return 6;throw new Error("CreateSharingLinkFromFileProviderResult: unexpected type "+e.link.type+" for PSL");default:throw new Error("CreateSharingLinkFromFileProviderResult: unexpected scope "+e.link.scope+" with type "+e.link.type)}}var a="https://1drv.ms",o="0001-01-01T00:00:00Z";function c(e,n){switch(e.providerType){case 1:return function(e,n){return{ResultCode:0,FileName:e.name,MimeType:e.type,SharingLinkKind:i(n,e.providerType),BlocksDownload:!1,CanShareExternally:!0,CanCreateAnonymousEditLink:!0,CanCreateAnonymousViewLink:!0,ExpirationDate:n.expirationDateTime===o?null:n.expirationDateTime,OriginalUrl:null,Type:n.link.type,providerFileId:e.fileId,location:e.location}}(e,n);default:throw new Error("createGetSharingInfoResponse do not support "+e.providerType)}}var u=t(151),s=t(3412),l=t(248);function f(e){return Object(s.a)(e,a)}function d(e,n){switch(n){case 0:!function(e){Object(s.b)(e)||p(e)}(e);break;case 1:!function(e){f(e)||p(e)}(e);break;default:throw new Error("checkSharingLinkUrlDomain do not support "+n)}}function p(e){var n=Object(l.parse)(e).hostname;Object(u.m)("FileProviderSharingLinkUnknownDomain",{unknownDomain:n})}var h=t(65);function m(e){return Object(s.b)(e)?0:Object(h.f)("doc-link-filePicker")&&f(e)?1:null}t.d(n,"c",function(){return c}),t.d(n,"a",function(){return o}),t.d(n,"b",function(){return d}),t.d(n,"d",function(){return m})},770:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub"}(r||(r={}))},880:function(e,n,t){"use strict";t.d(n,"c",function(){return s}),t.d(n,"b",function(){return l}),t.d(n,"a",function(){return f});var r=/^([a-zA-Z0-9!#$%&'*+/=?^_`{|}~-](?:[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]*[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-])?)(?=@)/,i=/^("[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~\-(),:;<>@[\\\]" ]*")(?=@)/,a=/^[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,o=/[^\\]"/,c=/^[A-Za-z0-9_-]+:.*$/,u=function(e){var n=e.match(r);if(n)return-1!==n[0].indexOf("..")?null:n[0];var t=e.match(i);if(t){var a=o.exec(t[0]);return a&&a.index!==t[0].length-2?null:t[0]}return null};function s(e){if(!e)return!1;var n=u(e);return!!n&&!!e.substring(n.length+1).match(a)}function l(e){return c.test(e)}function f(e){return s(e)||l(e)}},8837:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);n.default=function(e){return r.__assign({__type:"CreateAttachmentSharingLinkRequest:#Exchange"},e)}},919:function(e,n,t){"use strict";var r=t(770),i={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function a(e){switch(e?e.toLowerCase():null){case i.ONE_DRIVE_PRO.toLowerCase():return 0;case i.GDRIVE.toLowerCase():return 5;case i.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case i.DROPBOX.toLowerCase():return 2;case i.BOX.toLowerCase():return 3;case i.WOPI_BOX.toLowerCase():return 7;case i.WOPI_EGNYTE.toLowerCase():return 8;case i.MAILBOX.toLowerCase():return 4;case i.FACEBOOK.toLowerCase():return 6;default:return null}}function o(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function c(e){return null==e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function u(e){if(!e)return null;for(var n=[],t=0;t<e.length;t++){var i=e[t],a={fileType:r.a.Local,name:i.name,size:i.size,type:i.type,fileObject:i};n.push(a)}return n}function s(e,n,t){var i=[],a={fileType:r.a.MailItem,name:e,size:t||0,mimeContent:n};return i.push(a),i}var l=t(62);function f(e,n,t){var i;if(e.length!=n.length)return l.d.error("The sizes of subjects and latestItemIds are different"),null;for(var a=[],o=0;o<e.length;o++){var c={fileType:r.a.MailItem,name:e[o],size:(null===(i=t)||void 0===i?void 0:i[o])||0,itemId:n[o]};a.push(c)}return a}var d=t(762);function p(e){return e.map(function(e){return{fileType:r.a.Uri,name:e.name,type:Object(d.b)(e.url),size:0,uri:e.url}})}t.d(n,"b",function(){return a}),t.d(n,"e",function(){return u}),t.d(n,"g",function(){return f}),t.d(n,"c",function(){return o}),t.d(n,"d",function(){return c}),t.d(n,"h",function(){return p}),t.d(n,"f",function(){return s}),t.d(n,"a",function(){return r.a})}},0,[4,12,71,455,565,110,541]]);
//# sourceMappingURL=owa.LinkData.js.map
self.scriptsLoaded['owa.LinkData.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.LinkData.js'] = (new Date()).getTime();