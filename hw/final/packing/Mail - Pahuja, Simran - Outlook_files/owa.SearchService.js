self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SearchService.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[451],{14263:function(t,e,n){"use strict";n.r(e);var i=n(1047),r=n(1559),o={},u=[];function s(t,e,n,i){var u={Name:"clientdatasource",Attributes:[]},s={Results:[]};n.forEach(function(t){s.Results.push({ReferenceId:t.localContentId,EntityId:t.entityId,Type:t.contentType})}),u.Attributes.push({Key:e,Value:btoa(JSON.stringify(s))}),Object(r.a)(t,u,i),function(t){t.forEach(function(t){o[t.entityId]=t.localContentId})}(n)}function a(t,e,n){if(-1==u.indexOf(t)){u.push(t);var i={Name:"clientlayout",Attributes:[]};Object.keys(e).forEach(function(t){var n={Results:[]};e[t].forEach(function(t){var e=f(t.entityId);n.Results.push({ReferenceId:e,Position:t.position})}),i.Attributes.push({Key:t,Value:btoa(JSON.stringify(n))})}),Object(r.a)(t,i,n)}}function c(){o={},u=[]}function f(t){return o[t]}var l=n(0),h=n(992),d=n(112),p=n(999),v=n(467);function k(t,e,n,i){return Object(l.__awaiter)(this,void 0,void 0,function(){var r,o,u,s,a,c;return Object(l.__generator)(this,function(f){switch(f.label){case 0:return r={cvid:t,scenario:e},o=Object(p.a)(r),u={},n&&(u["X-Client-Flights"]=n),2!=i?[3,3]:(s=Object(l.__read)(Object(v.getAccessTokenforResourceAsLazy)("https://outlook.office.com/search"),2),a=s[0],c=s[1],a?[3,2]:[4,c]);case 1:a=f.sent(),f.label=2;case 2:u.authorization="Bearer "+a,f.label=3;case 3:return[2,Object(d.b)(Object(h.a)("init",i)+"?"+o,void 0,void 0,u,void 0,!1)]}})})}function b(){m("Delete")}function y(){return m("Export")}var m=function(t){return Object(d.d)(""+Object(h.a)("searchHistory"),{Action:t,Scenario:{Name:"owa.react"}})};n.d(e,"flushNonRenderedResponseReceivedItemsFromCache",function(){return i.a}),n.d(e,"logEntityClicked",function(){return i.c}),n.d(e,"logExecuteSearchCorrelation",function(){return i.d}),n.d(e,"logResponseNeverRendered",function(){return i.f}),n.d(e,"logResponseReceived",function(){return i.g}),n.d(e,"logResponseRendered",function(){return i.h}),n.d(e,"logSearchBoxStateChanged",function(){return i.i}),n.d(e,"logSearchDone",function(){return i.j}),n.d(e,"logSearchResultInteraction",function(){return i.k}),n.d(e,"logSessionEnd",function(){return i.m}),n.d(e,"logSecondaryEntityActionClicked",function(){return i.l}),n.d(e,"logFeedback",function(){return i.e}),n.d(e,"logLocalContentDataSource",function(){return s}),n.d(e,"logLocalContentLayout",function(){return a}),n.d(e,"clearLocalContentInstrumentationCache",function(){return c}),n.d(e,"getLocalContentId",function(){return f}),n.d(e,"substrateSearchInitOperation",function(){return k}),n.d(e,"deleteSubstrateSearchHistoryService",function(){return b}),n.d(e,"exportSubstrateSearchHistoryService",function(){return y})},161:function(t,e,n){"use strict";function i(){var t=Object.create(null),e=0,n=0,i=0,r=!1;function o(e){i--,delete t[e]}this.put=function(e,n,r,u){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var s=t[e];s?clearTimeout(s.timeout):i++;var a={value:n,expire:r+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){o(e),u&&u(e,n)}.bind(this),r)),t[e]=a,n},this.del=function(e){var n=!0,i=t[e];return i?(clearTimeout(i.timeout),!isNaN(i.expire)&&i.expire<Date.now()&&(n=!1)):n=!1,n&&o(e),n},this.clear=function(){for(var o in t)clearTimeout(t[o].timeout);i=0,t=Object.create(null),r&&(e=0,n=0)},this.get=function(o){var u=t[o];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return r&&e++,u.value;r&&n++,i--,delete t[o]}else r&&n++;return null},this.size=function(){return i},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){r=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var i=t[n];e[n]={value:i.value,expire:i.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var i=JSON.parse(e),r=Date.now(),o=n&&n.skipDuplicates;for(var u in i)if(i.hasOwnProperty(u)){if(o)if(t[u])continue;var s=i[u],a=s.expire-r;if(a<=0){this.del(u);continue}a=a>0?a:void 0,this.put(u,s.value,a)}return this.size()}}t.exports=new i,t.exports.Cache=i},251:function(t,e,n){"use strict";var i=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout(function(){t.tryRunTask()},this.taskDelay)},t.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.runTask=function(){var t=this,e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(function(){t.onTaskComplete()}).catch(function(){t.onTaskComplete()}),this.scheduleTask()},t}();n.d(e,"a",function(){return i})},298:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0);e.default=function(t){return i.__assign({__type:"TokenRequest:#Exchange"},t)}},339:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(129),r=n(298);e.default=function(t,e){return void 0===t||t.__type||(t=r.default(t)),i.makeServiceRequest("GetAccessTokenforResource",t,e)}}},0,[565,110]]);
//# sourceMappingURL=owa.SearchService.js.map
self.scriptsLoaded['owa.SearchService.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SearchService.js'] = (new Date()).getTime();