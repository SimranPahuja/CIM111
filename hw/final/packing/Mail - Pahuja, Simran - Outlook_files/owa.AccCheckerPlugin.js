self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AccCheckerPlugin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[103],{1033:function(t,e,r){"use strict";var o=r(21),n=r(1),i=r(141),a=r(52),c=new a.c(function(){return r.e(981).then(r.t.bind(null,13934,7))}),u=new a.b(c,function(t){return t.default}),s=r(71),l=r(840);function d(t){if("string"==typeof(t=Object(l.a)(t))||Array.isArray(t))return t;var e=Object(s.f)().UserOptions,r=(void 0===e?{}:e).KeyboardShortcutsMode;switch(void 0===r?"":r){case 0:return t.hotmail;case 2:return t.yahoo;case 3:return t.gmail;case 4:return t.owa;default:return}}function p(t,e){if(t.ctrlKey||t.altKey||t.metaKey||e)return!1;var r=t.target;return"INPUT"==r.tagName||"SELECT"==r.tagName||"TEXTAREA"==r.tagName||r.contentEditable&&"true"==r.contentEditable}function h(t,e,r,o,n){var i=void 0===n?{}:n,a=i.stopPropagation,c=void 0===a||a,u=i.preventDefault,s=void 0===u||u,l=i.allowHotkeyOnTextFields,h=void 0!==l&&l,f=d(r);f&&e.bind(f,function(e){p(e,h)||(c&&e.stopPropagation(),s&&e.preventDefault(),o.call(t,e))})}var f="__keydownHandlerMap",b="__keydownHandlerHooksAdded";function g(t,e,r,n){return void 0===e&&(e=!0),void 0===r&&(r=!0),void 0===n&&(n=!1),function(a,c,s){if("object"==typeof window&&(a[f]=a[f]||{},a[f][c]={command:t,stopPropagation:e,preventDefault:r,allowHotkeyOnTextFields:n},!a[b])){var l=a.componentDidMount;a.componentDidMount=function(){var t=this;l&&l.call(this);var e,r=u.import(),n=function(){t.__mousetrap&&t.__mousetrap.reset(),e&&e()},c=r.then(function(r){t.__mousetrap=new r(i.findDOMNode(t)),e=Object(o.autorun)(function(t){this.__mousetrap.reset();for(var e=t[f],r=Object.keys(e),o=0;o<r.length;o++){var n=r[o];h(this,this.__mousetrap,e[n].command,t[n],{stopPropagation:e[n].stopPropagation,preventDefault:e[n].preventDefault,allowHotkeyOnTextFields:e[n].allowHotkeyOnTextFields})}}.bind(t,a))}).catch(n);this.__cleanupMousetrap=c.then(function(){return n})};var d=a.componentWillUnmount;a.componentWillUnmount=function(){d&&d.call(this),this.__cleanupMousetrap&&this.__cleanupMousetrap.then(function(t){return t()})},a[b]=!0}}}function m(t,e,r,o){var i=void 0===o?{}:o,a=i.stopPropagation,c=void 0===a||a,s=i.preventDefault,l=void 0===s||s,h=i.allowHotkeyOnTextFields,f=void 0!==h&&h,b=n.useCallback(function(t){p(t,f)||(c&&t.stopPropagation(),l&&t.preventDefault(),r(t))},[r,c,l,f]),g=n.useMemo(function(){return d(e)},[e]),m=u.tryImportForRender();n.useEffect(function(){if(m&&g&&t.current){var e=new m(t.current);return e.bind(g,b),function(){return e.reset()}}},[m,g,t,b])}var v=r(0);function k(t,e,r){var n=void 0===r?{}:r,i=n.allowHotkeyOnTextFields,a=void 0!==i&&i,c=n.isEnabled,s=n.stopPropagation,p=void 0===s||s,h=n.preventDefault,f=void 0===h||h;return Object(v.__awaiter)(this,void 0,void 0,function(){var r,n,i,s;return Object(v.__generator)(this,function(h){switch(h.label){case 0:return[4,u.import()];case 1:return r=h.sent(),n=new r(document.body),i=function(t){return d(t=Object(l.a)(t))}(t),s=Object(o.autorun)(function(){!function(t,e,r){t.reset(),e&&t.bind(e,r)}(n,i,y(a,c,p,f,e))}),[2,function(){n.reset(),s()}]}})})}function y(t,e,r,o,n){return function(i){p(i,t)||e&&!e()||(r&&i.stopPropagation(),o&&i.preventDefault(),n())}}function C(t,e){return function(r){var n,a,c,s=r.prototype.componentDidMount;r.prototype.componentDidMount=function(){var e=this;c=!0,s&&s.call(this,arguments),Promise.all([u.import(),t(this)]).then(function(t){var r,u=Object(v.__read)(t,2),s=u[0],l=u[1];try{r=c&&i.findDOMNode(e)}catch(t){}r&&(n=new s(r),a=Object(o.autorun)(function(){n.reset(),l.forEach(function(t){h(e,n,t.command,t.handler,t.options)})}))})};var l=r.prototype.componentWillUnmount;return r.prototype.componentWillUnmount=function(){var t,r;c=!1,l&&l.call(this,arguments),n&&n.reset(),null===(t=a)||void 0===t||t(),null===(r=e)||void 0===r||r(this)},r}}r.d(e,"c",function(){return g}),r.d(e,"e",function(){return m}),r.d(e,"a",function(){return k}),r.d(e,"b",function(){return l.a}),r.d(e,"d",function(){return C})},11985:function(t){t.exports={g:"drb",h:"erb",c:"frb",d:"grb",b:"hrb",j:"irb",k:"jrb",e:"krb",f:"lrb",a:"mrb",i:"nrb"}},11986:function(t,e,r){var o=r(11987),n=r(44);"string"==typeof o&&(o=[[t.i,o]]);for(var i=0;i<o.length;i++)n.loadStyles(o[i][1],!1);o.locals&&(t.exports=o.locals)},11987:function(t,e,r){(e=t.exports=r(43)(!1)).push([t.i,".WMdljJqO5VpCedHG6rPcu{font-size:17px;font-weight:300}html[dir] .WMdljJqO5VpCedHG6rPcu{padding-bottom:10px}._2xKfDR2FzdtzIJWrlTI6dc{font-size:12px;font-weight:400}html[dir] ._2xKfDR2FzdtzIJWrlTI6dc{padding-bottom:10px}._2QjYMmxcldgsfy0slqk828{height:32px}html[dir] ._2QjYMmxcldgsfy0slqk828{margin:10px 0 20px 0;border-radius:2px}",""]),e.locals={sectionHeader:"WMdljJqO5VpCedHG6rPcu",sectionMessage:"_2xKfDR2FzdtzIJWrlTI6dc",accCheckerButton:"_2QjYMmxcldgsfy0slqk828"}},197:function(t,e,r){"use strict";r.d(e,"b",function(){return i}),r.d(e,"a",function(){return a});var o=r(16),n=r(306);function i(t){var e,r,n,i,a,c=t.semanticColors,u=t.palette,s=c.buttonBackground,l=c.buttonBackgroundPressed,d=c.buttonBackgroundHovered,p=c.buttonText,h=c.buttonTextHovered,f=c.buttonTextChecked,b=c.buttonTextCheckedHovered;return{root:{backgroundColor:s,color:p},rootHovered:{backgroundColor:d,color:h,selectors:(e={},e[o.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},e)},rootPressed:{backgroundColor:l,color:f},rootExpanded:{backgroundColor:l,color:f},rootChecked:{backgroundColor:l,color:f},rootCheckedHovered:{backgroundColor:l,color:b},rootDisabled:{selectors:(r={},r[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},r)},splitButtonContainer:{selectors:(n={},n[o.HighContrastSelector]={border:"none"},n)},splitButtonMenuButton:{color:u.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:u.neutralLight,selectors:(i={},i[o.HighContrastSelector]={color:"Highlight"},i)}}},splitButtonMenuButtonDisabled:{backgroundColor:c.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:c.buttonBackgroundDisabled}}},splitButtonDivider:{backgroundColor:u.neutralTertiaryAlt,position:"absolute",width:1,right:31,top:8,bottom:8,selectors:(a={},a[o.HighContrastSelector]={backgroundColor:"WindowText"},a)},splitButtonDividerDisabled:{backgroundColor:t.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:u.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:u.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:u.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:u.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:c.buttonText},splitButtonMenuIconDisabled:{color:c.buttonTextDisabled}}}function a(t){var e,r,i,a,c,u,s,l,d,p=t.palette,h=t.semanticColors;return{root:{backgroundColor:h.primaryButtonBackground,color:h.primaryButtonText,border:"none",selectors:(e={},e[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},e["."+n.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:p.white}}},e)},rootHovered:{backgroundColor:h.primaryButtonBackgroundHovered,color:h.primaryButtonTextHovered,selectors:(r={},r[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight"},r)},rootPressed:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed,selectors:(i={},i[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},i)},rootExpanded:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootChecked:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootDisabled:{selectors:(a={},a[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},a)},splitButtonContainer:{selectors:(c={},c[o.HighContrastSelector]={border:"none"},c)},splitButtonDivider:{backgroundColor:p.neutralTertiaryAlt,position:"absolute",width:1,right:31,top:8,bottom:8,selectors:(u={},u[o.HighContrastSelector]={backgroundColor:"Window"},u)},splitButtonMenuButton:{backgroundColor:h.primaryButtonBackground,color:h.primaryButtonText,selectors:(s={},s[o.HighContrastSelector]={backgroundColor:"WindowText"},s[":hover"]={backgroundColor:h.primaryButtonBackgroundHovered,selectors:(l={},l[o.HighContrastSelector]={color:"Highlight"},l)},s)},splitButtonMenuButtonDisabled:{backgroundColor:h.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:h.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:h.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:h.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:h.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:h.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:h.primaryButtonText},splitButtonMenuIconDisabled:{color:p.neutralTertiary,selectors:(d={},d[o.HighContrastSelector]={color:"GrayText"},d)}}}},254:function(t,e,r){"use strict";var o=r(0),n=r(1),i=r(163),a=r(156),c=r(464),u=r(16),s=r(159),l=r(162),d=r(193),p=r(197),h=Object(s.b)(function(t,e,r){var o=Object(l.a)(t),n=Object(d.a)(t),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:u.FontWeights.semibold}};return Object(u.concatStyleSets)(o,i,r?Object(p.a)(t):Object(p.b)(t),n,e)});r.d(e,"a",function(){return f});var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._skipComponentRefResolution=!0,e}return o.__extends(e,t),e.prototype.render=function(){var t=this.props,e=t.primary,r=void 0!==e&&e,c=t.styles,u=t.theme;return n.createElement(i.a,o.__assign({},this.props,{variantClassName:r?"ms-Button--primary":"ms-Button--default",styles:h(u,c,r),onRenderDescription:a.b}))},e=o.__decorate([Object(c.a)("DefaultButton",["theme","styles"],!0)],e)}(a.a)},2844:function(t,e,r){"use strict";r.d(e,"b",function(){return i}),r.d(e,"a",function(){return a});var o=r(52),n=new o.c(function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(5),r.e(251)]).then(r.bind(null,4250))}),i=new o.a(n,function(t){return t.mountAndShowFlexPane}),a=new o.a(n,function(t){return t.hideFlexPane})},3700:function(t,e,r){"use strict";r.d(e,"b",function(){return ReactEditor}),r.d(e,"a",function(){return i}),r.d(e,"c",function(){return a});var o=r(52),n=new o.c(function(){return Promise.all([r.e(3),r.e(10),r.e(13),r.e(16),r.e(291)]).then(r.bind(null,5881))}),ReactEditor=Object(o.d)(n,function(t){return t.ReactEditor}),i=Object(o.d)(n,function(t){return t.CompositeEditor}),a=new o.b(n,function(t){return t.setTableHeaderRow})},5889:function(t,e,r){"use strict";r.r(e);var o=r(0),n=r(69),i=Object(n.action)("addOrRemoveAccCheckerError")(function(t,e,r){var o=t.errors.indexOf(e);r?o<0&&t.errors.push(e):o>=0&&t.errors.splice(o,1)}),a=r(11985),c=r(5),u=Object(n.action)("resetAccCheckerViewState")(function(t){t.isOpen=!1,t.errors=[]}),s=Object(n.action)("setAccCheckerPaneIsOpen")(function(t,e){t.isOpen=e}),l=r(103),d=r(254),p=r(2844),h=r(1033),f=r(1),b=r(11986),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.setScrollRegionRef=function(t){var r;(null===(r=t)||void 0===r?void 0:r.parentElement)&&(e.scrollRegion=t.parentElement,e.scrollRegion.style.marginTop="10px",e.scrollRegion.style.paddingTop="0px")},e}return Object(o.__extends)(e,t),e.prototype.render=function(){return this.props.viewState?f.createElement("div",{ref:this.setScrollRegionRef},this.renderNoIssuesFoundSection(),this.renderImageAltSection(),this.renderTableHeaderRowSection(),this.renderIssuesFoundSection(),this.renderButtonSection()):null},e.prototype.UNSAFE_componentWillUpdate=function(){this.scrollRegion&&(this.scrollRegion.scrollTop=0)},e.prototype.componentWillUnmount=function(){u(this.props.viewState)},e.prototype.onClose=function(t){this.props.viewState.isOpen&&(t.stopPropagation(),p.a.importAndExecute())},e.prototype.renderNoIssuesFoundSection=function(){return 0==this.props.viewState.errors.length&&f.createElement("div",null,f.createElement("div",{className:b.sectionHeader},Object(c.a)(a.g)),f.createElement("div",{className:b.sectionMessage},Object(c.a)(a.h)))},e.prototype.renderImageAltSection=function(){var t=this.props,e=t.viewState,r=t.fixImageAltText;return e.errors.indexOf(0)>=0&&f.createElement("div",null,f.createElement("div",{className:b.sectionHeader},Object(c.a)(a.c)),f.createElement("div",{className:b.sectionMessage},Object(c.a)(a.d)),f.createElement(d.a,{onClick:r,className:b.accCheckerButton},Object(c.a)(a.b)))},e.prototype.renderTableHeaderRowSection=function(){var t=this.props,e=t.viewState,r=t.fixTableHeaderRow;return e.errors.indexOf(1)>=0&&f.createElement("div",null,f.createElement("div",{className:b.sectionHeader},Object(c.a)(a.j)),f.createElement("div",{className:b.sectionMessage},Object(c.a)(a.k)),f.createElement(d.a,{onClick:r,className:b.accCheckerButton},Object(c.a)(a.b)))},e.prototype.renderIssuesFoundSection=function(){return this.props.viewState.errors.length>0&&f.createElement("div",null,f.createElement("div",{className:b.sectionHeader},Object(c.a)(a.e)),f.createElement("div",{className:b.sectionMessage},Object(c.a)(a.f)))},e.prototype.renderButtonSection=function(){var t=this.props.runChecker;return f.createElement(d.a,{onClick:t,className:b.accCheckerButton},Object(c.a)(a.a))},Object(o.__decorate)([Object(h.c)("escape")],e.prototype,"onClose",null),e=Object(o.__decorate)([l.observer],e)}(f.Component),m=g;function v(t,e,r,n,i){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(o){return s(t,!0),i&&p.b.importAndExecute(f.createElement(g,{viewState:t,runChecker:e,fixImageAltText:r,fixTableHeaderRow:n}),{headerText:function(){return Object(c.a)(a.i)},overlayOnSmallWidth:!1}),[2]})})}var k=r(3700),y=r(2230),C=new RegExp("\\w*\\.\\w+","g"),x="alt",w=function(){function t(t,e){var r=this;void 0===e&&(e=!0),this.adapter=t,this.useFlexPane=e,this.closeChecker=function(){p.a.importAndExecute()},this.openChecker=function(){return Object(o.__awaiter)(r,void 0,void 0,function(){return Object(o.__generator)(this,function(t){switch(t.label){case 0:return this.runChecker(),[4,v(this.adapter(),this.runChecker,this.fixImageAltText,this.fixTableHeaderRow,this.useFlexPane)];case 1:return t.sent(),[2]}})})},this.runChecker=function(){if(r.editor){var t=r.adapter();i(t,0,r.hasImageAltTextErrors()),i(t,1,r.hasTableHeaderRowErrors())}},this.fixImageAltText=function(){return Object(o.__awaiter)(r,void 0,void 0,function(){var t,e,r=this;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return t=this.imagesWithAltTextErrors.pop(),[4,y.f.import()];case 1:e=o.sent(),o.label=2;case 2:return t?[4,e(t,function(e){t.setAttribute(x,e)},function(){r.imagesWithAltTextErrors=[]})]:[3,4];case 3:return o.sent(),t=this.imagesWithAltTextErrors.pop(),[3,2];case 4:return this.runChecker(),[2]}})})},this.fixTableHeaderRow=function(){return Object(o.__awaiter)(r,void 0,void 0,function(){var t;return Object(o.__generator)(this,function(e){switch(e.label){case 0:t=this.tablesWithoutHeaderRows.pop(),e.label=1;case 1:return t?[4,k.c.import()]:[3,3];case 2:return e.sent()(this.editor,t,!1),t=this.tablesWithoutHeaderRows.pop(),[3,1];case 3:return this.runChecker(),[2]}})})},this.imagesWithAltTextErrors=[],this.tablesWithoutHeaderRows=[]}return t.prototype.getName=function(){return"AccChecker"},t.prototype.initialize=function(t){this.editor=t},t.prototype.dispose=function(){var t;(null===(t=this.adapter())||void 0===t?void 0:t.isOpen)&&p.a.importAndExecute(),this.imagesWithAltTextErrors=null,this.tablesWithoutHeaderRows=null},t.prototype.hasImageAltTextErrors=function(){var t=this,e=!1;return this.imagesWithAltTextErrors=[],this.editor.queryElements("img",function(r){var o=r.getAttribute(x);t.hasPresentationRole(r)||(Object(c.g)(o)||null!=o.match(C))&&(e=!0,t.imagesWithAltTextErrors.push(r))}),e},t.prototype.hasTableHeaderRowErrors=function(){var t=this,e=!1;return this.editor.queryElements("table",function(r){var o=r.querySelectorAll("th");t.hasPresentationRole(r)||0==o.length&&(e=!0,t.tablesWithoutHeaderRows.push(r))}),e},t.prototype.hasPresentationRole=function(t){var e=t.getAttribute("role");return e&&"presentation"==e},t}();r.d(e,"AccCheckerPlugin",function(){return w}),r.d(e,"AccCheckerPane",function(){return m})},840:function(t,e,r){"use strict";var o=r(33);function n(t,e){return t?e(t):t}function i(t){return t.replace(/\bctrl\b/,"command")}var a=[function(t){if(Array.isArray(t)){if(t.includes("del"))return t.concat("backspace")}else if(-1!==t.indexOf("del"))return[t,t.replace("del","backspace")];return t},function(t){return Array.isArray(t)?t.map(i):i(t)}];function c(t){return Object(o.j)()?function(t,e){return Array.isArray(t)||"string"==typeof t?e.reduce(function(t,e){return e(t)},t):{hotmail:e.reduce(function(t,e){return n(t,e)},t.hotmail),owa:e.reduce(function(t,e){return n(t,e)},t.owa),gmail:e.reduce(function(t,e){return n(t,e)},t.gmail),yahoo:e.reduce(function(t,e){return n(t,e)},t.yahoo)}}(t,a):t}r.d(e,"a",function(){return c})}},0,[0,1,2,5,251,3,10,13,16,291,65,232]]);
//# sourceMappingURL=owa.AccCheckerPlugin.js.map
self.scriptsLoaded['owa.AccCheckerPlugin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AccCheckerPlugin.js'] = (new Date()).getTime();