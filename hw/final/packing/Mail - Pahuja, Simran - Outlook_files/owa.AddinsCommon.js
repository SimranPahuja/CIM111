self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AddinsCommon.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[115],{1009:function(t,e,n){"use strict";n.d(e,"a",function(){return c}),n.d(e,"b",function(){return a});var r=n(974);function c(t){return o(t.type)}function a(t){return o(Object(r.a)(t))}function o(t){return 1===t||3===t}},3776:function(t,e,n){"use strict";n.r(e);var r,c=n(799),a=n(1009),o="FileAttachment:#Exchange",u="ItemAttachment:#Exchange",i="ReferenceAttachment:#Exchange";function d(t){var e=[];return t&&(t.inlineAttachments&&t.inlineAttachments.forEach(function(t){var n=l(t);e.push(n)}),t.docViewAttachments&&t.docViewAttachments.forEach(function(t){var n=l(t);e.push(n)}),t.imageViewAttachments&&t.imageViewAttachments.forEach(function(t){var n=l(t);e.push(n)})),e}function s(t){switch(t){case o:return r.File;case u:return r.Item;case i:return r.Cloud;default:throw new Error("Invalid type of attachment "+t)}}function l(t){var e,n=void 0,r=Object(c.a)(t.attachmentId);if(null===(e=r)||void 0===e?void 0:e.model){Object(a.b)(r.model)&&(n=r.model.AttachLongPathName);var o={id:t.attachmentId.Id,name:r.model.Name,contentType:r.model.ContentType,size:r.model.Size,attachmentType:s(r.model.__type),isInline:r.model.IsInline,url:n}}return o}!function(t){t[t.File=0]="File",t[t.Item=1]="Item",t[t.Cloud=2]="Cloud"}(r||(r={}));var m,f=n(0),h=n(2213),E=n(806),I=n(160),A="IPM.Note";function T(t,e){return Object(f.__awaiter)(this,void 0,void 0,function(){var e,n,r,a,o,u,i,d,s,l;return Object(f.__generator)(this,function(f){switch(f.label){case 0:return e=null,n=null,null,r=null,a={content:"",format:m.Base64},o=Object(c.a)(t.attachmentId),[4,h.c.importAndExecute(o.model.__type)];case 1:return(u=f.sent())!==E.k.Item?[3,4]:(e=o.download.url,[4,fetch(e)]);case 2:return[4,f.sent().text()];case 3:return r=f.sent(),i=o.model.EmbeddedItemClass||A,a.format="IPM.Note"===i?m.Eml:m.Ical,a.content=r,[3,9];case 4:return u!==E.k.Cloud?[3,5]:(e=o.download.url,d=new URLSearchParams(e),s=d.get("location"),l=decodeURIComponent(s),a.format=m.Url,a.content=l,[3,9]);case 5:return u!==E.k.File?[3,8]:(e=o.download.url+"&asDataUri=true",[4,fetch(e)]);case 6:return[4,f.sent().text()];case 7:return r=f.sent(),n=r.substr(r.indexOf(",")+1),n=(T=n)?T.replace(/\s+/g,""):T,a.format=m.Base64,a.content=n,[3,9];case 8:Object(I.a)(u),f.label=9;case 9:return[2,a]}var T})})}!function(t){t.Base64="base64",t.Eml="eml",t.Url="url",t.Ical="iCalendar"}(m||(m={})),n.d(e,"getAllAttachments",function(){return d}),n.d(e,"getAttachmentContentHelper",function(){return T}),n.d(e,"getTypeOfAttachment",function(){return s})},813:function(t,e,n){"use strict";n.d(e,"e",function(){return r}),n.d(e,"g",function(){return c}),n.d(e,"h",function(){return a}),n.d(e,"n",function(){return o}),n.d(e,"i",function(){return u}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return d}),n.d(e,"d",function(){return s}),n.d(e,"f",function(){return l}),n.d(e,"j",function(){return m}),n.d(e,"k",function(){return f}),n.d(e,"l",function(){return h}),n.d(e,"m",function(){return E}),n.d(e,"o",function(){return I}),n.d(e,"p",function(){return A}),n.d(e,"q",function(){return T}),n.d(e,"a",function(){return _});var r="FileAttachment:#Exchange",c="ItemAttachment:#Exchange",a="ItemIdAttachment:#Exchange",o="ReferenceAttachment:#Exchange",u="LinkAttachment:#Exchange",i="Box",d="Dropbox",s="Facebook",l="GDrive",m="Mailbox",f="MailMessage",h="OneDriveConsumer",E="OneDrivePro",I="WopiBox",A="WopiDropbox",T="WopiEgnyte",_={providers:{BOX:i,DROPBOX:d,FACEBOOK:s,GDRIVE:l,MAILBOX:m,ONE_DRIVE_CONSUMER:h,ONE_DRIVE_PRO:E,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:I,WOPI_EGNYTE:T},attachmentTypes:{FILE_ATTACHMENT_TYPE:r,ITEM_ATTACHMENT_TYPE:c,ITEM_ID_ATTACHMENT_TYPE:a,REFERENCE_ATTACHMENT_TYPE:o,LINK_ATTACHMENT_TYPE:u}}},974:function(t,e,n){"use strict";var r=function(t){return t&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(t)},c=n(5),a=n(813);function o(t){switch(t.__type){case a.e:return 0;case a.n:return t.IsLink?3:1;case a.i:return 3;case a.g:return 2;case a.h:var e=t;return r(t.EmbeddedItemClass)||Object(c.g)(e.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+t.__type)}}n.d(e,"a",function(){return o})}}]);
//# sourceMappingURL=owa.AddinsCommon.js.map
self.scriptsLoaded['owa.AddinsCommon.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AddinsCommon.js'] = (new Date()).getTime();