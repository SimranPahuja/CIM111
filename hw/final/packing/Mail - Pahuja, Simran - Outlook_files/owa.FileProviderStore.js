self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FileProviderStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[243,25],{1052:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(34),o=n(50);function i(){var e=Object(r.getCookie)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.getCookie)(t)}function a(){var e="",t=Object(o.a)().pathname.split("/").filter(function(e){return e.length});return t.length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e}function c(){var e=a();return e||(e=i()),e}},1087:function(e){e.exports={a:"yxb"}},1099:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(733);function o(e){return Object(r.a)(e).searchBoxWidth}},1113:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(786);function o(e){switch(e){case r.b.Mail:return"Mail";case r.b.Calendar:return"Calendar";case r.b.FilesHub:return"FilesHub";case r.b.FilesPicker:return"FilesPicker";case r.b.Spaces:return"Spaces";default:throw Error("Unknown SearchScenarioId value!")}}},1165:function(e){e.exports={a:"wzb"}},11915:function(e){e.exports={a:"zza"}},11916:function(e){e.exports={a:"pza"}},11917:function(e){e.exports={b:"qza",a:"rza"}},11919:function(e){e.exports={a:"sza"}},11921:function(e){e.exports={a:"Fza"}},121:function(e,t,n){"use strict";var r=n(336);n.d(t,"a",function(){return r.a})},1210:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var r=n(981),o=n.n(r),i=n(982),a=n.n(i),c=n(1015),u=n.n(c),s=n(743),d=n.n(s),l=n(191),f=n(801);function b(e){var t=e,n=function(e){return a()({FolderShape:u()({BaseShape:"IdOnly",AdditionalProperties:[d()({FieldURI:"DistinguishedFolderId"}),d()({FieldURI:"FolderClass"}),d()({FieldURI:"FolderDisplayName"}),d()({FieldURI:"ParentFolderId"}),d()({FieldURI:"TotalCount"}),d()({FieldURI:"UnreadCount"})]}),Paging:null,ParentFolderIds:[e],ReturnParentFolder:!0,ShapeName:"Folder",Traversal:"Deep"})}(t);return o()({Header:Object(l.getJsonRequestHeader)(),Body:n},Object(f.a)(t.Id)).then(function(e){return e.Body.ResponseMessages.Items[0]})}},1211:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1052),o=n(40);function i(){var e=Object(r.c)();return e||Object(o.a)().SessionSettings.UserEmailAddress}},1241:function(e){e.exports={a:"xzb"}},1269:function(e,t,n){"use strict";var r=n(733),o=n(4);t.a=Object(o.mutatorAction)("setNextSearchQueryId",function(e,t){Object(r.a)(t).nextSearchQueryId=e})},1401:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1087),o=n(5),i=n(950);function a(e,t){var n=t||Object(o.a)(r.a),a=n;return Object(i.a)(e)||(a=""),{ariaLabel:n,placeholder:a}}},1402:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(733);function o(e){return!!Object(r.a)(e).suggestionPills.size}},14138:function(e,t,n){"use strict";n.r(t);var r=n(1292),o=n(4),i=Object(o.action)("ADD",function(e){return{providerViewState:e}}),a=Object(o.action)("LOAD",function(e){return{providers:e}}),c=Object(o.action)("REMOVE",function(e){return{providerType:e}}),u=Object(o.action)("ADD_TO_REMOVING",function(e){return{providerType:e}}),s=Object(o.action)("SET_LOAD_STATE",function(e){return{loadState:e}});function d(e){Object(r.a)().providers.set(e.viewType.toString(),e)}Object(o.mutator)(i,function(e){return d(e.providerViewState)}),Object(o.mutator)(u,function(e){return Object(r.a)().removalPending.set(e.providerType.toString(),"")}),Object(o.mutator)(c,function(e){Object(r.a)().providers.delete(e.providerType.toString()),Object(r.a)().removalPending.delete(e.providerType.toString())}),Object(o.mutator)(a,function(e){return e.providers.forEach(d)}),Object(o.mutator)(s,function(e){Object(r.a)().loadState=e.loadState});var l=n(0),f=n(11915),b=n(2405),h=n(5),p=n(1788),O=n(2471),m=Object(o.action)("ADD_FILE_PROVIDER",function(e,t,n){return{providerType:e,getAddableFileProviderInfoCustom:t,updateProvider:n}}),S=Object(o.action)("LOAD_PROVIDERS",function(e,t){return{onLoaded:e,onError:t}}),g=Object(o.action)("REMOVE_AND_ADD_FILE_PROVIDER",function(e){return{providerType:e}}),_=Object(o.action)("REMOVE_FILE_PROVIDER",function(e){return{providerType:e}}),I=n(772),v=n(1510);function j(e){if(v.c.indexOf(e.Type)<-1)return null;var t=e.Type;try{var n=5===t?e.Scopes.filter(function(e){return"Photos"!==e.DisplayName}):e.Scopes;return{name:e.DisplayName,providerAccountIdentifier:e.AssociatedDataProviderAccountId||"",isPrimaryProvider:!e.IsThirdPartyProvider,type:t,allowFolderSharing:e.AllowFolderSharing,model:e,scopes:n||[],viewType:t,associatedWithPrimaryProvider:!1,usesGroupsViewAtTopLevel:!1}}catch(e){return null}}var x=n(1327),T=n(151),E=n(62),w=n(5006);function y(e,t,n){return Object(l.__awaiter)(this,void 0,void 0,function(){var r,o;return Object(l.__generator)(this,function(a){switch(a.label){case 0:if(!Object(O.b)(e))throw new Error(O.a);a.label=1;case 1:return a.trys.push([1,3,,4]),[4,P(e,t,n)];case 2:return r=a.sent(),[3,4];case 3:return function(e,t){throw E.d.warn("Error in adding file provider "+e.toString()),n=Object(p.a)(t),Object(I.b)(Object(h.a)(b.a),Object(h.b)(Object(h.a)(f.a),n),!1,{hideCancelButton:!0}),e;var n}(a.sent(),e),[2];case 4:return o=j(r),i(o),Object(x.a)(o),[2]}})})}function P(e,t,n){return Object(T.m)("FPAddDataProviderAuthWindowOpened",[e]),new Promise(function(r,o){var i,a,c,u,s,d,l=(t=t||w.b)(e).getAuthUrlInfo(),f=l.authUrl,b={info:{redirectUrl:l.redirectUrl,csrfToken:l.csrfToken,updateProvider:n},onProviderAdded:function(e){return r(e)},onErrorAddingProvider:function(e){return o(e)},getAddableFileProviderInfo:t};Object(w.a)(e),Object(w.c)(e,b),i=f,a=600,c=600,u=(window.screen.width-a)/2,s=(window.screen.height-c)/2,d="width="+a+", height="+c+", top="+s+", left="+u+", menubar=no, toolbar=no",window.open(i,"_blank",d)})}Object(o.orchestrator)(m,function(e){y(e.providerType,e.getAddableFileProviderInfoCustom,e.updateProvider)});var F=n(11916),C=n(11917),D=n(3407),A=n(1417),R=n(8840),N=n.n(R),k=n(11918),B=n.n(k);function L(e){return Object(l.__awaiter)(this,void 0,void 0,function(){var t;return Object(l.__generator)(this,function(n){switch(n.label){case 0:return(t=Object(A.a)(e.toString()))&&Object(O.b)(e)?[4,(r=t.model.Id,o=N()({DataProviderId:r}),B()(o))]:(M("Unable to remove the provider as the provider does not exist in the store or is not addable.",e),Object(T.m)("FPRemoveFileProvider",{message:"Provider does not exist in the store or is not addable.",fileProviderType:e.toString()}),[2]);case 1:return n.sent().RemovedSuccessfuly?(c(e),Object(x.b)(e),Object(D.b)(t.type),Object(T.m)("FPRemoveFileProvider",{message:"Successfully removed file provider",fileProviderType:e.toString()})):(M("Unable to remove the provider",t.type),Object(T.m)("FPRemoveFileProvider",{message:"Unable to remove the provider",fileProviderType:e.toString()})),[2]}var r,o})})}function M(e,t){var n;E.d.warn("Error in removing file provider "+e),n=Object(p.a)(t),Object(I.b)(Object(h.a)(C.b),Object(h.b)(Object(h.a)(C.a),n),!1,{hideCancelButton:!0})}function U(e){return Object(I.b)(Object(h.a)(b.a),Object(h.b)(Object(h.a)(F.a),e),!1)}Object(o.orchestrator)(_,function(e){L(e.providerType)}),Object(o.orchestrator)(g,function(e){!function(e){Object(l.__awaiter)(this,void 0,void 0,function(){var t;return Object(l.__generator)(this,function(n){switch(n.label){case 0:t=Object(p.a)(e),n.label=1;case 1:return n.trys.push([1,6,,7]),[4,L(e)];case 2:return n.sent(),[4,U(t)];case 3:return n.sent()!==I.a.ok?[3,5]:[4,y(e)];case 4:n.sent(),n.label=5;case 5:return[3,7];case 6:return n.sent(),[3,7];case 7:return[2]}})})}(e.providerType)});var H=n(11919),G=n(1769),z=n(11920),V=n.n(z),q=n(8841),X=n.n(q);function Q(e){void 0===e&&(e=0);var t=X()({ClientVersion:2,RequestOrigin:e});return V()(t)}var Y=n(1603),W=n(11921),J=n(65);var Z=n(2406),K=n(245);Object(o.orchestrator)(S,function(e){!function(e,t){var n,r;Object(l.__awaiter)(this,void 0,void 0,function(){var o,i,c,u,d;return Object(l.__generator)(this,function(f){switch(f.label){case 0:if(Object(G.a)()!==Y.a.NotLoaded)return[3,5];s(Y.a.Loading),o=void 0,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,Q()];case 2:return o=f.sent(),[3,4];case 3:return i=f.sent(),s(Y.a.NotLoaded),null===(n=t)||void 0===n||n(i),[2];case 4:O={__type:"MailMessage",DisplayName:Object(h.a)(W.a),AriaLabel:Object(h.a)(W.a)},c={__type:"MailMessageAttachmentDataProvider",Id:"MailMessage",Type:10,DisplayName:Object(h.a)(b.b),AssociatedDataProviderAccountId:null,Scopes:[O],DefaultScopeIndex:0,AllowFolderSharing:!1,DefaultPermissionType:6,IsSearchSupported:Object(J.f)("doc-filePicker-mailMessageSearch"),IsThirdPartyProvider:!1},o.push(c),u=o.filter(function(e){return v.c.indexOf(e.Type)>-1&&Object(Z.a)(e.Type)}),Object(J.f)("doc-filePicker-oneDriveProRecentFiles")||function(e){var t=Object(l.__read)(e.filter(function(e){return 0===e.Type}),1)[0];if(t){var n=Object(l.__read)(t.Scopes.filter(function(e){return 4===e.Type}),1),r=n[0];if(r){var o=t.Scopes.indexOf(r);!function(e,t){if(t<0||t>=e.Scopes.length)throw new Error("Invalid scope index "+t+" for the provider "+e.Id);e.Scopes.splice(t,1),e.DefaultScopeIndex===t&&(e.DefaultScopeIndex=0)}(t,o)}}}(u),(d=function(e){return e.map(j).filter(function(e){return null!==e})}(u))&&!Object(K.a)()&&d.splice(0,0,(p=d[0],Object(l.__assign)(Object(l.__assign)({},p),{scopes:[{__type:"OneDriveProScope:#Exchange",Type:3,DisplayName:""}],isPrimaryProvider:!1,viewType:v.b.Groups,name:Object(h.a)(H.a),associatedWithPrimaryProvider:!0,usesGroupsViewAtTopLevel:!0}))),a(d),s(Y.a.Loaded),null===(r=e)||void 0===r||r(d),Object(x.c)(d),f.label=5;case 5:return[2]}var p,O})})}(e.onLoaded,e.onError)}),n.d(t,"removeFileProvider",function(){return _}),n.d(t,"removeAndAddFileProvider",function(){return g}),n.d(t,"loadProviders",function(){return S}),n.d(t,"addFileProvider",function(){return m})},1436:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r={};function o(e){return r[e]}function i(e,t){r[e]=t}},1468:function(e){e.exports={b:"zxb",a:"Axb"}},1469:function(e,t,n){var r=n(1470),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1470:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'.DqR_QI9wxI9eR6VFTBDcQ{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 30px;flex:1 1 30px;position:relative}html[dir] .DqR_QI9wxI9eR6VFTBDcQ{padding-bottom:2px}._1Qs0_GHrFMawJzYAmLNL2x,._1Ni7eAfyUBqk15RoZliWfC{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;font-weight:400;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;width:100%}html[dir] ._1Qs0_GHrFMawJzYAmLNL2x,html[dir] ._1Ni7eAfyUBqk15RoZliWfC{background:transparent;border:0}._1Qs0_GHrFMawJzYAmLNL2x::-ms-clear,._1Ni7eAfyUBqk15RoZliWfC::-ms-clear{display:none}._1dMfnPdablqcwDvVlOI1Ai::-webkit-input-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai::-moz-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai:-ms-input-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai:-moz-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1LtnCG5oLbhQOwtufJyBi8::-webkit-input-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8::-moz-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8:-ms-input-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8:-moz-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1Qs0_GHrFMawJzYAmLNL2x{color:"[theme:black, default:#000000]";z-index:1}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0::-webkit-input-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0::-moz-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0:-ms-input-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0:-moz-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}',""]),t.locals={searchBoxInputContainer:"DqR_QI9wxI9eR6VFTBDcQ",searchBoxInput:"_1Qs0_GHrFMawJzYAmLNL2x",searchBoxInputBase:"_1Ni7eAfyUBqk15RoZliWfC",inputPlaceholder:"_1dMfnPdablqcwDvVlOI1Ai",inSearchinputPlaceholder:"_1LtnCG5oLbhQOwtufJyBi8",isDisabled:"_28FTnx_o_MRIbFoSOl9_0"}},1471:function(e,t,n){var r=n(1472),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1472:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._33tO85F3n_fu7qMMmS4oN3{color:inherit;font:inherit;cursor:pointer;outline:inherit;color:"[theme:headerSearchButtonIcon, default:#FFFFFF]"!important;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;width:32px}html[dir] ._33tO85F3n_fu7qMMmS4oN3{background:none;border:none;padding-bottom:0;padding-top:0;background:"[theme:headerSearchButtonBackground, default:#0078D4]"}._33tO85F3n_fu7qMMmS4oN3:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._33tO85F3n_fu7qMMmS4oN3:hover{background:"[theme:headerSearchButtonBackgroundHover, default:#004578]"}._2s2g07d_g4rYONa6EUffoe{font-size:16px;min-width:32px!important;width:32px!important;color:"[theme:neutralDark, default:#212121]"}html[dir] ._2s2g07d_g4rYONa6EUffoe{padding:0;border-style:none;background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._2s2g07d_g4rYONa6EUffoe:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._2s2g07d_g4rYONa6EUffoe:active{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._2gHlig06CLXTog_sHdBjxU{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-sizing:border-box;box-sizing:border-box;height:16px;width:16px;color:"[theme:neutralDark, default:#212121]"}html[dir] ._2gHlig06CLXTog_sHdBjxU{border-radius:50%;padding:3px;background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir=ltr] ._2gHlig06CLXTog_sHdBjxU{margin-right:16px}html[dir=rtl] ._2gHlig06CLXTog_sHdBjxU{margin-left:16px}html[dir] ._2gHlig06CLXTog_sHdBjxU:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._2gHlig06CLXTog_sHdBjxU:active{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._12DoG-LvHF0uq_P3mCl9l1{color:"[theme:themePrimary, default:#0078D4]";-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;width:44px}html[dir] ._12DoG-LvHF0uq_P3mCl9l1{background-color:transparent}._12DoG-LvHF0uq_P3mCl9l1:hover{color:"[theme:themeDarker, default:#004578]"}._3WHacxy3jm55FX7LXtoTbT,._3OXD24zi--NRNzhEiiUbDf,._1pJKwDVgnVvtTYbSPBYHUf{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"[theme:headerSearchBoxIcon, default:#004578]";-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px}._2ItmDfaS1i9SxH_w5mCuKy._3OXD24zi--NRNzhEiiUbDf,._2ItmDfaS1i9SxH_w5mCuKy._1pJKwDVgnVvtTYbSPBYHUf,._3WHacxy3jm55FX7LXtoTbT._2ItmDfaS1i9SxH_w5mCuKy{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1pJKwDVgnVvtTYbSPBYHUf{color:"[theme:themeDarker, default:#004578]"}._3OXD24zi--NRNzhEiiUbDf{color:"[theme:neutralDark, default:#212121]"}._3w0I3IfXZt11NrlI4Rtops{display:-webkit-box;display:-ms-flexbox;display:flex;height:32px;-ms-flex-item-align:center;align-self:center}html[dir=ltr] ._3w0I3IfXZt11NrlI4Rtops{margin-right:16px}html[dir=rtl] ._3w0I3IfXZt11NrlI4Rtops{margin-left:16px}._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH{height:48px;position:fixed;width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:3}html[dir] ._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH{background:"[theme:headerBackgroundSearch, default:#005A9E]"}html[dir=ltr] ._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH,html[dir=rtl] ._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH{left:0;right:0}._1IASxdr5glbGM5ZXvqT4EN{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-item-align:center;align-self:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;height:32px;width:100%}html[dir] ._1IASxdr5glbGM5ZXvqT4EN{border-radius:2px}@media screen and (-ms-high-contrast:active){html[dir] ._1IASxdr5glbGM5ZXvqT4EN{border:1px solid "[theme:neutralLight, default:#eaeaea]"}}._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;height:48px}html[dir] ._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){border:none;border-radius:0}html[dir=ltr] ._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){margin-right:0}html[dir=rtl] ._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){margin-left:0}._1B1INwx9bCktow-2kkawjV{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir] ._1B1INwx9bCktow-2kkawjV._39PnMB35_a5dhoEn1ZSYaH{margin:0 8px}html[dir] ._5qNpXCd-7jY8_77B7v2Nm ._3pB3B8SOyfUABGIvVa4Yof{background:"[theme:white, default:#ffffff]"}._3pB3B8SOyfUABGIvVa4Yof{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;height:100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}html[dir] ._3pB3B8SOyfUABGIvVa4Yof{background:"[theme:headerSearchBoxBackground, default:rgba(255,255,255,.7)]"}html[dir] ._3pB3B8SOyfUABGIvVa4Yof._2ItmDfaS1i9SxH_w5mCuKy{background:"[theme:neutralLight, default:#eaeaea]"}._5j-xjOS68WJ1zbIJWTFG7{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;-ms-flex-pack:distribute;justify-content:space-around}html[dir=ltr] ._5j-xjOS68WJ1zbIJWTFG7{margin-right:12px}html[dir=rtl] ._5j-xjOS68WJ1zbIJWTFG7{margin-left:12px}',""]),t.locals={searchButton:"_33tO85F3n_fu7qMMmS4oN3",searchBoxButton:"_2s2g07d_g4rYONa6EUffoe",clearBoxButton:"_2gHlig06CLXTog_sHdBjxU",backButton:"_12DoG-LvHF0uq_P3mCl9l1",searchIcon:"_3WHacxy3jm55FX7LXtoTbT",searchIconFocused:"_3OXD24zi--NRNzhEiiUbDf",searchIconRest:"_1pJKwDVgnVvtTYbSPBYHUf",isDisabled:"_2ItmDfaS1i9SxH_w5mCuKy",searchBoxCommonContainer:"_3w0I3IfXZt11NrlI4Rtops",searchBoxContainerInSearch:"_5qNpXCd-7jY8_77B7v2Nm",isInCompactMode:"_39PnMB35_a5dhoEn1ZSYaH",searchBoxContainer:"_1IASxdr5glbGM5ZXvqT4EN",searchBoxColumnContainer:"_1B1INwx9bCktow-2kkawjV",searchBox:"_3pB3B8SOyfUABGIvVa4Yof",searchQueryContainer:"_5j-xjOS68WJ1zbIJWTFG7"}},2046:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(4),o=Object(r.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",function(e,t){return{jsEndToEndTime:e,jsRenderingTime:t}})},2100:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r="undefined"!=typeof window&&window.hasOwnProperty("Performance")&&Performance.prototype.getEntriesByName;function o(e){var t,n,o,i;t=e+" - start",r&&(null===(i=null===(n=performance)||void 0===n?void 0:(o=n).mark)||void 0===i||i.call(o,t))}function i(e){var t,n,o,i,a,c;if(r){try{null===(o=null===(t=performance)||void 0===t?void 0:(n=t).measure)||void 0===o||o.call(n,e,e+" - start")}catch(e){return}var u=performance&&performance.getEntriesByName(e);return null===(c=null===(i=performance)||void 0===i?void 0:(a=i).clearMarks)||void 0===c||c.call(a,e+" - start"),u&&u.length>0?u.slice(-1)[0]:void 0}}},2370:function(e,t,n){"use strict";n(151),n(2100);var r=n(2046),o=n(52),i=new o.c(function(){return Promise.all([n.e(9),n.e(11),n.e(30),n.e(39),n.e(447)]).then(n.bind(null,14390))}),a=new o.b(i,function(e){return e.addSearchRequestInstrumentation}),c=new o.b(i,function(e){return e.addResourceTimingEntry}),u=new o.b(i,function(e){return e.searchDiagnostics}),s=function(){var e=u.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return a}),n.d(t,"c",function(){return c})},3085:function(e,t,n){"use strict";var r=n(733),o=n(4);t.a=Object(o.mutatorAction)("setCurrentSearchQueryId",function(e,t){Object(r.a)(t).currentSearchQueryId=e})},3271:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r={};function o(e,t){r[e]=t}function i(e){return e in r?r[e]:null}function a(e){r[e]=null}},336:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",function(){return r})},3407:function(e,t,n){"use strict";var r=n(3546),o=n.n(r),i=n(4516),a=n.n(i),c=n(825),u=n.n(c),s=n(4517),d=n.n(s),l=n(3547),f=n.n(l),b=n(0),h=n(62);function p(e,t,n,r){return e?n(e):(h.d.warn(t.statusText),404===t.status?r(4):401===t.status||403===t.status?r(2):r(1))}var O=Object.freeze({SortColumn:2,SortOrder:1}),m="maxResults=1000&fields=nextPageToken,files(id,mimeType,name,size,modifiedTime,thumbnailLink,webViewLink,webContentLink,createdTime,fileExtension)",S="GDriveDataProviderItem:#Exchange",g="FacebookDataProviderItem:#Exchange",_="FileAttachmentDataProviderItem:#Exchange",I="FolderAttachmentDataProviderItem:#Exchange",v="OneDriveProScope:#Exchange",j="OneDriveProItemSkipTokenPagingMetadata:#Client",x=n(988);function T(e,t){return{TotalItemCount:e.length,ResultCode:0,Items:e.map(function(e){return t(e)})}}function E(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}var w="application/vnd.google-apps.folder";function y(e){return{__type:S,Name:e.name,Size:parseInt(e.size),Thumbnail:{Url:e.thumbnailLink},Preview:{Url:e.thumbnailLink+"2"},CreatedTime:e.createdTime,DownloadUrl:e.webContentLink,WebViewLink:e.webViewLink,FileExtension:e.fileExtension,Modified:e.modifiedTime,MimeType:e.mimeType,Location:e.id,Id:e.id,AttachmentProviderId:null,ProviderType:5,Type:e.mimeType===w?1:0}}function P(e){return Object(b.__assign)(Object(b.__assign)({},T(e.files,y)),{NextPageToken:e.nextPageToken})}function F(e){return Object(b.__assign)(Object(b.__assign)({},E(e)),{NextPageToken:null})}function C(e,t){return void 0===t&&(t=!1),Object(b.__awaiter)(this,void 0,void 0,function(){var n,r,o;return Object(b.__generator)(this,function(i){switch(i.label){case 0:return[4,Object(x.m)(e,t)];case 1:return n=i.sent(),r=n.errorResponse,(o=n.result)?[2,p(o,null,P,F)]:[2,p(null,r,P,F)]}})})}var D=n(3085),A=n(1269);function R(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.Name:null}function N(e){return{__type:e.__type,Id:e.ItemId.Id,AttachmentProviderId:null,ProviderType:10,Type:0,Size:e.Size,From:R(e),Subject:e.Subject,ReceivedDate:e.DateTimeSent,MessagePreview:e.Preview,IsRead:e.IsRead}}var k=function(e){return T(e,N)};function B(e,t){return Object(b.__awaiter)(this,void 0,void 0,function(){var n,r,o;return Object(b.__generator)(this,function(i){switch(i.label){case 0:return[4,Object(x.n)(e,t)];case 1:return n=i.sent(),r=n.errorResponse,(o=n.result)?[2,p(o,null,k,E)]:[2,p(null,r,k,E)]}})})}var L=n(319),M=n(191),U=n(776),H=n(2370),G=n(754),z=200;function V(e){return Object(b.__awaiter)(this,void 0,void 0,function(){var t,n,r,o,i,a,c,u,s,d,l,f,O,m;return Object(b.__generator)(this,function(S){switch(S.label){case 0:if(0==e.length)throw new Error("FilePicker - Mail Messages: StartSearch should not be called with an empty search!!");return t=Object(U.p)(U.g.FilesPicker),Object(D.a)(t.nextSearchQueryId,U.g.FilesPicker),Object(A.a)(Object(L.a)(),U.g.FilesPicker),n=Object(M.getJsonRequestHeader)(),r={Cvid:Object(L.a)(),Scenario:{Name:G.a.MailEmailAttachmentPicker},TimeZone:Object(G.w)(n),TextDecorations:"Off",EntityRequests:(g=e,{Field:"Time",SortDirection:"Desc"},_=[{EntityType:"Message",Filter:null,From:0,PropertySet:"ProvenanceOptimized",Provenances:["Exchange"],Query:{QueryString:g},RefiningQueries:null,Size:50,Sort:[{Field:"Time",SortDirection:"Desc"}]}],_)},o=0,i=0,a=new Date,[4,Object(G.U)(r,t.searchSessionGuid)];case 1:return(c=S.sent())&&2==c.length?(u=c[0].status,d=(s=u==z)?null:c[0].statusText,l=function(e,t,n,r,o,i,a){if(!e||2!=e.length)return null;var c=Object(G.d)(e[0],t,n,"SubstrateSearch",r,new Date,o.currentSearchQueryId,new Headers(e[1]),0,G.a.MailEmailAttachmentPicker);return c.ClientJSPreRequestTime=i,c.ClientJSRequestThreadTime=a,Object(U.S)(c.SearchTraceID,U.g.FilesPicker,!1),H.d.import().then(function(e){return e(c)}),G.I.importAndExecute(c.SearchTraceID,c.ClientNetworkTime,c.ClientHttpStatus,new Date),c}(c,e,d,a,t,o,i),s?[4,c[0].json()]:[3,3]):(h.d.warn("3S Response for search mail messages failed"),[2,p(null,m={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},k,E)]);case 2:return f=S.sent(),O=function(e,t){var n,r;if(e&&e.Results&&0!==e.Results.length){var o=[],i=e.Results;try{for(var a=Object(b.__values)(i),c=a.next();!c.done;c=a.next()){var u=c.value,s=Object(G.h)(u.Source,t);s.InstanceKey=u.ReferenceId,o.push(s)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o}return[]}(Object(G.t)(f),r),G.J.importAndExecute(l.SearchTraceID,new Date,G.a.MailEmailAttachmentPicker),[2,p(O,null,k,E)];case 3:return h.d.warn("3S Response for search mail messages failed with "+d),m={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:d,type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},G.H.importAndExecute(l.SearchTraceID,G.a.MailEmailAttachmentPicker),[2,p(null,m,k,E)]}var g,_})})}function q(e,t,n,r,i,c,s){if(void 0===c&&(c=null),5===e)return function(e,t){return void 0===t&&(t=""),Object(b.__awaiter)(this,void 0,void 0,function(){var n;return Object(b.__generator)(this,function(r){return n=m+"&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '"+e+"'",t&&(n=n+" and '"+t+"' in parents"),[2,C(n)]})})}(n,i);if(10===e)return V(n);var l=f()({AttachmentDataProviderId:t,Query:n,Paging:o()({Sort:s||a()(O),FolderId:r,Location:i,RequestedData:u()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:100}),PagingMetadata:c})});return d()({request:l})}var X=n(5),Q=n(151),Y=n(65);function W(e){return null!==e&&e.__type===v}function J(e,t){return 0===e&&t&&W(t)?t.Type:null}function Z(e,t){return Object(b.__awaiter)(this,void 0,void 0,function(){var n,r,o;return Object(b.__generator)(this,function(i){switch(i.label){case 0:n="FPAccessTokenUnavailable",r=[e],i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(x.j)(e,!1,t)];case 2:return o=i.sent(),Object(X.g)(o)?(Object(Q.m)(n,r),[2,!1]):[2,!0];case 3:return i.sent(),Object(Q.m)(n,r),[2,!1];case 4:return[2]}})})}function K(e,t,n){return Object(b.__awaiter)(this,void 0,void 0,function(){var r;return Object(b.__generator)(this,function(o){switch(o.label){case 0:switch(e){case 3:case 2:case 6:return[3,1];case 5:case 10:return[3,4];case 0:return[3,5]}return[3,7];case 1:return(r=Object(Y.f)("doc-filePicker-thirdPartyProviderClientCalls"))?[4,Z(e,null)]:[3,3];case 2:r=o.sent(),o.label=3;case 3:return[2,r];case 4:return[2,!0];case 5:return 0!==J(e,n)?[2,!1]:[4,Z(e,t)];case 6:return[2,o.sent()];case 7:return[2,!1]}})})}function $(e){return e.__type===I||1===e.Type}function ee(e){var t=e.filter($),n=e.filter(function(e){return!$(e)});return t.concat(n)}var te=n(160);function ne(e,t,n){var r,o,i=null,a=null;switch(e){case"asc":i=(r=Object(b.__read)([t,n],2))[0],a=r[1];break;case"desc":i=(o=Object(b.__read)([n,t],2))[0],a=o[1];break;default:Object(te.a)(e)}return i<a?-1:i>a?1:0}function re(e,t,n){switch(t){case 2:e.sort(function(e,t){var r=e.Modified,o=t.Modified,i=r?new Date(r):new Date(0),a=o?new Date(o):new Date(0);return ne(0===n?"asc":"desc",i,a)});break;case 1:e.sort(function(e,t){var r=e.Size||0,o=t.Size||0;return 0===n?r-o:o-r});break;default:e.sort(function(e,t){var r=e.Name.toLowerCase(),o=t.Name.toLowerCase();return ne(0===n?"asc":"desc",r,o)})}}function oe(e){return{__type:Object(x.r)(e)?I:_,Id:e.id,AttachmentProviderId:null,Location:(t=e.path_collection,"/"+(t.entries||[]).map(function(e){return e.name}).join("/")+"/"+e.name),Modified:e.modified_at,ModifiedBy:e.modified_by?e.modified_by.name:null,Name:e.name,ProviderType:3,Size:e.size,Type:Object(x.r)(e)?1:0};var t}var ie=function(e){return T(e,oe)};function ae(e,t,n){return Object(b.__awaiter)(this,void 0,void 0,function(){var r,o,i,a;return Object(b.__generator)(this,function(c){switch(c.label){case 0:return[4,Object(x.g)(e)];case 1:return r=c.sent(),o=r.errorResponse,(i=r.result)?(re((a=p(i,null,ie,E)).Items,t,n),a.Items=ee(a.Items),[2,a]):[2,p(null,o,ie,E)]}})})}function ce(e){return{__type:Object(x.u)(e)?I:_,Id:Object(x.s)(e)?null:e.id,AttachmentProviderId:null,Location:Object(x.s)(e)?"":e.path_lower,Modified:Object(x.t)(e)?e.server_modified:"",Name:e.name,ProviderType:2,Size:Object(x.t)(e)?e.size:0,Type:Object(x.u)(e)?1:0}}var ue=function(e){return T(e,ce)};function se(e,t,n){return Object(b.__awaiter)(this,void 0,void 0,function(){var r,o,i,a;return Object(b.__generator)(this,function(c){switch(c.label){case 0:return[4,Object(x.h)({path:e})];case 1:return r=c.sent(),o=r.errorResponse,(i=r.result)?(re((a=p(i,null,ue,E)).Items,t,n),a.Items=ee(a.Items),[2,a]):[2,p(null,o,ue,E)]}})})}var de=n(4518),le=n.n(de),fe=150,be=200;function he(e){var t,n=(t=e.images,Object(b.__read)(Object(b.__spread)(t).reverse().filter(function(e){return e.width>=be&&e.height>=fe}),1)[0]||t[0]);return le()({Url:n.source,Height:n.height,Width:n.width})}function pe(e){var t=he(e),n=e.images[0],r=le()({Url:n.source,Height:n.height,Width:n.width});return{__type:g,Id:e.id,Name:"Photo "+e.id+".jpg",AttachmentProviderId:null,ProviderType:6,Location:n.source,DownloadUrl:n.source+"&dl=1",Thumbnail:t,Preview:r,From:e.from?e.from.name:null,PlaceName:e.place?e.place.name:null,AlbumName:e.album?e.album.name:null,CreatedTime:e.created_time||null,PostUrl:e.link,Type:0}}var Oe=function(e){return T(e,pe)};function me(e){return e?function(e){switch(e){case 1:return x.b.Uploaded;case 0:return x.b.Tagged;default:return Object(te.a)(e)}}(e.Type):x.b.Tagged}function Se(e){return Object(b.__awaiter)(this,void 0,void 0,function(){var t,n,r,o;return Object(b.__generator)(this,function(i){switch(i.label){case 0:return t=me(e),[4,Object(x.i)(t)];case 1:return n=i.sent(),r=n.errorResponse,(o=n.result)?[2,p(o,null,Oe,E)]:[2,p(null,r,Oe,E)]}})})}function ge(e){return e.file?e.file.mimeType:e.package&&"oneNote"===e.package.type?"application/onenote":null}var _e=n(248);function Ie(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}function ve(e,t,n,r,o,i){var a,c=void 0;if(o)switch(r){case 0:var u=i?i.totalItemsFetched+e.length:e.length;a={skipToken:o,totalItemsFetched:u},c=Object(b.__assign)(Object(b.__assign)({},a),{__type:"OneDriveProItemSkipTokenPagingMetadata:#Client"});break;case 1:throw new Error("We do not support skip token based paging for OneDriveConsumer");default:Object(te.a)(r)}var s=e.length;return o&&c?s=c.totalItemsFetched+1:c&&(s=c.totalItemsFetched),{TotalItemCount:s,ResultCode:0,Items:e.map(function(e){return function(e,t,n,r){var o,i,a,c=Object(b.__read)(e.folder?[I,null,e.folder.childCount,1,0]:[_,ge(e),0,0,e.size],5),u=c[0],s=c[1],d=c[2],l=c[3],f=c[4];return{__type:u,Id:e.id,Name:e.name,Size:f,Thumbnail:{Url:(null===(i=null===(o=e.thumbnails)||void 0===o?void 0:o[0])||void 0===i?void 0:i.medium)?e.thumbnails[0].medium.url:null},Modified:e.lastModifiedDateTime,ModifiedBy:(null===(a=e.lastModifiedBy)||void 0===a?void 0:a.user)?e.lastModifiedBy.user.displayName:null,MimeType:s,Location:e.webDavUrl,ProviderEndpointUrl:t,ChildCount:d,AttachmentProviderId:n,ProviderType:r,Type:l}}(e,t,n,r)}),PagingMetadata:c}}function je(e,t,n,r,o,i,a){return t?p(t,null,function(e){return ve(e,n,r,o,i,a)},Ie):p(null,e,function(e){return ve(e,n,r,o,i,a)},Ie)}function xe(e,t,n,r,o,i){return void 0===i&&(i=null),Object(b.__awaiter)(this,void 0,void 0,function(){var a,c,u,s,d,l,f,h;return Object(b.__generator)(this,function(b){switch(b.label){case 0:return a=Object(_e.parse)(e),c=a.protocol+"//"+a.host,u=i?{maxEntries:i.maxEntries,skipToken:i.metadata?i.metadata.skipToken:null}:null,[4,Object(x.o)(c,0,n,r,o,void 0,u)];case 1:return s=b.sent(),d=s.errorResponse,l=s.result,f=l.items,h=l.skipToken,[2,je(d,f,e,t,0,h,i?i.metadata:null)]}})})}var Te="maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)";function Ee(e,t){var n="modifiedTime";t&&0===t.SortColumn?n="name":t&&1===t.SortColumn&&(n="quotaBytesUsed");var r=t&&0===t.SortOrder?"asc":"desc";return Te+"&orderBy=folder,"+n+" "+r+'&q=mimeType!="application/octet-stream" and trashed=false and "'+(e||"root")+'" in parents'}var we=n(4519),ye=n.n(we),Pe=n(4520),Fe=n.n(Pe),Ce=ye()({Type:0,DisplayName:"Files",AriaLabel:"Files"});function De(e,t,n,r,i,a,c,s,d){var l={AttachmentDataProviderId:e,Paging:o()({Sort:d||O,FolderId:r||"",Location:a||"",ItemsEndpointUrl:i||"",FilterBy:n,RequestedData:u()({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),PagingMetadata:s}),Scope:null==c?Ce:c};return Fe()({request:l})}function Ae(e,t,n,r,o,i,a,c,u,s,d){return void 0===o&&(o=null),void 0===i&&(i=null),void 0===u&&(u=null),void 0===d&&(d=null),Object(b.__awaiter)(this,void 0,void 0,function(){var l,f,p,m,S,g;return Object(b.__generator)(this,function(b){switch(b.label){case 0:return b.trys.push([0,27,,28]),[4,K(e,i,o)];case 1:return l=b.sent(),f=void 0,p=!1,l?5!==e?[3,3]:(p=!0,[4,C(Ee(c,s))]):[3,25];case 2:return f=b.sent(),[3,25];case 3:if(2!==e)return[3,8];m=s?s.SortColumn:O.SortColumn,S=s?s.SortOrder:O.SortOrder,p=!0,b.label=4;case 4:return b.trys.push([4,6,,7]),[4,se(c,m,S)];case 5:return f=b.sent(),[3,7];case 6:return b.sent(),[3,7];case 7:return[3,25];case 8:if(3!==e)return[3,13];m=s?s.SortColumn:O.SortColumn,S=s?s.SortOrder:O.SortOrder,p=!0,b.label=9;case 9:return b.trys.push([9,11,,12]),[4,ae(a,m,S)];case 10:return f=b.sent(),[3,12];case 11:return b.sent(),[3,12];case 12:return[3,25];case 13:if(6!==e)return[3,18];p=!0,b.label=14;case 14:return b.trys.push([14,16,,17]),[4,Se(o)];case 15:return f=b.sent(),[3,17];case 16:return b.sent(),[3,17];case 17:return[3,25];case 18:if(0!==J(e,o))return[3,23];if(u&&!function(e){return e&&e.__type===j}(u))throw new Error("The paging metadata is not of type OneDriveProItemsSkipTokenPagingMetadata");p=!0,b.label=19;case 19:return b.trys.push([19,21,,22]),[4,xe(i,t,s?s.SortColumn:O.SortColumn,s?s.SortOrder:O.SortOrder,a,{metadata:u,maxEntries:100})];case 20:return f=b.sent(),[3,22];case 21:return b.sent(),[3,22];case 22:return[3,25];case 23:return 10!==e?[3,25]:(p=!0,[4,B(a,n)]);case 24:f=b.sent(),b.label=25;case 25:return f&&0===f.ResultCode?(Object(Q.m)("FPgetItemsClientCall",[!0,e]),[2,f]):(p&&Object(Q.m)("FPgetItemsClientCall",[!1,e]),[4,De(t,n,r,a,d,c,o,u,s)]);case 26:return[2,b.sent()];case 27:throw g=b.sent(),h.d.warn("FilePicker: getFileProviderItems got error: "+g.message),g;case 28:return[2]}})})}n.d(t,"g",function(){return q}),n.d(t,"c",function(){return Ae}),n.d(t,"a",function(){return K}),n.d(t,"b",function(){return x.e}),n.d(t,"f",function(){return x.v}),n.d(t,"e",function(){return W}),n.d(t,"d",function(){return ge})},5006:function(e,t,n){"use strict";var r=n(52),o=n(3271);n.d(t,"a",function(){return o.a}),n.d(t,"c",function(){return o.c});var i=n(1388);n.d(t,"b",function(){return i.b});var a=new r.c(function(){return n.e(242).then(n.bind(null,8261))}),c=new r.a(a,function(e){return e.addFileProviderAfterAuthFinished});"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.lazyAddFileProviderAfterAuthFinished=c);new r.b(a,function(e){return e.getAddableFileProviderInfo}),new r.b(a,function(e){return e.addFileProvider}),new r.b(a,function(e){return e.createAddableFileProviderInfo}),new r.b(a,function(e){return e.getAuthRedirectPageUrl})},730:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c}),n.d(t,"e",function(){return u}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"k",function(){return f}),n.d(t,"m",function(){return b}),n.d(t,"n",function(){return h}),n.d(t,"o",function(){return p}),n.d(t,"q",function(){return O}),n.d(t,"p",function(){return m}),n.d(t,"u",function(){return S}),n.d(t,"v",function(){return g}),n.d(t,"x",function(){return _}),n.d(t,"w",function(){return I}),n.d(t,"f",function(){return v}),n.d(t,"l",function(){return j}),n.d(t,"y",function(){return x}),n.d(t,"d",function(){return T}),n.d(t,"t",function(){return E}),n.d(t,"j",function(){return w}),n.d(t,"r",function(){return y}),n.d(t,"s",function(){return P});var r=n(4),o=n(49),i=Object(r.action)("ADD_SUGGESTION_PILL",function(e,t,n){return{suggestionPill:e,suggestionSelected:t,scenarioId:n}}),a=Object(r.action)("CHANGE_SELECTED_SUGGESTION_VIA_KEYBOARD",function(e,t,n){return{indexToSelect:e,suggestionToSelect:t,scenarioId:n}}),c=Object(r.action)("CLEAR_SEARCH_BOX",function(e){return{scenarioId:e}}),u=Object(r.action)("END_SEARCH_CONVERSATION",function(e){return{scenarioId:e}}),s=(Object(r.action)("EXECUTE_COMMAND",function(e){return{scenarioId:e}}),Object(r.action)("EXIT_SEARCH",function(e,t,n){return void 0===n&&(n=!1),{actionSource:e,scenarioId:t,forceExit:n}})),d=Object(r.action)("GET_SUGGESTIONS",function(e){return Object(o.b)({name:"Search_SuggestionsE2E"},{scenarioId:e})}),l=Object(r.action)("ON_SEARCH_TEXT_CHANGED",function(e,t){return{searchText:e,scenarioId:t}}),f=Object(r.action)("SEARCH_BOX_BLURRED",function(e){return{scenarioId:e}}),b=Object(r.action)("SEARCH_SESSION_STARTED",function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}}),h=Object(r.action)("SET_CURRENT_SUGGESTIONS",function(e,t,n){return void 0===n&&(n=null),{suggestionSet:e,scenarioId:t,qfRequestId:n}}),p=Object(r.action)("SET_DISPLAYED_QF_REQUEST_TIME",function(e,t){return{displayedQFRequestTime:e,scenarioId:t}}),O=Object(r.action)("SET_LATEST_TRACE_ID",function(e,t,n){return{latestTraceId:e,scenarioId:t,isQFTraceId:n}}),m=Object(r.action)("SET_IS_SUGGESTIONS_DROPDOWN_VISIBLE",function(e,t){return{isSuggestionsDropdownVisible:e,scenarioId:t}}),S=Object(r.action)("START_SEARCH",function(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=[]),{actionSource:e,scenarioId:t,explicitSearch:n,connectedAccountInfo:r}}),g=Object(r.action)("START_SEARCH_SESSION",function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}}),_=Object(r.action)("SUGGESTION_SELECTED",function(e,t,n,r,o){return{suggestion:e,actionSource:t,scenarioId:n,suggestionSetTraceId:r,index:o}}),I=Object(r.action)("SUGGESTION_SECONDARY_ACTION_SELECTED",function(e,t,n,r,o,i){return{suggestion:e,suggestionIndex:t,actionSource:n,scenarioId:r,suggestionSetTraceId:o,entityActionTakenType:i}}),v=Object(r.action)("END_SEARCH_SESSION",function(e,t){return{scenarioId:e,actionSource:t}}),j=Object(r.action)("SEARCH_SESSION_ENDED",function(e,t,n,r){return{searchSessionGuid:e,scenarioId:t,latestTraceId:n,actionSource:r}}),x=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE",function(e,t){return{isComplete:e,scenarioId:t}}),T=Object(r.action)("DOWNLOAD_FILE_SUGGESTION",function(e,t,n){return{attachmentId:e,attachmentType:t,scenarioId:n}}),E=Object(r.action)("SHARE_FILE_SUGGESTION",function(e,t,n){return{attachmentId:e,attachmentType:t,scenarioId:n}}),w=Object(r.action)("REGISTER_ADDITIONAL_QUICK_ACTIONS",function(e,t){return{scenarioId:e,callback:t}}),y=Object(r.action)("SET_SEARCH_TEXT_FOR_SUGGESTION",function(e,t){return{searchTextForSuggestion:e,scenarioId:t}}),P=Object(r.action)("setShowSearchBoxInCompactMode",function(e,t){return{scenarioId:e,showSearchBoxInCompactMode:t}})},732:function(e,t,n){"use strict";var r=n(52),o=n(751),i=n(4),a=n(777),c=n(828),u=(Object(i.mutator)(a.h,function(e){var t=e.loadingState;Object(c.a)().get(e.mailboxId).loadingState=t}),n(881)),s=(Object(i.mutator)(a.a,function(e){var t=Object(u.a)();-1==t.indexOf(e.principalSMTPAddress)&&t.push(e.principalSMTPAddress)}),n(0)),d=Object(i.action)("PERSONA_SEARCH_FOLDERS_LOADED",function(e,t){return{existingFolders:e,personaOrPdlFavorites:t}}),l=n(746),f=(Object(i.mutator)(d,function(e){e.existingFolders.forEach(function(t){if(t){var n=t.FolderId.Id,r=e.personaOrPdlFavorites.filter(function(e){return e.searchFolderId===n});if(1===r.length){var o=r[0].displayName,i=Object(s.__assign)(Object(s.__assign)({},t),{DisplayName:o});Object(l.a)().set(t.FolderId.Id,i)}}})}),n(40)),b=n(737),h=n(761),p=n(891),O=n(734);function m(){return Object(p.a)(O.i)}function S(){return Object(p.a)(O.d)}var g=n(65),_=n(882),I=n(245),v=["journal","outbox","syncissues"];function j(){var e=Object(I.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(g.f)("notes-folder-view")&&e.push("notes"),e}function x(e){if(!function(e){return e&&"Folder:#Exchange"==e.__type}(e))return!1;if(e.isHidden||v.indexOf(Object(h.a)(e.FolderId.Id))>=0)return!1;var t=Object(f.a)();return"notes"==Object(h.a)(e.FolderId.Id)?t.SegmentationSettings.StickyNotes&&Object(g.f)("cal-stickyNotesFolder"):!("junkemail"==Object(h.a)(e.FolderId.Id)&&!t.SegmentationSettings.JunkEMail)}function T(e){var t=Object(l.a)(),n=Object(b.a)(e);return t.get(n)}function E(e,t){if("sharedFolder"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var n,r=[];switch(e){case"archive":n=S();break;case"sharedFolder":n=Object(_.a)(t);break;default:n=m()}var i=j();"primary"==e&&n.DistinguishedFolderId==m().DistinguishedFolderId&&i.forEach(function(e){var t=T(e);t&&x(t)&&t.ParentFolderId.Id===n.FolderId.Id&&r.push(t.FolderId.Id)});for(var a=function(e){var t,n=[];(null===(t=e)||void 0===t?void 0:t.childFolderIds)&&e.childFolderIds.map(function(e){var t=o.b.folderTable.get(e);t&&x(t)&&n.push(t.FolderId.Id)});return n}(n),c=0;c<a.length;c++)-1==i.indexOf(Object(h.a)(a[c]))&&r.push(a[c]);return r}function w(e,t){var n=Object(l.a)().get(e);return!(!n||n.treeType!==t)}var y=n(747),P=n.n(y),F=n(69);function C(e,t){t.forEach(function(t){e.folderTable.delete(t)})}var D=Object(F.action)("removeFolderFromParentFolder")(function(e,t){if(t.ParentFolderId){var n=e.folderTable.get(t.ParentFolderId.Id).childFolderIds;n.splice(n.indexOf(t.FolderId.Id),1)}});function A(e,t,n){for(var r=t.folderTable.get(n).childFolderIds,o=!1,i=Fe(e).toLowerCase(),a=0;a<r.length&&!o;a++){Fe(t.folderTable.get(r[a])).toLowerCase()>i&&(r.splice(a,0,e.FolderId.Id),o=!0)}o||r.push(e.FolderId.Id)}var R=Object(F.action)("moveFolderToParentFolder")(function(e,t,n){var r,o,i;A(t,e,n),t.ParentFolderId=P()({Id:n}),t.treeType=(r=n,o=null,(i=Object(l.a)().get(r))&&(o=i.treeType),o)}),N=n(829),k=n(742);function B(e,t,n,r){var o=Object(N.a)(n),i=Object(l.a)().get(n).treeType,a=Object(s.__assign)({DisplayName:r,ParentFolderId:o,childFolderIds:[],FolderClass:"IPF.Note",distinguishedFolderId:void 0,UnreadCount:0,TotalCount:0,treeType:i},t);e.folderTable.set(t.FolderId.Id,a),A(a,e,o.Id)}Object(i.mutator)(k.b,function(e){B(e.folderStore,e.folder,e.parentFolderId,e.displayName)}),Object(i.mutator)(k.i,function(e){B(e.folderStore,e.folder,e.parentFolderId,e.displayName)});var L=n(946),M=function(e){return Object(L.b)(e,"0x7018")},U=n(71),H=n(760);function G(e,t,n){var r={id:e,rootFolder:t,loadingState:n};Object(c.a)().set(e,r)}Object(i.mutator)(k.h,function(){var e={DistinguishedFolderId:O.d,DisplayName:Object(U.f)().SessionSettings.ArchiveDisplayName};G(O.d,e,H.a.Uninitialized)}),Object(i.mutator)(a.c,function(e){G(e.principalSMTPAddress,e.folder,H.a.Uninitialized)}),Object(i.mutator)(a.f,function(e){Object(c.a)().delete(e.mailboxId)});var z=n(21);Object(i.mutator)(a.e,function(e){var t=e.rootFolder,n=e.treeType,r=e.principalSMTPAddress,o=e.displayName;G(e.mailboxId,V(t,n,r,o),H.a.Loaded)});function V(e,t,n,r){var i=e.ParentFolder,a=function(e,t){return t===O.j?null:e.DistinguishedFolderId}(i,t),c={},u=c[i.FolderId.Id]=q(i,a,t,n);r&&(u.DisplayName=r);for(var s=[],d=0;d<e.Folders.length;d++){var f=e.Folders[d],b=f.FolderId.Id,h=f.DistinguishedFolderId;X(h,f)&&(c[f.FolderId.Id]=q(f,h,t,n),s.push(b))}return s.forEach(function(e){var t=c[e],n=c[t.ParentFolderId.Id];n&&!t.isHidden&&n.childFolderIds.push(e)}),0==Object(l.a)().size?Object(o.a)().folderTable=new z.ObservableMap(c):Object.keys(c).forEach(function(e){Object(l.a)().set(e,c[e])}),u}function q(e,t,n,r){return Object(s.__assign)({childFolderIds:[],distinguishedFolderId:t,UnreadCount:e.UnreadCount,TotalCount:e.TotalCount,isHidden:Object(L.c)(e),remoteFolderDisplayName:M(e),sourceWellKnownFolderType:Object(L.d)(e),treeType:n,principalSMTPAddress:r},e)}function X(e,t){var n=!!Object(U.f)().SegmentationSettings.JunkEMail;if("junkemail"===e&&!n)return!1;var r=!!Object(U.f)().SegmentationSettings.StickyNotes;return!("notes"===e&&!r)&&("clutter"!==e||0!==t.TotalCount)}Object(i.mutator)(a.d,function(e){V(e.rootFolder,e.treeType,e.principalSMTPAddress)});var Q=n(1241),Y=n(1165),W=n(5),J=n(1266),Z=n.n(J);function K(e,t){return Z()({displayName:e,primarySMTPAddress:t})}var $=n(772),ee=n(62),te=n(151),ne=(Object(i.orchestrator)(k.a,function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,o,i,c;return Object(s.__generator)(this,function(u){switch(u.label){case 0:t=e.displayName,n=e.principalSMTPAddress,r=e.skipServerValidation,o=void 0!==r&&r,u.label=1;case 1:return u.trys.push([1,4,,5]),o?[3,3]:[4,K(t,n)];case 2:if(!u.sent())return[2];u.label=3;case 3:return[3,5];case 4:return i=u.sent(),Object($.b)(Object(W.a)(Y.a),Object(W.a)(Q.a),!1,{hideCancelButton:!0}),ee.d.error("Add shared folder API returned error "+i),[2];case 5:return c={FolderId:{Id:n},isHidden:!1,DisplayName:t,treeType:O.j,principalSMTPAddress:n},Object(a.c)(n,c),Object(a.a)(n),o||Object(te.m)("Triage_SharedFolders_AddFolder"),[2]}})})}),n(1079)),re=n.n(ne),oe=n(324),ie=n.n(oe),ae=n(931),ce=n.n(ae),ue=n(778),se=n.n(ue),de=n(1080),le=n.n(de),fe=n(191),be=n(801);function he(e,t,n){return void 0===n&&(n="IPF.Note"),le()({Header:Object(fe.getJsonRequestHeader)(),Body:re()({ParentFolderId:se()({BaseFolderId:pe(e)}),Folders:[ce()({DisplayName:t,FolderClass:n})]})},Object(be.a)(e)).then(function(e){return e.Body.ResponseMessages.Items[0]})}function pe(e){return"string"==typeof e?P()({Id:e}):ie()({Id:e})}var Oe=n(883);function me(e,t,n){for(var r=("string"==typeof n?e.folderTable.get(n):e.folderTable.get(Object(b.a)(n))).childFolderIds,o=t.toLowerCase(),i=0;i<r.length;i++){var a=r[i],c=e.folderTable.get(a);if(c&&c.DisplayName.toLowerCase()==o)return!0}return!1}function Se(e){var t=[e];return Object(l.a)().get(e).childFolderIds.forEach(function(e){Array.prototype.push.apply(t,Se(e))}),t}function ge(e){var t=Object(l.a)().get(e);return!!t.childFolderIds&&t.childFolderIds.filter(function(e){return x(Object(l.a)().get(e))}).length>0}function _e(e,t){return function e(t,n,r){var o=[];if(0===n){var i=e(t,n+1,r);o.push.apply(o,Object(s.__spread)(i))}else t.forEach(function(t){var i=Object(l.a)().get(t);if(x(i)&&(o.push(Object(s.__assign)(Object(s.__assign)({},i),{depth:n})),ge(t)&&r(t))){var a=e(i.childFolderIds,n+1,r);o.push.apply(o,Object(s.__spread)(a))}});return o}(e,0,t)}var Ie,ve=null;var je=function(e,t){ve.folderTable.set(e.FolderId.Id,e),e.ParentFolderId&&ve.folderTable.get(e.ParentFolderId.Id).childFolderIds.push(e.FolderId.Id),e.distinguishedFolderId&&(Ie[e.distinguishedFolderId]=e.FolderId.Id)};je=Object(F.action)("addFolderToStore-TestMethod")(je);var xe=n(1114),Te=n.n(xe),Ee=n(743),we=n.n(Ee),ye=function(e,t){return Object(Oe.a)(e,[Te()({Path:we()({FieldURI:"FolderDisplayName"}),Folder:ce()({DisplayName:t})})])},Pe=n(878);function Fe(e){return e?Object(f.a)().SessionSettings.IsShadowMailbox&&e.remoteFolderDisplayName?e.remoteFolderDisplayName:e.DisplayName:""}var Ce=n(1210),De=n(958),Ae=n(1211);function Re(){return Object(s.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(s.__generator)(this,function(r){switch(r.label){case 0:return(e=Object(Pe.a)(O.i))==H.a.Loading||e==H.a.Loaded?[2]:(Object(a.h)(O.i,H.a.Loading),t=Object(De.d)(),n=null,t?(n=t.Body.ResponseMessages.Items[0],[3,3]):[3,1]);case 1:return[4,Object(Ce.a)(ie()({Id:O.i}))];case 2:n=r.sent(),r.label=3;case 3:return n&&n.RootFolder&&n.RootFolder.Folders&&n.RootFolder.ParentFolder?(Object(a.e)(n.RootFolder,O.i,O.h,Object(Ae.a)(),Object(f.a)().SessionSettings.UserDisplayName,O.i),function(){var e=Object(l.a)().get(Object(b.a)("inbox")).childFolderIds.length,t=Object(l.a)().get(Object(b.a)("msgfolderroot")).TotalCount;Object(te.m)("TnS_LoadFolders",[e,t]);var n=Object(b.a)("notes"),r=Object(l.a)().get(n);if(null!=n&&null!=r){var o=r.TotalCount,i=r.ChildFolderCount;Object(te.m)("Notes_LoadFolders",{noteCount:o,childFolderCount:i},{isCore:!0})}}(),[2]):(Object(a.h)(O.i,H.a.ErrorLoading),[2])}})})}var Ne=n(781),ke=Object(F.select)({folderTable:function(){return o.b.folderTable}})(function(e,t){return Object(Ne.c)(e,"msgfolderroot",t)});function Be(e){return Object(Ne.a)(o.b.folderTable.get(e),"msgfolderroot")}n(830);var Le=n(892);function Me(){var e=Object(o.a)();return e.sharedFolderUserEmails.map(function(t){return e.mailboxTable.get(t)})}n.d(t,"S",function(){return He}),n.d(t,"U",function(){return Ge}),n.d(t,"W",function(){return ze}),n.d(t,"T",function(){return Ve}),n.d(t,"X",function(){return qe}),n.d(t,"Y",function(){return Xe}),n.d(t,"R",function(){return Qe}),n.d(t,"V",function(){return Ye}),n.d(t,"o",function(){return he}),n.d(t,"gb",function(){return Oe.a}),n.d(t,"r",function(){return me}),n.d(t,"t",function(){return Se}),n.d(t,"x",function(){return _e}),n.d(t,"J",function(){return ge}),n.d(t,"g",function(){return H.a}),n.d(t,"cb",function(){return d}),n.d(t,"q",function(){return C}),n.d(t,"db",function(){return D}),n.d(t,"Z",function(){return R}),n.d(t,"n",function(){return k.b}),n.d(t,"K",function(){return k.h}),n.d(t,"m",function(){return k.a}),n.d(t,"bb",function(){return k.j}),n.d(t,"A",function(){return k.f}),n.d(t,"z",function(){return k.e}),n.d(t,"ib",function(){return k.o}),n.d(t,"hb",function(){return k.m}),n.d(t,"ab",function(){return k.i}),n.d(t,"eb",function(){return ye}),n.d(t,"v",function(){return be.a}),n.d(t,"k",function(){return O.i}),n.d(t,"d",function(){return O.d}),n.d(t,"h",function(){return O.f}),n.d(t,"a",function(){return O.a}),n.d(t,"i",function(){return O.g}),n.d(t,"b",function(){return O.b}),n.d(t,"l",function(){return O.j}),n.d(t,"j",function(){return O.h}),n.d(t,"c",function(){return O.c}),n.d(t,"e",function(){return O.e}),n.d(t,"u",function(){return S}),n.d(t,"G",function(){return m}),n.d(t,"B",function(){return l.a}),n.d(t,"E",function(){return Pe.a}),n.d(t,"I",function(){return u.a}),n.d(t,"H",function(){return _.a}),n.d(t,"w",function(){return Fe}),n.d(t,"F",function(){return Re}),n.d(t,"O",function(){return ke}),n.d(t,"N",function(){return Be}),n.d(t,"Q",function(){return Ne.c}),n.d(t,"M",function(){return Ne.a}),n.d(t,"fb",function(){return x}),n.d(t,"y",function(){return T}),n.d(t,"D",function(){return E}),n.d(t,"L",function(){return w}),n.d(t,"f",function(){return v}),n.d(t,"C",function(){return j}),n.d(t,"P",function(){return Le.b}),n.d(t,"s",function(){return Me});t.p=o.b;var Ue=new r.c(function(){return n.e(123).then(n.bind(null,14096))}),He=new r.b(Ue,function(e){return e.getArchiveFolders}),Ge=new r.b(Ue,function(e){return e.getSharedFolders}),ze=new r.b(Ue,function(e){return e.removeSharedFolderUser}),Ve=new r.b(Ue,function(e){return e.getFolderPermissions}),qe=new r.b(Ue,function(e){return e.updateFolderPermissions}),Xe=new r.b(Ue,function(e){return e.updateFolderPermissionsInStore}),Qe=new r.b(Ue,function(e){return e.arePermissionArraysEqual}),Ye=(new r.b(Ue,function(e){return e.arePermissionsEqual}),new r.a(Ue,function(e){return e.initializeSharedFolderRoots}))},733:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1113),o=n(774);function i(e){return Object(o.b)().scenarioStores.get(Object(r.a)(e))||Object(o.a)()}},734:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"f",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"k",function(){return s}),n.d(t,"j",function(){return d}),n.d(t,"h",function(){return l}),n.d(t,"c",function(){return f}),n.d(t,"e",function(){return b});var r="archivemsgfolderroot",o="msgfolderroot",i="archivedeleteditems",a="deleteditems",c="archiverecoverableitemsdeletions",u="recoverableitemsdeletions",s="msgfolderroot",d="sharedFolderTree",l="primaryFolderTree",f="archiveFolderTree",b="favorites"},742:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"g",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"k",function(){return c}),n.d(t,"h",function(){return u}),n.d(t,"j",function(){return s}),n.d(t,"d",function(){return d}),n.d(t,"f",function(){return l}),n.d(t,"e",function(){return f}),n.d(t,"l",function(){return b}),n.d(t,"n",function(){return h}),n.d(t,"o",function(){return p}),n.d(t,"m",function(){return O}),n.d(t,"b",function(){return m}),n.d(t,"i",function(){return S});var r=n(4),o=Object(r.action)("GET_ARCHIVE_FOLDERS",function(e){return{source:e}}),i=Object(r.action)("GET_SHARED_FOLDERS",function(e,t){return{principalSMTPAddress:e,actionSource:t}}),a=Object(r.action)("ADD_SHARED_FOLDER_USER",function(e,t,n){return{displayName:e,principalSMTPAddress:t,skipServerValidation:n}}),c=Object(r.action)("REMOVE_SHARED_FOLDER_USER",function(e){return{principalSMTPAddress:e}}),u=Object(r.action)("INITIALIZE_ARCHIVE_MAILBOX_FROM_SESSIONDATA"),s=Object(r.action)("ON_SHARED_FOLDER_FETCH_FAILED",function(e,t){return{principalSMTPAddress:e,actionSource:t}}),d=Object(r.action)("GET_FOLDER_PERMISSIONS",function(e){return{folderId:e}}),l=Object(r.action)("GET_FOLDER_PERMISSIONS_SUCCESS"),f=Object(r.action)("GET_FOLDER_PERMISSIONS_FAILED"),b=Object(r.action)("UPDATE_FOLDER_PERMISSIONS",function(e,t){return{folderId:e,permissions:t}}),h=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_IN_STORE",function(e,t){return{folderId:e,permissions:t}}),p=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_SUCCESS"),O=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_FAILED"),m=Object(r.action)("ADD_NEW_FOLDER_TO_STORE",function(e,t,n,r){return{folderStore:e,folder:t,parentFolderId:n,displayName:r}}),S=Object(r.action)("ON_CREATE_NEW_FOLDER_INBOX_RULES_RESPONSE",function(e,t,n,r){return{folderStore:e,folder:t,parentFolderId:n,displayName:r}})},746:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(751);function o(){return Object(r.a)().folderTable}},751:function(e,t,n){"use strict";n.d(t,"b",function(){return s});var r,o=n(4),i=n(21),a=n(760),c=n(734),u=Object(o.createStore)("folderStore",{folderTable:new i.ObservableMap,mailboxTable:new i.ObservableMap((r={},r[c.i]={id:c.i,rootFolder:null,loadingState:a.a.Uninitialized},r)),sharedFolderUserEmails:[]}),s=u();t.a=u},757:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"e",function(){return s}),n.d(t,"f",function(){return d}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"i",function(){return b}),n.d(t,"j",function(){return h}),n.d(t,"k",function(){return p}),n.d(t,"n",function(){return O}),n.d(t,"o",function(){return m}),n.d(t,"p",function(){return S}),n.d(t,"q",function(){return g}),n.d(t,"r",function(){return _}),n.d(t,"s",function(){return I}),n.d(t,"t",function(){return v}),n.d(t,"u",function(){return j}),n.d(t,"v",function(){return x}),n.d(t,"w",function(){return T}),n.d(t,"l",function(){return E}),n.d(t,"m",function(){return w});var r=n(4),o=n(49),i=Object(r.action)("ADD_SUGGESTION_PILL_INTERNAL",function(e,t){return{suggestionPill:e,scenarioId:t}}),a=Object(r.action)("INITIALIZE_SCENARIO_STORE",function(e,t){return{scenarioId:e,isUsing3S:t}}),c=Object(r.action)("ON_BACKSPACE_PRESSED_SEARCH_INPUT",function(e,t){return{cursorPosition:e,scenarioId:t}}),u=Object(r.action)("ON_DOWN_ARROW_PRESSED_SEARCH_INPUT",function(e){return{scenarioId:e}}),s=Object(r.action)("ON_ENTER_PRESSED_SEARCH_INPUT",function(e,t){return{selectedSuggestionIndex:e,scenarioId:t}}),d=Object(r.action)("ON_ESCAPE_PRESSED_SEARCH_INPUT",function(e){return{scenarioId:e}}),l=Object(r.action)("ON_KEY_DOWN_SEARCH_INPUT",function(e,t){return{evtKeyCode:e,scenarioId:t}}),f=Object(r.action)("ON_LEFT_ARROW_PRESSED_SEARCH_INPUT",function(e,t){return{cursorPosition:e,scenarioId:t}}),b=Object(r.action)("ON_RESIZE_SUGGESTIONSCALLOUT",function(e,t){return{searchBoxWidth:e,scenarioId:t}}),h=Object(r.action)("ON_Right_ARROW_PRESSED_SEARCH_INPUT",function(e){return{scenarioId:e}}),p=Object(r.action)("ON_SEARCH_INPUT_FOCUSED",function(e){return Object(o.b)({name:"ON_SEARCH_INPUT_FOCUSED"},{scenarioId:e})}),O=Object(r.action)("ON_UP_ARROW_PRESSED_SEARCH_INPUT",function(e){return{scenarioId:e}}),m=(Object(r.action)("REMOVE_PARAMETER_PILL_FROM_STORE",function(e){return{scenarioId:e}}),Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_SEARCHBOX",function(e,t,n){return{suggestionPillId:e,scenarioId:t,actionSource:n}})),S=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_STORE",function(e,t,n){return{suggestionPillId:e,suggestionPillIndex:t,scenarioId:n}}),g=Object(r.action)("RESET_SEARCH_STORE",function(e){return{scenarioId:e}}),_=Object(r.action)("SET_SEARCH_TEXT",function(e,t){return{searchText:e,scenarioId:t}}),I=Object(r.action)("SET_SELECTED_PILL_INDEX",function(e,t){return{selectedPillIndex:e,scenarioId:t}}),v=Object(r.action)("SET_SELECTED_SUGGESTION_INDEX",function(e,t){return{selectedSuggestionIndex:e,scenarioId:t}}),j=Object(r.action)("SET_SUGGESTION_PILL_IDS",function(e,t){return{suggestionPillIds:e,scenarioId:t}}),x=Object(r.action)("SET_SUGGESTION_PILLS",function(e,t){return{suggestionPills:e,scenarioId:t}}),T=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE_INTERNAL",function(e,t){return{isComplete:e,scenarioId:t}}),E=Object(r.action)("ON_SUGGESTIONS_CALLOUT_POSITIONED",function(e){return{scenarioId:e}}),w=Object(r.action)("ON_SUGGESTIONS_CALLOUT_WILL_UNMOUNT",function(e){return{scenarioId:e}})},760:function(e,t,n){"use strict";var r;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(r||(r={})),t.a=r},761:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(97);function o(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},765:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return c}),n.d(t,"i",function(){return u}),n.d(t,"m",function(){return s}),n.d(t,"n",function(){return d}),n.d(t,"o",function(){return l}),n.d(t,"p",function(){return f}),n.d(t,"q",function(){return b}),n.d(t,"l",function(){return h}),n.d(t,"h",function(){return p}),n.d(t,"k",function(){return O}),n.d(t,"j",function(){return m}),n.d(t,"f",function(){return S}),n.d(t,"g",function(){return g});var r="Click",o=356,i=928,a=String.fromCharCode(57345),c=new RegExp(a,"g"),u=String.fromCharCode(160),s=/\s/g,d=String.fromCharCode(57344),l=new RegExp(d,"g"),f="searchSuggestionsCallout",b="searchSuggestion-",h=38,p=52,O="searchBoxId",m="searchBoxAnchorId",S="folderScopeButtonId",g="folderScopeWrapperId"},774:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(21),o=n(4),i=function(){return{alteredQuery:"",currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,showSearchBoxInCompactMode:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new r.ObservableMap,queryAlterationType:null,queryActionSource:null}},a={scenarioStores:new r.ObservableMap},c=Object(o.createStore)("commonSearchStore",a);t.b=c},776:function(e,t,n){"use strict";var r=n(52),o=n(733),i=n(4),a=n(730);Object(i.mutator)(a.n,function(e){var t=e.suggestionSet;Object(o.a)(e.scenarioId).currentSuggestions=t});var c=n(0),u=n(1113),s=n(774),d=n(757);Object(i.mutator)(d.b,function(e){var t=Object(u.a)(e.scenarioId);Object(s.b)().scenarioStores.get(t)||(Object(s.b)().scenarioStores.set(t,Object(c.__assign)({},Object(s.a)())),Object(s.b)().scenarioStores.get(t).isUsing3S=e.isUsing3S)}),Object(i.mutator)(a.p,function(e){Object(o.a)(e.scenarioId).isSuggestionsDropdownVisible=e.isSuggestionsDropdownVisible});Object(i.mutator)(d.r,function(e){Object(o.a)(e.scenarioId).searchText=e.searchText}),Object(i.mutator)(d.a,function(e){var t=Object(o.a)(e.scenarioId),n=e.suggestionPill,r=n.ReferenceId;t.suggestionPills.set(r,n),t.suggestionPillIds.push(r)}),Object(i.mutator)(a.q,function(e){var t=Object(o.a)(e.scenarioId),n=e.latestTraceId;t.latestTraceId=n,e.isQFTraceId&&(t.latestQFTraceId=n)});Object(i.mutator)(d.k,function(e){Object(o.a)(e.scenarioId).searchBoxHasFocus=!0}),Object(i.mutator)(a.k,function(e){Object(o.a)(e.scenarioId).searchBoxHasFocus=!1});Object(i.mutator)(a.r,function(e){Object(o.a)(e.scenarioId).searchTextForSuggestion=e.searchTextForSuggestion});var l=Object(i.mutatorAction)("setLatestRenderedQFTraceId",function(e,t){Object(o.a)(t).latestRenderedQFTraceId=e}),f=n(754),b=n(873),h=(Object(i.orchestrator)(a.e,function(e){var t=e.scenarioId;f.A.importAndExecute(Object(b.a)(t)),f.x.importAndExecute()}),Object(i.mutator)(a.u,function(e){Object(o.a)(e.scenarioId).queryActionSource=e.actionSource}),Object(i.orchestrator)(d.k,function(e){var t=e.scenarioId,n=Object(o.a)(t),r=n.searchSessionGuid,i=n.searchText,c=n.searchTextForSuggestion;if(Object(a.p)(!0,t),r){if(i&&i===c)return;Object(a.r)(i,t),Object(a.h)(t)}else Object(a.v)("SearchBox",!1,t)}),n(950));Object(i.orchestrator)(d.e,function(e){return Object(c.__awaiter)(void 0,void 0,void 0,function(){var t,n,r;return Object(c.__generator)(this,function(i){return t=e.scenarioId,n=e.selectedSuggestionIndex,r=Object(o.a)(t),n!==Object(s.a)().selectedSuggestionIndex?(Object(a.x)(r.currentSuggestions.Suggestions[n],"keyboard",t,r.currentSuggestions.TraceId,n),r.searchText||(Object(a.i)("",t),Object(a.r)("",t))):Object(h.a)(t)||Object(a.u)("Keyboard",t,!0),Object(a.p)(!1,t),[2]})})}),Object(i.orchestrator)(a.i,function(e){return Object(c.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(c.__generator)(this,function(r){return t=e.scenarioId,n=e.searchText,Object(d.r)(n,t),[2]})})});var p=n(1269),O=Object(i.mutatorAction)("setSearchSessionGuid",function(e,t){Object(o.a)(t).searchSessionGuid=e}),m=n(319),S=n(151),g=n(786),_=n(65),I=(Object(i.orchestrator)(a.v,function(e){var t=e.actionSource,n=e.shouldStartSearch,r=e.scenarioId,i=Object(o.a)(r);if(i.searchSessionGuid)throw new Error("searchSessionGuid should not be set when starting a search session.");var c=Object(m.a)();O(c,r),Object(p.a)(Object(m.a)(),r),i.isUsing3S&&f.P.import().then(function(e){e(i.nextSearchQueryId,Object(b.a)(r),"",Object(_.f)("sea-answers-calendar")?2:1)}),Object(a.m)(t,n,r),J.import(),Z.import(),pe.import(),ne.import(),ce.import(),Object(S.m)("Search_SessionStarted",[g.b[r],t])}),n(1436));Object(i.orchestrator)(a.j,function(e){Object(I.b)(e.scenarioId,e.callback)});Object(i.orchestrator)(a.a,function(e){var t=e.scenarioId,n=e.suggestionPill;n&&(function(e,t){var n=Object(o.a)(t);switch(e.kind){case f.b.People:return Object(c.__spread)(n.suggestionPills.values()).filter(function(t){var n,r,o,i;if(t.kind!==f.b.People)return!1;try{for(var a=Object(c.__values)(e.EmailAddresses),u=a.next();!u.done;u=a.next()){var s=u.value;try{for(var d=(o=void 0,Object(c.__values)(t.EmailAddresses)),l=d.next();!l.done;l=d.next())if(s===l.value)return!0}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!1}).length>0;case f.b.Category:return n.suggestionPillIds.indexOf(e.ReferenceId)>-1;default:return!1}}(n,t)||Object(d.a)(n,t),e.suggestionSelected&&(Object(a.i)("",t),Object(a.r)("",t)))}),Object(i.mutator)(a.e,function(e){var t=Object(o.a)(e.scenarioId),n=Object(s.a)();t.latestQFRequestId=n.latestQFRequestId,t.searchTextForSuggestion=n.searchTextForSuggestion,t.currentSuggestions=n.currentSuggestions,t.selectedSuggestionIndex=n.selectedSuggestionIndex});function v(e){var t=Object(o.a)(g.b.Mail).suggestionPills,n=e.SearchTerms;return t.forEach(function(e){switch(e.kind){case f.b.People:var t=e,r=t.DisplayName.toLowerCase().split(" ");j(n,r),j(n,t.EmailAddresses);break;case f.b.Category:var o=e.Name.toLowerCase().split(" ");j(n,o)}}),n}function j(e,t){t.forEach(function(t){!function(e,t){for(var n=-1,r=0;r<e.length;r++)0==e[r].localeCompare(t,"en",{sensitivity:"base",ignorePunctuation:!0})&&(n=r);n>-1&&e.splice(n,1)}(e,t)})}var x=n(765),T=n(1468),E=n(1087),w=n(5),y=n(1),P=n(1401),F=n(21),C=n(103),D=n(297),A=n(1469),R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onKeyDown=function(e){return Object(c.__awaiter)(t,void 0,void 0,function(){var t,n,r;return Object(c.__generator)(this,function(i){switch(i.label){case 0:switch(e.stopPropagation(),t=e.keyCode,n=this.props.scenarioId,r=Object(o.a)(n).selectedSuggestionIndex,Object(d.g)(t,this.props.scenarioId),t){case 13:return[3,1];case 8:return[3,2];case 38:return[3,4];case 40:return[3,6];case 37:return[3,8];case 27:return[3,10]}return[3,11];case 1:return this.clearSelection(),Object(d.e)(r,n),[3,12];case 2:return[4,$.import()];case 3:return i.sent()(this.getCursorPosition(),n),[3,12];case 4:return e.preventDefault(),[4,te.import()];case 5:return i.sent()(n),[3,12];case 6:return[4,K.import()];case 7:return i.sent()(n),[3,12];case 8:return[4,ee.import()];case 9:return i.sent()(this.getCursorPosition(),n),[3,12];case 10:return e.preventDefault(),Object(d.f)(n),[3,12];case 11:return[3,12];case 12:return[2]}})})},t.onClick=function(e){e.stopPropagation(),Object(a.p)(!0,t.props.scenarioId)},t.onFocus=function(){Object(d.k)(t.props.scenarioId)},t.onSearchTextChange=function(){var e=t.props.scenarioId,n=t.searchInput.value;Object(a.i)(n,e),Object(a.r)(n,e),Object(a.h)(e),Object(o.a)(e).isSuggestionsDropdownVisible||Object(a.p)(!0,e)},t}return Object(c.__extends)(t,e),t.prototype.setFocus=function(){this.searchInput&&this.searchInput.focus()},Object.defineProperty(t.prototype,"searchInputText",{get:function(){return Object(o.a)(this.props.scenarioId).searchText},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeDescendant",{get:function(){var e=this.props,t=e.isSuggestionsCalloutVisible,n=e.scenarioId,r=Object(o.a)(n).selectedSuggestionIndex;return t&&r>=0?""+x.q+r:""},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.scenarioId,r=t.searchPlaceHolderText,i=t.isDisabled,a=t.isSuggestionsCalloutVisible,c=!!Object(o.a)(this.props.scenarioId).searchSessionGuid,u=D(A.searchBoxInput,i&&A.isDisabled,c?A.inSearchinputPlaceholder:A.inputPlaceholder),s=Object(P.a)(n,r),d=s.ariaLabel,l=s.placeholder;return y.createElement("div",{className:A.searchBoxInputContainer},y.createElement("input",{"aria-activedescendant":this.activeDescendant,"aria-autocomplete":"list","aria-label":d,"aria-owns":a?x.p:"",autoComplete:"off",className:u,disabled:i,onChange:this.onSearchTextChange,onClick:this.onClick,onFocus:this.onFocus,onKeyDown:this.onKeyDown,placeholder:l,ref:function(t){return e.searchInput=t},value:this.searchInputText,spellCheck:!1,autoCorrect:"off"}))},t.prototype.getCursorPosition=function(){return this.searchInput?this.searchInput.selectionStart!==this.searchInput.selectionEnd?-1:this.searchInput.selectionStart:-1},t.prototype.clearSelection=function(){var e=this.searchInput.value.length;this.searchInput.setSelectionRange(e,e)},Object(c.__decorate)([F.computed],t.prototype,"searchInputText",null),Object(c.__decorate)([F.computed],t.prototype,"activeDescendant",null),t=Object(c.__decorate)([C.observer],t)}(y.Component),N=n(1402);function k(e,t){return e?x.c:t||x.b}var B=n(266),L=n(254),M=n(503),U=n(132),H=n(70),G=n(768),z=n(297),V=n(1471),q="LPCPseudoTabbableElement",X=function(e){function t(t){var n=e.call(this,t)||this;n.onExitClick=function(){n.onExit("SearchBoxBackArrow")},n.isInActiveSearchSession=function(){return!!Object(o.a)(n.props.scenarioId).searchSessionGuid},n.onCompactSearchButtonClick=function(){Object(a.v)("SearchCollapsedButton",!1,n.props.scenarioId)},n.onSearchFolderScopeSelected=function(){return Object(c.__awaiter)(n,void 0,void 0,function(){return Object(c.__generator)(this,function(e){switch(e.label){case 0:return this.searchInput?[4,pe.import()]:[3,2];case 1:e.sent()(g.a.Mail)&&this.searchInput.setFocus(),e.label=2;case 2:return[2]}})})},n.focusSearchInput=function(){Object(o.a)(n.props.scenarioId).showSearchBoxInCompactMode&&!n.isInActiveSearchSession()?Object(a.v)("Keyboard",!1,n.props.scenarioId):n.searchInput.setFocus()},n.onSearchBoxClick=function(e){e.stopPropagation(),n.focusSearchInput()},n.onExit=function(e){Object(a.g)(e,n.props.scenarioId,Object(_.f)("sea-nextSearchBoxInteractions"))},n.onSearchBoxBlur=function(e){var t=e.relatedTarget;t||(t=document.activeElement),Object(U.a)(n.searchBoxContainer,t)||t.id==q||t.id===x.f||t.id===x.g||t.firstElementChild&&t.firstElementChild.id===x.k||(Object(a.p)(!1,n.props.scenarioId),Object(a.k)(n.props.scenarioId))},n.onRemovePill=function(e){return Object(c.__awaiter)(n,void 0,void 0,function(){return Object(c.__generator)(this,function(t){switch(t.label){case 0:return[4,ne.import()];case 1:return t.sent()(e,this.props.scenarioId,"Click"),[2]}})})},n.onClearSearchBoxClicked=function(e){var t=n.props.scenarioId;e.stopPropagation(),Object(a.c)(t),n.focusSearchInput(),Object(S.m)("Search_ClearSearchBoxButtonClicked",[g.a[t]])},n.onClearSearchBoxClickedKeyDown=function(e){e.keyCode!==H.a.enter&&e.keyCode!==H.a.space||n.onClearSearchBoxClicked(e)};var r=t.isUsing3S,i=void 0===r||r;return Object(d.b)(t.scenarioId,i),n}return Object(c.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this.isInActiveSearchSession();this.props.showCompactSearchBox==e.showCompactSearchBox&&t&&!this.previousSearchActiveValue&&this.focusSearchInput(),this.previousSearchActiveValue=t},Object.defineProperty(t.prototype,"isSuggestionsCalloutVisible",{get:function(){var e=Object(o.a)(this.props.scenarioId),t=e.isSuggestionsDropdownVisible,n=e.currentSuggestions;return!this.props.isSuggestCalloutDisabled&&n&&n.Suggestions&&n.Suggestions.length>0&&t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchBoxButtonProps",{get:function(){var e=this;return Object(o.a)(this.props.scenarioId).searchBoxHasFocus?{ariaLabel:Object(w.a)(E.a),iconProps:{iconName:"Forward"},onClick:this.onSearchButtonClicked(),title:Object(w.a)(E.a)}:{ariaLabel:Object(w.a)(T.b),iconProps:{iconName:"Clear"},onClick:function(){return e.onExit("SearchBoxXButton")},title:Object(w.a)(T.b)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchGlyphClasses",{get:function(){return Object(_.f)("sea-nextSearchBoxInteractions")?z(Object(o.a)(this.props.scenarioId).searchSessionGuid?V.searchIconFocused:V.searchIconRest,this.props.isDisabled&&V.isDisabled):z(V.searchIcon,this.props.isDisabled&&V.isDisabled)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isClearSearchBoxButtonVisible",{get:function(){return!!Object(_.f)("sea-searchBoxInteractionsClear")&&!Object(h.a)(this.props.scenarioId)},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.isDisabled,r=t.scenarioId,i=Object(o.a)(r).showSearchBoxInCompactMode,a=this.isInActiveSearchSession(),u={maxWidth:k(a,this.props.customCollapsedMaxWidth)+"px",width:"100%"},s=z(V.searchBoxCommonContainer,i&&V.isInCompactMode,a&&V.searchBoxContainerInSearch),d=z(V.searchBoxContainer,a&&V.searchBoxContainerInSearch,i&&V.isInCompactMode);if(i&&!a)return y.createElement("div",{role:"search",className:d,ref:function(t){return e.searchBoxContainer=t}},y.createElement(le,{onClick:this.onCompactSearchButtonClick}));var l=z(V.searchBox,n&&V.isDisabled),f=this.searchGlyphClasses,b=this.isSuggestionsCalloutVisible?y.createElement(de,{scenarioId:r}):null,h={role:G.a.button,label:Object(w.a)(T.a)},p=z(V.searchBoxColumnContainer,i&&V.isInCompactMode);return y.createElement("div",{style:u,className:s},y.createElement("div",{className:p},y.createElement("div",{role:"search",tabIndex:-1,className:d,ref:function(t){return e.searchBoxContainer=t},"aria-expanded":this.isSuggestionsCalloutVisible,onBlur:this.onSearchBoxBlur},y.createElement("div",{id:x.k,className:l},b,a&&!Object(_.f)("sea-nextSearchBoxInteractions")?y.createElement(B.a,{className:z(V.backButton,"flipForRtl"),iconProps:{iconName:"Back"},onClick:this.onExitClick,ariaLabel:Object(w.a)(T.b)}):y.createElement("div",{"aria-hidden":!0,className:f,onClick:this.onSearchBoxClick},y.createElement(M.a,{iconName:"Search"})),y.createElement("div",{className:V.searchQueryContainer,onClick:this.onSearchBoxClick},Object(N.a)(this.props.scenarioId)&&y.createElement(se,{focusSearchInput:this.focusSearchInput,onRemovePill:this.onRemovePill,scenarioId:this.props.scenarioId}),y.createElement(R,{ref:function(t){return e.searchInput=t},searchPlaceHolderText:this.props.searchPlaceHolderText,isDisabled:this.props.isDisabled,scenarioId:this.props.scenarioId,isSuggestionsCalloutVisible:this.isSuggestionsCalloutVisible})),this.isClearSearchBoxButtonVisible&&y.createElement("div",Object(c.__assign)({className:V.clearBoxButton,onClick:this.onClearSearchBoxClicked,onKeyDown:this.onClearSearchBoxClickedKeyDown,tabIndex:0,title:Object(w.a)(T.a)},Object(G.b)(h)),y.createElement(M.a,{iconName:"Clear",styles:{root:{fontSize:"8px"}}})),a&&this.props.renderRefiners&&y.createElement("div",{tabIndex:-1},this.props.renderRefiners()),a&&Object(_.f)("sea-nextSearchBoxInteractions")&&y.createElement(L.a,Object(c.__assign)({className:V.searchBoxButton,styles:{icon:{fontSize:"16px"}}},this.searchBoxButtonProps))),a&&!Object(_.f)("sea-nextSearchBoxInteractions")&&y.createElement(B.a,{className:V.searchButton,iconProps:{iconName:"Search"},onClick:this.onSearchButtonClicked(),ariaLabel:Object(w.a)(E.a)})),y.createElement("div",{id:x.j})))},t.prototype.onSearchButtonClicked=function(){var e=this;return function(t){return Object(c.__awaiter)(e,void 0,void 0,function(){var e;return Object(c.__generator)(this,function(n){switch(n.label){case 0:return t.stopPropagation(),e=this.props.scenarioId,[4,pe.import()];case 1:return n.sent()(e)?this.focusSearchInput():(Object(a.p)(!1,this.props.scenarioId),Object(a.u)("SearchButton",e,!0)),[2]}})})}},Object(c.__decorate)([F.computed],t.prototype,"isSuggestionsCalloutVisible",null),Object(c.__decorate)([F.computed],t.prototype,"searchBoxButtonProps",null),Object(c.__decorate)([F.computed],t.prototype,"searchGlyphClasses",null),Object(c.__decorate)([F.computed],t.prototype,"isClearSearchBoxButtonVisible",null),t=Object(c.__decorate)([C.observer],t)}(y.Component),Q=n(1099);function Y(e){var t=Object(o.a)(e).suggestionPills;return!(!t||0===t.size)&&Object(c.__spread)(t.values()).filter(function(e){return e.kind===f.b.People}).length>0}n.d(t,"t",function(){return J}),n.d(t,"u",function(){return Z}),n.d(t,"A",function(){return K}),n.d(t,"z",function(){return $}),n.d(t,"B",function(){return ee}),n.d(t,"C",function(){return te}),n.d(t,"D",function(){return ne}),n.d(t,"F",function(){return re}),n.d(t,"E",function(){return oe}),n.d(t,"I",function(){return ie}),n.d(t,"G",function(){return ae}),n.d(t,"H",function(){return ce}),n.d(t,"e",function(){return ue}),n.d(t,"f",function(){return se}),n.d(t,"h",function(){return de}),n.d(t,"a",function(){return le}),n.d(t,"v",function(){return fe}),n.d(t,"w",function(){return be}),n.d(t,"x",function(){return he}),n.d(t,"y",function(){return pe}),n.d(t,"R",function(){return l}),n.d(t,"o",function(){return v}),n.d(t,"p",function(){return o.a}),n.d(t,"c",function(){return x.n}),n.d(t,"b",function(){return x.d}),n.d(t,"g",function(){return g.b}),n.d(t,"i",function(){return a.a}),n.d(t,"j",function(){return a.c}),n.d(t,"k",function(){return a.d}),n.d(t,"n",function(){return a.g}),n.d(t,"s",function(){return a.h}),n.d(t,"M",function(){return a.k}),n.d(t,"N",function(){return a.l}),n.d(t,"O",function(){return a.m}),n.d(t,"P",function(){return a.n}),n.d(t,"Q",function(){return a.o}),n.d(t,"U",function(){return a.t}),n.d(t,"V",function(){return a.u}),n.d(t,"S",function(){return a.q}),n.d(t,"Y",function(){return a.x}),n.d(t,"X",function(){return a.w}),n.d(t,"J",function(){return a.i}),n.d(t,"W",function(){return a.v}),n.d(t,"m",function(){return a.f}),n.d(t,"L",function(){return a.j}),n.d(t,"T",function(){return a.r}),n.d(t,"l",function(){return a.e}),n.d(t,"r",function(){return b.a}),n.d(t,"d",function(){return X}),n.d(t,"q",function(){return Q.a}),n.d(t,"K",function(){return Y});var W=new r.c(function(){return Promise.all([n.e(3),n.e(8),n.e(10),n.e(626),n.e(444)]).then(n.bind(null,14051))}),J=new r.b(W,function(e){return e.clearSearchBox}),Z=new r.b(W,function(e){return e.endSearchSession}),K=new r.b(W,function(e){return e.onDownArrowPressedSearchInput}),$=new r.b(W,function(e){return e.onBackspacePressedSearchInput}),ee=new r.b(W,function(e){return e.onLeftArrowPressedSearchInput}),te=(new r.b(W,function(e){return e.onRightArrowPressedSearchInput}),new r.b(W,function(e){return e.onUpArrowPressedSearchInput})),ne=new r.b(W,function(e){return e.removeSuggestionPillFromSearchBox}),re=new r.b(W,function(e){return e.setLatestQFRequestId}),oe=new r.b(W,function(e){return e.setIsSuggestionsDropdownVisible}),ie=new r.b(W,function(e){return e.updateIsSuggestionSetComplete}),ae=new r.b(W,function(e){return e.setShowSearchBoxInCompactMode}),ce=new r.a(W,function(e){return e.setSpellerData}),ue=(Object(r.d)(W,function(e){return e.PersonaPill}),Object(r.d)(W,function(e){return e.PrivateDistributionListPill}),Object(r.d)(W,function(e){return e.SearchBoxDropdown})),se=Object(r.d)(W,function(e){return e.SearchBoxPillWell}),de=Object(r.d)(W,function(e){return e.SuggestionsCallout}),le=Object(r.d)(W,function(e){return e.CompactSearchBox}),fe=new r.b(W,function(e){return e.getSuggestionAtIndex}),be=new r.b(W,function(e){return e.isInSearchMode}),he=new r.b(W,function(e){return e.isQFRequestIdEqualToLatest}),pe=new r.b(W,function(e){return e.isSearchBoxEmpty})},777:function(e,t,n){"use strict";n.d(t,"f",function(){return o}),n.d(t,"h",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"i",function(){return s}),n.d(t,"e",function(){return d}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return f});var r=n(4),o=Object(r.action)("REMOVE_MAILBOX_DATA",function(e){return{mailboxId:e}}),i=Object(r.action)("SET_LOADING_STATE_FOR_MAILBOX",function(e,t){return{mailboxId:e,loadingState:t}}),a=Object(r.action)("FETCH_ARCHIVE_DUMPSTER_FOLDER"),c=Object(r.action)("ADD_SHARED_FOLDER_USER_EMAIL",function(e){return{principalSMTPAddress:e}}),u=Object(r.action)("REMOVE_SHARED_FOLDER_USER_EMAIL",function(e){return{principalSMTPAddress:e}}),s=Object(r.action)("SET_REPLICA_LIST",function(e,t){return{folderId:e,replicaList:t}}),d=Object(r.action)("ON_FIND_FOLDER_RESPONSE",function(e,t,n,r,o,i){return{rootFolder:e,distinguishedFolderId:t,treeType:n,principalSMTPAddress:r,displayName:o,mailboxId:i}}),l=Object(r.action)("ON_ADD_SHARED_FOLDER_SUCCESS",function(e,t){return{principalSMTPAddress:e,folder:t}}),f=Object(r.action)("ON_FIND_DUMPSTER_FOLDER_SUCCESS",function(e,t,n){return{rootFolder:e,treeType:t,principalSMTPAddress:n}})},781:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a});var r=n(751),o=n(69);function i(e){return"msgfolderroot"===e.distinguishedFolderId}var a=Object(o.select)({folderTable:function(){return r.b.folderTable}})(function(e,t,n){var r=!!e&&e.ParentFolderId;if(!r)return!1;for(var o=n.folderTable.get(r.Id);o;){if(o.distinguishedFolderId==t)return!0;if(!o.ParentFolderId)return!1;o=n.folderTable.get(o.ParentFolderId.Id)}return!1});t.a=Object(o.select)({folderTable:function(){return r.b.folderTable}})(function(e,t,n){return function(e,t){return!!e&&e.distinguishedFolderId==t}(e,t)||a(e,t,n)})},786:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker",e[e.Spaces=5]="Spaces"}(r||(r={})),t.b=r},801:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(830),o=n(62),i="X-AnchorMailbox",a="X-AuxMailbox";function c(e,t){try{var n={headers:new Headers},c=null;if(e){c=Object(r.a)(e);var u=Object(r.c)(e);u&&n.headers.append(a,u)}else t&&(c=Object(r.b)(t));return c&&n.headers.append(i,c),n}catch(n){return o.d.error(" getDefaultRequestOptions failed for folderId "+e+" and itemId "+t+" with error "+n),{}}}},828:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(751);function o(){return Object(r.a)().mailboxTable}},829:function(e,t,n){"use strict";var r=n(69),o=n(737),i=n(751);t.a=Object(r.select)({folderTable:function(){return Object(i.a)().folderTable}})(function(e,t){var n=Object(o.a)(e);return n||(n=e),t.folderTable.get(n).FolderId})},830:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return h});var r=n(5),o=n(892),i=n(62),a=n(746),c=n(734),u=n(40),s=n(245);function d(e){try{if(!e)return null;for(var t=atob(e),n=t.length,r=new Uint8Array(new ArrayBuffer(n)),a=0;a<n;a++)r[a]=t.charCodeAt(a);return Object(o.a)(r)}catch(t){return i.d.error("getMailboxGuidFromEwsId : conversion failed for id "+e+" with error "+t),null}}function l(e,t){if(!e||!t)return null;return r.b("{0}@{1}",e,t)}function f(e){var t;if(Object(s.a)()||!e)return null;var n=Object(u.a)().SessionSettings,r=Object(a.a)(),o=r&&r.get(e);return o||e===c.d?e===c.d?l(n.ArchiveMailboxGuid,n.OrganizationDomain):o.treeType===c.c?l((null===(t=o)||void 0===t?void 0:t.ReplicaList)?o.ReplicaList[0]:n.ArchiveMailboxGuid,n.OrganizationDomain):o.treeType===c.j?l(d(e),n.OrganizationDomain):null:null}function b(e){if(Object(s.a)()||!e)return null;var t=Object(a.a)(),n=t&&t.get(e);return n&&n.treeType===c.c&&n.ReplicaList?n.ReplicaList[0]:null}function h(e){if(Object(s.a)()||!e)return null;var t=Object(u.a)().SessionSettings,n=d(e);return n===t.MailboxGuid?null:l(n,t.OrganizationDomain)}},834:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r=n(40),o=n(69);function i(e){return!!(e&Object(r.a)().ViewStateConfiguration.ListViewBitFlags)}var a=Object(o.action)("setBit")(function(e,t){i(t)!==e&&(e?Object(r.a)().ViewStateConfiguration.ListViewBitFlags|=t:Object(r.a)().ViewStateConfiguration.ListViewBitFlags&=~t)})},873:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(786),o=n(754);function i(e){switch(e){case r.b.Mail:return o.a.Mail;case r.b.Calendar:return o.a.Calendar;case r.b.FilesHub:return o.a.FilesHub;case r.b.Spaces:return o.a.Mail;default:throw Error("No corresponding SubstrateSearchScenario for given SearchScenarioId ("+e+").")}}},878:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(760),o=n(828);function i(e){var t,n=Object(o.a)();return(null===(t=n&&n.get(e))||void 0===t?void 0:t.loadingState)||r.a.Uninitialized}},881:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(751);function o(){return Object(r.a)().sharedFolderUserEmails}},882:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(891);function o(e){return Object(r.a)(e)}},883:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(1128),o=n.n(r),i=n(747),a=n.n(i),c=n(191),u=n(1129),s=n.n(u),d=n(829),l=n(801);function f(e,t){return s()({Header:Object(c.getJsonRequestHeader)(),Body:o()({FolderChanges:[{Updates:t,FolderId:a()(Object(d.a)(e))}]})},Object(l.a)(e)).then(function(e){return e.Body.ResponseMessages.Items[0]})}},891:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(828);function o(e){var t,n=Object(r.a)();return null===(t=n&&n.get(e))||void 0===t?void 0:t.rootFolder}},892:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(62);function o(e){if(!e)return null;var t=e,n=0;if(1==t[0]){if(!(t=a(t)))return null}else n=1;var o=t[++n]+(t[n+1]>>8);return function(e,t,n){if(t+n>e.length)return r.d.error("ConvertByteArrayToString: offset + count must not exceed byte array length."),null;for(var o="",i=t;i<t+n;i++)o+=String.fromCharCode(e[i]);return o}(t,n+=2,o)}function i(e){if(!e)return!1;try{for(var t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);var o=0;return 1===n[0]?n=a(n):o=1,n&&1===n[o]}catch(e){return!1}}function a(e){var t=c(e,null);if(0==t)return r.d.error("rleDecompress : Invalid id"),null;var n=new Uint8Array(t);return c(e,n),n}function c(e,t){for(var n=0,o=1;o<e.length;++o)if(o==e.length-1||e[o]!=e[o+1])null!=t&&(t[n]=e[o]),n++;else{if(o==e.length-2)return r.d.error("decompressEx : Invalid id"),null;for(var i=e[o+2],a=0;a<i+2;a++)null!=t&&(t[n]=e[o]),n++;o+=2}return n}},946:function(e,t,n){"use strict";var r=function(e,t){if(e.ExtendedProperty)for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r.ExtendedFieldURI.PropertyTag===t||r.ExtendedFieldURI.PropertyName===t)return r.Value}},o=function(e){return"false"!==r(e,"0x10f4")},i=function(e){return parseInt(r(e,"SourceWellKnownFolderType"),10)},a=n(0),c=n(1),u=c.lazy(function(){return Promise.all([n.e(1),n.e(2),n.e(7),n.e(681),n.e(664)]).then(n.bind(null,13933))}),s=function(e){return c.createElement(c.Suspense,{fallback:c.createElement("div",{className:e.className})},c.createElement(u,Object(a.__assign)({},e)))};n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"a",function(){return s})},950:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(733);function o(e){var t=Object(r.a)(e);return 0===t.searchText.trim().length&&0===t.suggestionPillIds.length}}},0,[0,1,2,578,189,3,8,10,626,444,9,11,30,39,447,565,110,242]]);
//# sourceMappingURL=owa.FileProviderStore.js.map
self.scriptsLoaded['owa.FileProviderStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FileProviderStore.js'] = (new Date()).getTime();